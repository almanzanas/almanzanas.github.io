<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Alvaro Manzanas - 7&nbsp; Base-R Summary</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../_book-lib-dir/quarto-nav/quarto-nav.js"></script>
<script src="../../_book-lib-dir/clipboard/clipboard.min.js"></script>
<script src="../../_book-lib-dir/quarto-search/autocomplete.umd.js"></script>
<script src="../../_book-lib-dir/quarto-search/fuse.min.js"></script>
<script src="../../_book-lib-dir/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../to_book/notebooks/11_transformations_tidyverse.html" rel="next">
<link href="../../to_book/notebooks/03_data_handling.html" rel="prev">
<script src="../../_book-lib-dir/quarto-html/quarto.js"></script>
<script src="../../_book-lib-dir/quarto-html/popper.min.js"></script>
<script src="../../_book-lib-dir/quarto-html/tippy.umd.min.js"></script>
<script src="../../_book-lib-dir/quarto-html/anchor.min.js"></script>
<link href="../../_book-lib-dir/quarto-html/tippy.css" rel="stylesheet">
<link href="../../_book-lib-dir/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../_book-lib-dir/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../_book-lib-dir/bootstrap/bootstrap.min.js"></script>
<link href="../../_book-lib-dir/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../_book-lib-dir/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../_book-lib-dir/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Alvaro Manzanas</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../portfolio.html"> 
<span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../prefacio.html" aria-current="page"> 
<span class="menu-text">Annotations</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cv" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">CV</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-cv">    
        <li>
    <a class="dropdown-item" href="../../docs/Alvaro Manzanas-CV_es.pdf" target="_blank">
 <span class="dropdown-text">Spanish</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/Alvaro Manzanas-CV_en.pdf" target="_blank">
 <span class="dropdown-text">English</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="http://github.com/almanzanas" target="_blank"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:almanzanas@gmx.com"> <i class="bi bi-bi bi-envelope" role="img" aria-label="e-mail">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://es.linkedin.com/in/alvaromanzanas" target="_blank"> <i class="bi bi-linkedin" role="img" aria-label="Linkedin">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../to_book/notebooks/00_basics_ndata.html">Base R</a></li><li class="breadcrumb-item"><a href="../../to_book/notebooks/99_summary.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Base-R Summary</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="sidebar-tools-main tools-wide">
    <a href="http://github.com/almanzanas" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="mailto:almanzanas@gmx.com" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-bi bi-envelope"></i></a>
    <a href="https://es.linkedin.com/in/alvaromanzanas" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-linkedin"></i></a>
</div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Alvaro Manzanas’ Portfolio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefacio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Annotations</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Base R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/00_basics_ndata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R: The very basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/01_functions_scripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Functions, scripts and performance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/02_data_into_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data into R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/03_data_handling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Handling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/99_summary.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Base-R Summary</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Data Wrangling and Model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/11_transformations_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Transformations with Tidyverse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/12_ExpDatAn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/13_enchanced_visualizations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Enchanced Visualizations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/14_modeling2deploy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modeling to Deploy</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#r-base" id="toc-r-base" class="nav-link active" data-scroll-target="#r-base"><span class="header-section-number">8</span> R-base</a>
  <ul class="collapse">
  <li><a href="#rounding" id="toc-rounding" class="nav-link" data-scroll-target="#rounding"><span class="header-section-number">8.0.1</span> Rounding</a></li>
  <li><a href="#sorting-and-ordering" id="toc-sorting-and-ordering" class="nav-link" data-scroll-target="#sorting-and-ordering"><span class="header-section-number">8.0.2</span> Sorting and Ordering</a></li>
  <li><a href="#matching" id="toc-matching" class="nav-link" data-scroll-target="#matching"><span class="header-section-number">8.0.3</span> Matching</a></li>
  <li><a href="#duplicates" id="toc-duplicates" class="nav-link" data-scroll-target="#duplicates"><span class="header-section-number">8.0.4</span> Duplicates</a></li>
  <li><a href="#lists" id="toc-lists" class="nav-link" data-scroll-target="#lists"><span class="header-section-number">8.1</span> Lists</a></li>
  <li><a href="#data-frames" id="toc-data-frames" class="nav-link" data-scroll-target="#data-frames"><span class="header-section-number">8.2</span> Data Frames</a>
  <ul class="collapse">
  <li><a href="#split-apply-combine" id="toc-split-apply-combine" class="nav-link" data-scroll-target="#split-apply-combine"><span class="header-section-number">8.2.1</span> Split, Apply, Combine</a></li>
  <li><a href="#re-ordering-de-duplicating-sampling" id="toc-re-ordering-de-duplicating-sampling" class="nav-link" data-scroll-target="#re-ordering-de-duplicating-sampling"><span class="header-section-number">8.2.2</span> Re-Ordering, De-Duplicating, Sampling</a></li>
  </ul></li>
  <li><a href="#date-and-time-objects" id="toc-date-and-time-objects" class="nav-link" data-scroll-target="#date-and-time-objects"><span class="header-section-number">8.3</span> Date and Time Objects</a>
  <ul class="collapse">
  <li><a href="#posix" id="toc-posix" class="nav-link" data-scroll-target="#posix"><span class="header-section-number">8.3.1</span> POSIX</a></li>
  <li><a href="#combining" id="toc-combining" class="nav-link" data-scroll-target="#combining"><span class="header-section-number">8.3.2</span> Combining</a></li>
  <li><a href="#comparing-data-frames" id="toc-comparing-data-frames" class="nav-link" data-scroll-target="#comparing-data-frames"><span class="header-section-number">8.3.3</span> Comparing Data Frames</a></li>
  <li><a href="#view-and-editing-data-frames" id="toc-view-and-editing-data-frames" class="nav-link" data-scroll-target="#view-and-editing-data-frames"><span class="header-section-number">8.3.4</span> View and Editing Data Frames</a></li>
  </ul></li>
  <li><a href="#characters" id="toc-characters" class="nav-link" data-scroll-target="#characters"><span class="header-section-number">8.4</span> Characters</a>
  <ul class="collapse">
  <li><a href="#formatting-numbers" id="toc-formatting-numbers" class="nav-link" data-scroll-target="#formatting-numbers"><span class="header-section-number">8.4.1</span> Formatting Numbers</a></li>
  <li><a href="#discretizing-a-numeric-variable" id="toc-discretizing-a-numeric-variable" class="nav-link" data-scroll-target="#discretizing-a-numeric-variable"><span class="header-section-number">8.4.2</span> Discretizing a Numeric Variable</a></li>
  <li><a href="#character-strings" id="toc-character-strings" class="nav-link" data-scroll-target="#character-strings"><span class="header-section-number">8.4.3</span> Character Strings</a></li>
  </ul></li>
  <li><a href="#regular-expressions" id="toc-regular-expressions" class="nav-link" data-scroll-target="#regular-expressions"><span class="header-section-number">8.5</span> Regular Expressions</a>
  <ul class="collapse">
  <li><a href="#common-data-cleaning-task-using-regular-expressions" id="toc-common-data-cleaning-task-using-regular-expressions" class="nav-link" data-scroll-target="#common-data-cleaning-task-using-regular-expressions"><span class="header-section-number">8.5.1</span> Common Data Cleaning Task Using Regular Expressions</a></li>
  <li><a href="#utf-8-and-other-non-ascii-characters" id="toc-utf-8-and-other-non-ascii-characters" class="nav-link" data-scroll-target="#utf-8-and-other-non-ascii-characters"><span class="header-section-number">8.5.2</span> UTF-8 and Other Non-ASCII Characters</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#factors" id="toc-factors" class="nav-link" data-scroll-target="#factors"><span class="header-section-number">9</span> Factors</a></li>
  <li><a href="#r-objects-and-commands" id="toc-r-objects-and-commands" class="nav-link" data-scroll-target="#r-objects-and-commands"><span class="header-section-number">10</span> R Objects and Commands</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../to_book/notebooks/00_basics_ndata.html">Base R</a></li><li class="breadcrumb-item"><a href="../../to_book/notebooks/99_summary.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Base-R Summary</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Base-R Summary</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="r-base" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> R-base</h1>
<ul>
<li><p><code>help()</code>: gets information on a particular R function, e.g.&nbsp;<code>help(matrix)</code></p>
<ul>
<li><code>help(Syntax)</code>: returns the help of a list of operators<br>
</li>
</ul></li>
<li><p><code>?</code>: works the same as the previous one, e.g.&nbsp;<code>?"matrix"</code></p></li>
<li><p><code>help.search()</code>: It’s useful if we know the subject rather than the name.</p></li>
<li><p><code>apropos()</code>: returns a vector of names of objects containing that string, e.g.&nbsp;<code>apropos("matrix")</code> returns every object with ‘matrix’ in its name.</p></li>
<li><p><code>args()</code>: displays the set of arguments expected by a given function.</p></li>
<li><p><code>which()</code>: convert logical vector into numeric. Returns the indices of the elements TRUE.</p></li>
<li><p><code>seq()</code>: create sequences. Principal arguments are: from, to and by.</p></li>
<li><p><code>names()</code>: to show or assign names to a vector</p></li>
<li><p><code>typeof()</code></p></li>
<li><p><code>mode()</code></p></li>
<li><p><code>str()</code></p></li>
<li><p><code>class()</code></p></li>
<li><p><code>is()</code></p></li>
<li><p><code>is.logical()</code></p></li>
<li><p><code>is.integer()</code></p></li>
<li><p><code>is.numeric()</code></p></li>
<li><p><code>is.character()</code></p></li>
</ul>
<p>Types: logical &lt; raw &lt; numeric &lt; complex &lt; character.</p>
<ul>
<li><p><code>as.numeric()</code></p></li>
<li><p><code>as.character()</code></p></li>
<li><p><code>as.integer()</code></p></li>
<li><p><code>as.logical()</code></p></li>
<li><p><code>as.factor()</code></p></li>
<li><p><code>anyNA()</code>: Returns TRUE if the vector contains NA values.</p></li>
<li><p><code>is.na()</code>: Returns TRUE for every field NA.</p></li>
<li><p><code>where(is.na(vector))</code>to find the numeric indices of the missing elements.</p></li>
<li><p><code>na.omit()</code>: deletes the missing values but also keeps track of where in the vector they used to be. This information is stored in vector’s ‘attributes’:</p></li>
<li><p><code>attr(nay, "na.action")</code></p></li>
<li><p><code>is.null()</code>:</p></li>
<li><p><code>table()</code>:</p></li>
<li><p><code>useNA =</code></p>
<ul>
<li><code>"no"</code> : default option. Exclude NA values.</li>
<li><code>"ifany"</code> : show an entry for NA if there are any.</li>
<li><code>"always"</code> : show an entry for NA whether there are any NA values or not.</li>
</ul></li>
<li><p><code>exclude =</code></p>
<ul>
<li><code>c(NA, NaN)</code> : default option.</li>
<li>We can add a value of the vector to exclude, also we can pass <code>NULL</code>.</li>
</ul></li>
<li><p><code>xtabs()</code>: for more complex table</p></li>
<li><p><code>prop.table()</code> : passing a variable with table assigned produces the proportions of the total counts in the table by cell (or row, or column). The second argument references 1 to rows, or 2 to columns.</p></li>
<li><p><code>margin.table()</code> : produce the marginals totals from a table.</p></li>
<li><p><code>addmargins()</code> : to a given table incorporates those totals producing a new row and column by default. Passing as second argument 1 or 2, you can specified if only wants rows or columns.</p></li>
<li><p><code>tapply()</code> : the arguments are, first the vector where perform the computation, second the vector with the index to group, and then the function to apply. To group with more than one vector (index) we can use a <code>list()</code>.</p></li>
</ul>
<section id="rounding" class="level3" data-number="8.0.1">
<h3 data-number="8.0.1" class="anchored" data-anchor-id="rounding"><span class="header-section-number">8.0.1</span> Rounding</h3>
<ul>
<li><code>round()</code> : to round a number with specific amount of decimals. Passing a negative number as second argument will round the nearest power of 10.</li>
<li><code>signif()</code> : retain a specific number of digits.</li>
<li><code>trunc()</code> : discards the decimal part returning an integer.</li>
<li><code>floor()</code> ; <code>ceiling()</code> : round to the next lower or higher integer respectively.</li>
</ul>
</section>
<section id="sorting-and-ordering" class="level3" data-number="8.0.2">
<h3 data-number="8.0.2" class="anchored" data-anchor-id="sorting-and-ordering"><span class="header-section-number">8.0.2</span> Sorting and Ordering</h3>
<ul>
<li><code>sort()</code> : sorting from smallest to largest. It will drop NA and NaN values by default.
<ul>
<li><code>decreasing=TRUE</code> will reverse the order.</li>
<li><code>na.last</code> will add NA values, TRUE at the end and FALSE at the beginning.</li>
</ul></li>
<li><code>order()</code> : returns the indices which can be used to sort a vector.
<ul>
<li><code>na.last</code> as TRUE by default. TRUE at the end and FALSE at the beginning.</li>
</ul></li>
</ul>
</section>
<section id="matching" class="level3" data-number="8.0.3">
<h3 data-number="8.0.3" class="anchored" data-anchor-id="matching"><span class="header-section-number">8.0.3</span> Matching</h3>
<ul>
<li><code>%in%</code>: to find values that overlap between two vectors.</li>
<li><code>union()</code> : returns the elements in either passed vectors</li>
<li><code>intersect()</code> : returns the elements which are in both passed vectors</li>
<li><code>setdiff()</code> : returns the elements of ‘a’ not present in ‘b’</li>
</ul>
</section>
<section id="duplicates" class="level3" data-number="8.0.4">
<h3 data-number="8.0.4" class="anchored" data-anchor-id="duplicates"><span class="header-section-number">8.0.4</span> Duplicates</h3>
<ul>
<li><code>anyDuplicated()</code> : returns the duplicated values in a vector</li>
<li><code>unique()</code> : returns the distinct values, including NA and NaN.</li>
<li><code>duplicated(</code>) : returns a logical vector with TRUE per duplicated value (not the first value).
<ul>
<li><code>fromLast=TRUE</code> reads from the end to the beginning. Using union() you can combine <code>fromLast=TRUE</code> and <code>fromLast=FALSE</code> to identify all duplicates.</li>
</ul></li>
<li><code>match()</code> : given two vectors returns where the element from ‘a’ is in ‘b’. By default returns NA for no matches, we can change this with <code>nomatch=0</code> argument.</li>
<li><code>rle()</code>: ‘Run length encoding’. Returns the number of repetitions and length.</li>
</ul>
<p>With mathematical computations we can use <code>na.rm = TRUE</code> argument to compute the result after omitting missing values.</p>
<ul>
<li><p><code>length()</code>:</p></li>
<li><p><code>sum()</code>:</p></li>
<li><p><code>mean()</code>:</p></li>
<li><p><code>sd()</code>:</p></li>
<li><p><code>min()</code>:</p></li>
<li><p><code>max()</code>:</p></li>
<li><p><code>pmax()</code>: parallel maximum, shows the max of each par of values.</p></li>
<li><p><code>range()</code>:</p></li>
<li><p><code>summary()</code>:</p></li>
<li><p><code>colSums(), rowSums(), colMeans(), rowMeans()</code></p></li>
<li><p><code>length()</code>: returns the total number of elements in the matrix</p></li>
<li><p><code>dim()</code>: returns the dimension, rows x columns</p></li>
<li><p><code>cbind()</code> : combines a set of vectors into a matrix column by column.</p></li>
<li><p><code>rbind()</code> : combines a set of vectors into a matrix row by row.</p></li>
<li><p><code>solve()</code>: inverts a matrix</p></li>
<li><p><code>t()</code>: transposes a matrix</p></li>
<li><p><code>aperm()</code>: to transpose higher-way arrays</p></li>
<li><p><code>dimnames()</code>: returns rows and columns names.</p></li>
<li><p><code>rownames()</code>:</p></li>
<li><p><code>colnames()</code>:</p></li>
<li><p><code>apply()</code> : Useful to apply a custom function.</p>
<ul>
<li>first argument, the matrix to which apply the function.</li>
<li>The direction, 1 for across rows, 2 for down columns.</li>
<li>The function to be applied.</li>
<li><code>apply(a, 2, function (x) sum (is.na(x)))</code></li>
</ul></li>
<li><p><code>which()</code>: returns a number of the position for each element.</p></li>
<li><p><code>arr.ind=TRUE</code>: returns coordinates.</p></li>
<li><p><code>which(is.na(a))</code></p></li>
</ul>
</section>
<section id="lists" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="lists"><span class="header-section-number">8.1</span> Lists</h2>
<ul>
<li><code>list()</code></li>
<li><code>split()</code> : divides a vector into pieces according to the value of another vector. Returns a list. Missing values in the second vector passed will be dropped.</li>
<li><code>length()</code>:returns the number of elements inside a list, and with <code>lengths()</code> function the length of each element.</li>
<li><code>str()</code>: returns a description of every element on the list:</li>
<li><code>unlist()</code> : try to turn the list into a vector:</li>
</ul>
</section>
<section id="data-frames" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="data-frames"><span class="header-section-number">8.2</span> Data Frames</h2>
<ul>
<li><p><code>data.frame()</code></p></li>
<li><p><code>stringAsFactors=FALSE</code></p></li>
<li><p><code>head()</code> : return the first six rows of a given dataframe. Second argument is n=6 to specify a number of rows. A negative number returns the last n rows.</p></li>
<li><p><code>tail()</code> : return the last six rows of a given dataframe. Second argument is n=6 to specify a number of rows.</p></li>
<li><p><code>str()</code> : compact representation of the data frame with data type per column.</p></li>
<li><p><code>dim()</code> : returns the dimension, number of rows and columns.</p></li>
<li><p><code>summary()</code> : returns a brief description of each column.</p></li>
<li><p><code>is.na()</code> : returns a logical matrix showing which elements are missing.</p></li>
<li><p><code>anyNA()</code> : returns TRUE or FALSE to the question There are missing values?</p></li>
<li><p><code>na.omit()</code> : omit the observations (rows) of the data frame in which one or more elements is missing. Also keeps a track, we can see the deleted observations with <code>attr(df, "na.action") ; attr(df, "class")</code>.</p></li>
<li><p><code>lapply()</code> : returns a list</p></li>
<li><p><code>sapply()</code> : runs <code>lapply()</code> and tries to make the output into a vector or a matrix. But if the return have different lengths, it will need to return a list. If it try to return items with diferent types, will convert these to a common type, then its better in these case use <code>lapply()</code>.</p></li>
</ul>
<section id="split-apply-combine" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="split-apply-combine"><span class="header-section-number">8.2.1</span> Split, Apply, Combine</h3>
<p>First the data is split, then a function is applied to each piece, and the results recombined. The function <code>tapply()</code> do exactly that, but also we can use <code>split()</code> and <code>sapply()</code> or <code>lapply()</code>.</p>
<ul>
<li><p><code>sapply (split (df2$Age, df2$Gender), mean)</code></p></li>
<li><p><code>tapply(df2$Age, df2$Gender, mean)</code></p></li>
<li><p><code>with()</code> : to perform operations on a data frame. First argument is the data frame, then the expression to be performed. Cannot be assigned to.</p></li>
<li><p><code>with ( CustPayment2016, JanDebt</code>FebPurch - FebPmt )`</p></li>
<li><p><code>within()</code> : works in the same wey but unlike <code>with()</code>, this function can be assigned.</p></li>
<li><p><code>CustPayment2016 &lt;- within ( CustPayment2016, FebDebt &lt;- JanDebt + FebPurch - FebPmt )</code></p></li>
</ul>
</section>
<section id="re-ordering-de-duplicating-sampling" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="re-ordering-de-duplicating-sampling"><span class="header-section-number">8.2.2</span> Re-Ordering, De-Duplicating, Sampling</h3>
<ul>
<li><code>order()</code>: to sort a vector or data frame:</li>
<li><code>new.order &lt;- with ( df, order (ID, Date) )</code></li>
<li><code>sample()</code> : first argument is the number of total rows, the second argument is the size of the sample we want. By default the result is a random set of integers without replacement. The row number of sampled data frame will be the same that originals.</li>
</ul>
</section>
</section>
<section id="date-and-time-objects" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="date-and-time-objects"><span class="header-section-number">8.3</span> Date and Time Objects</h2>
<ul>
<li><code>as.Date()</code>: converts text into Date class.</li>
<li><code>format=</code> - <code>%b ; %B</code> : name of the month - <code>%a ; %A</code> : name of the day of the week - <code>%d</code> : day of the month - <code>%m</code> : month in number - <code>%y ; %Y</code> : for the yy or YYYY year. - <code>%F</code> : Equivalent to %Y-%m-%d. - <code>%x</code> : Date. Locale-specific on output, <code>"%y/%m/%d"</code> on input.</li>
<li><code>months()</code>, <code>weekdays()</code>, <code>quarters()</code> returns the month name, weekday and quarter from passing Date object.
<ul>
<li><code>abbreviate=TRUE</code> argument to abbreviate the output.</li>
</ul></li>
<li><code>format()</code>: To extract the numeric month, day or year</li>
</ul>
<p>The difference between dates is a period of time stored as <code>difftime</code> object. Functions such as <code>mean()</code> and <code>range()</code> works well but <code>hist()</code> or <code>summary()</code> fails producing the expected results.</p>
<p>Usually we will convert <code>difftime</code> objects to numeric with <code>as.numeric()</code> function, for that will be a good habit to specify <code>units = "days"</code> argument (with the unit we want.</p>
<section id="posix" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="posix"><span class="header-section-number">8.3.1</span> POSIX</h3>
<p><code>POSIXlt</code> object is implemented as a list, meanwhile <code>POSIXct</code> object is like a number useful is will be stored in a column.</p>
<ul>
<li><code>as.POSIXct()</code> and <code>as.POSIXlt()</code></li>
</ul>
<p>The time zone can be converted changing <code>tzone</code> attribute:<br>
<code>attr ( ct1, tzone = "UTC" )</code>. The help of <code>Sys.timezone()</code> containing the names of the time zones.</p>
<ul>
<li><code>diff()</code> : computes differences between adjacent elements in a vector.</li>
<li><code>table()</code>: does not work on <code>POSIXlt</code> (list) objects.</li>
<li><code>seq()</code>: it can be specified <code>by="day"</code> argument</li>
</ul>
</section>
<section id="combining" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="combining"><span class="header-section-number">8.3.2</span> Combining</h3>
<ul>
<li><p><code>intersection()</code>: useful for check duplicated column names</p></li>
<li><p><code>make.names()</code>: to generate unique column names</p></li>
<li><p><code>all.equal()</code> : compares two objects and returns TRUE if the match. Also returns a report if there are differences.</p></li>
<li><p><code>isTRUE()</code> : returns TRUE if its argument is a single TRUE (expected for <code>all.equal()</code> ) or FALSE if there are something else.</p></li>
<li><p><code>do.call()</code>: takes the name of a function to be run and a list of arguments and run the function with those arguments-</p></li>
<li><p><code>do.call ( "rbind", list.of.df )</code></p></li>
<li><p><code>merge()</code> arguments:</p>
<ul>
<li><code>(all.x=FALSE, all.y=FALSE)</code> : default options. One row for each key that appears in bot x and y data frames (except when there are duplicated keys). Is an <code>'inner join'</code>.</li>
<li><code>(all.x=TRUE, all.y=FALSE)</code> : One row for each key in x and columns of the corresponding keys that do not appear in y are filled with NA values. Is an <code>'left join'</code>.</li>
<li><code>(all.x=FALSE, all.y=TRUE)</code> : Is the complementary one, an ‘<code>right join</code>’.</li>
<li><code>(all.x=TRUE, all.y=TRUE)</code> : This id the ‘<code>outer join</code>’, when the result has one row for every key in either x or y.</li>
</ul></li>
</ul>
<p>If the key match approximately (people names) the functions <code>adist()</code> and <code>agrep()</code> help find keys that match approximately.</p>
</section>
<section id="comparing-data-frames" class="level3" data-number="8.3.3">
<h3 data-number="8.3.3" class="anchored" data-anchor-id="comparing-data-frames"><span class="header-section-number">8.3.3</span> Comparing Data Frames</h3>
<ul>
<li><p><code>identical()</code> : test for every strict equivalence. Returns <code>TRUE</code> when the two items are equal. Should not be applied to <code>POSIXlt</code> or data frames with this object.</p></li>
<li><p><code>all.equal()</code> : compares two objects but with more room for difference. Returns <code>TRUE</code> when two items are equal. By default is a match between names and attributes of two data frames. Correct way to compare: <code>isTRUE(all.equal(df1, df2))</code></p>
<ul>
<li><code>tolerance=</code> how different two numbers need to be to be declarated different.</li>
</ul></li>
</ul>
</section>
<section id="view-and-editing-data-frames" class="level3" data-number="8.3.4">
<h3 data-number="8.3.4" class="anchored" data-anchor-id="view-and-editing-data-frames"><span class="header-section-number">8.3.4</span> View and Editing Data Frames</h3>
<ul>
<li><code>View()</code> : shows a dear-only representation of a data frame.</li>
<li><code>edit()</code> : allows change to be made. Can be saved to reflect the changes</li>
<li><code>data.entry()</code> : the changes are saved automatically.</li>
</ul>
</section>
</section>
<section id="characters" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="characters"><span class="header-section-number">8.4</span> Characters</h2>
<ul>
<li><p><code>length()</code>: extract how many elements are in it</p></li>
<li><p><code>nchar()</code>: we extract how many letters there are in each element.</p></li>
<li><p><code>keepNA=FALSE</code> allow <code>nchar()</code> to count <code>NA</code> values returning 2 of length.</p></li>
<li><p><code>nzchar()</code>: returns TRUE for strings that have non-zero length and FALSE for empty strings.</p></li>
<li><p><code>trimws()</code>: remove blanks at the beginning and end of each element.</p></li>
<li><p><code>substring()</code> : given a vector extract the selected text.</p>
<ul>
<li><code>first=</code> position of the first character to extract</li>
<li><code>last=</code> position of the last character up to 1 Million. Can be omitted to get the end of the string.</li>
</ul></li>
<li><p><code>tolower(), toupper()</code>: perform convertion to lower or upper case.</p></li>
<li><p><code>casefold()</code> have to be passed the argument <code>upper=</code> being <code>TRUE</code> or <code>FALSE</code> which change to upper or lower case respectively.</p></li>
<li><p><code>chartr()</code>: substitutions. It takes two arguments that are vectors of characters and changes each character in the first argument into the corresponding character in the second argument.</p></li>
</ul>
<section id="formatting-numbers" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="formatting-numbers"><span class="header-section-number">8.4.1</span> Formatting Numbers</h3>
<ul>
<li><code>format()</code> : is a way to format a set of numbers in a common way. E.g. lining up decimal points and commas.
<ul>
<li><code>digits=</code> number of digits</li>
<li><code>nsmall=</code> number of digits (minimum) in the ‘small’ part (the right of the decimal point).</li>
<li><code>big.mark=</code> determine the comma in the ‘big’ part (the thousand mark).</li>
<li><code>drop0trailing</code> , removes trailing zeros in the small part.</li>
<li><code>zero.print=</code> , if TRUE, causes zeros to be printed with spaces.</li>
</ul></li>
<li><code>sprintf()</code>: have a format string containing text and conversion strings, which describe how numbers and other variables should appear in that output. A conversion strings start with a percent sign and contain modifiers and then a conversion character.</li>
<li>The conversion character <code>%i</code> or <code>%d</code> are for integer values, <code>%f</code> is for double-precision numerics, and <code>%s</code> is for character strings. This field can be formatted with two numbers separated by a period, the first one give the minimum width (total number of characters) and the second one is the number of digits to the right of the decimal points.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8 characters, 2 decimals.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> ( <span class="st">"%9.2f"</span>, <span class="fl">1230.456789</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "  1230.46"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 leading the character to fill with 0 until 8 characters.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> ( <span class="st">"%09.2f"</span>, <span class="fl">1230.456789</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "001230.46"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Like the previous one but with spaces</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> ( <span class="st">"% 9.2f"</span>, <span class="fl">1230.456789</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "  1230.46"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Always a simbol leading the number</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> ( <span class="st">"%+9.2f"</span>, <span class="fl">1230.456789</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] " +1230.46"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Left Justified</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> ( <span class="st">"%-9.2f"</span>, <span class="fl">1230.456789</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1230.46  "</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exponential</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> ( <span class="st">"%9.3g"</span>, <span class="fl">1230.456789</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] " 1.23e+03"</code></pre>
</div>
</div>
<p>Also we can use <code>sprintf()</code> with more than one vectors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>costs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">22</span>, <span class="fl">456.32</span>, <span class="fl">89340.4235</span>, <span class="fl">1230045605.959</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> ( <span class="st">"I spent $%.0f in %s"</span>, costs, month.name[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "I spent $3 in February"      "I spent $22 in March"       
[3] "I spent $456 in April"       "I spent $89340 in May"      
[5] "I spent $1230045606 in June"</code></pre>
</div>
</div>
</section>
<section id="discretizing-a-numeric-variable" class="level3" data-number="8.4.2">
<h3 data-number="8.4.2" class="anchored" data-anchor-id="discretizing-a-numeric-variable"><span class="header-section-number">8.4.2</span> Discretizing a Numeric Variable</h3>
<p>Discretizing is to construct a categorical version of a numeric vector with a few levels for exploration or modeling purposes, it is also called ‘binning’.</p>
<ul>
<li><code>cut()</code> : the arguments are the vector to be discretized and the breakpoints; optionally we can pass labels to be applied to the new levels. The result is a factor vector.
<ul>
<li><code>include.lowest=</code> if <code>TRUE</code> will include the left endpoint to the binning. By default will not be included.</li>
<li><code>right=</code> if <code>FALSE</code> makes intervals include their left end and exclude the right.</li>
<li><code>breaks=</code> passing an <code>integer</code> will produce that number of bins with equal width.</li>
</ul></li>
</ul>
</section>
<section id="character-strings" class="level3" data-number="8.4.3">
<h3 data-number="8.4.3" class="anchored" data-anchor-id="character-strings"><span class="header-section-number">8.4.3</span> Character Strings</h3>
<ul>
<li><code>paste()</code> , <code>paste0()</code> : sticks together two character vectors, and if its necessary convert them into a <code>character</code> vector first. By default it will insert a space between them.
<ul>
<li><code>sep=</code> to choose the separation, e.g.&nbsp;<code>sep="."</code> or <code>sep=""</code> .</li>
<li><code>collapse=</code> combines all the strings of the vector into one long string. It will use the separator specified by the value of this argument. e.g.&nbsp;<code>collapse=""</code> or <code>="\t"</code> .</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To combine year.month is also possible with substring() instead of format</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span> ( <span class="fu">paste0</span> (<span class="fu">format</span> (rnd.dts, <span class="st">"%Y"</span>), <span class="st">"."</span>, <span class="fu">quarters</span>(rnd.dts) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><code>outer()</code> : given two vectors, performs another function on each pair of elements producing a matrix.</li>
<li><code>expand.grid()</code> : given vectors of values produces a data frame containing all combinations of all the values.</li>
</ul>
</section>
</section>
<section id="regular-expressions" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="regular-expressions"><span class="header-section-number">8.5</span> Regular Expressions</h2>
<p><code>help("regex")</code></p>
<p>For regular expresson in R there are three primary tools which are <code>grep()</code>, <code>regexpr()</code> and <code>sub()</code>, all tree with its variants.</p>
<ul>
<li><p><code>grep()</code> : given a pattern and a vector of strings, returns a numeric vector with the indices of the string that match the pattern.</p>
<ul>
<li><code>value=</code> if <code>TRUE</code> returns the matching string themselves.</li>
<li><code>ignore.case=</code> if <code>TRUE</code> will ignore whether letters are in upper or lower-case.</li>
<li><code>invert=</code> if <code>TRUE</code> reverses the search, returning the elements that not match. It’s not available with <code>grepl()</code></li>
<li><code>fixed=</code> if <code>TRUE</code> suspends the rules about patterns and simply searches for an exact text string.</li>
<li><code>perl=</code> if <code>TRUE</code> indicate to grep() to use Perl-type regular expressions.</li>
<li><code>useBytes=</code> if <code>TRUE</code> the matching should be done byte by byte.</li>
</ul></li>
<li><p><code>grepl()</code> : returns a logical vector indicating the elements that match.</p></li>
<li><p><code>.*</code> if we have leading text</p></li>
<li><p><code>[0-3]?[0-9]</code> matches a one digit number, the first digit is optional indicated by ‘?’</p></li>
<li><p><code>.*</code> again for additional text</p></li>
<li><p><code>(", or.mon, ")</code> will be the variable with the month names separated by pipes <code>"|"</code>. The parenthesis make this a single pattern. The abbreviations will match a full name.</p></li>
<li><p><code>.*</code> more additional text</p></li>
<li><p><code>[1-2][0-9[{3}</code> four digits that have to start with 1 or 2</p></li>
</ul>
<p>The function <code>regexpr()</code> is more precise than <code>grep()</code>, it will return the location of the first match within the string (number of the first character of the match). This information can be useful to extract the number itself and not only identify the string.</p>
<ul>
<li><p><code>sub()</code> : replaces the first matching pattern.</p></li>
<li><p><code>gsub()</code> : replaces all the matching patterns.</p></li>
<li><p><code>strsplit()</code> : given a vector and a pattern splits the text producing a list with one entry for each string. Also has the fixed=TRUE argument to not use regular expressions.</p></li>
</ul>
<section id="common-data-cleaning-task-using-regular-expressions" class="level3" data-number="8.5.1">
<h3 data-number="8.5.1" class="anchored" data-anchor-id="common-data-cleaning-task-using-regular-expressions"><span class="header-section-number">8.5.1</span> Common Data Cleaning Task Using Regular Expressions</h3>
<p>Because Regular Expressions are complicated be sure to document them well. For debugging there are online aids to diagnosing problems, be sure to specify regular expression type POSIX with GNI extensions or PCRE.</p>
<section id="removing-leading-and-trailing-spaces" class="level4" data-number="8.5.1.1">
<h4 data-number="8.5.1.1" class="anchored" data-anchor-id="removing-leading-and-trailing-spaces"><span class="header-section-number">8.5.1.1</span> Removing Leading and Trailing Spaces</h4>
<ul>
<li><code>"^ *"</code> : any string with leading spaces</li>
<li><code>" *$"</code> : any string with trailing spaces</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span> ( <span class="st">"^ *| *$"</span>, <span class="st">""</span>, <span class="fu">c</span>(<span class="st">"  Text Spaces "</span>, <span class="st">"Trailing    "</span>, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"None"</span>, <span class="st">"     Leading"</span> ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Text Spaces" "Trailing"    "None"        "Leading"    </code></pre>
</div>
</div>
</section>
<section id="format-currency-to-numeric" class="level4" data-number="8.5.1.2">
<h4 data-number="8.5.1.2" class="anchored" data-anchor-id="format-currency-to-numeric"><span class="header-section-number">8.5.1.2</span> Format Currency to Numeric</h4>
<p>Taking into account $12,345.67 or 12,345.67€ we have to remove the symbol and the comma before converting into numeric.</p>
<ul>
<li><code>"\\$"</code> : dollar symbol</li>
<li><code>"\\€"</code> : euro symbol</li>
<li><code>"^[^0-9.]"</code> : non-numeric leading character</li>
<li><code>"[^[:digit:].]$"</code> : non-numeric trailing character</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span> ( <span class="fu">gsub</span> (<span class="st">"(^[^0-9.]|,)|(,|[^[:digit:].]$)"</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">""</span>, <span class="fu">c</span>(<span class="st">"$12,345.67"</span>, <span class="st">"98,765.43€"</span>) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12345.67 98765.43</code></pre>
</div>
</div>
</section>
</section>
<section id="utf-8-and-other-non-ascii-characters" class="level3" data-number="8.5.2">
<h3 data-number="8.5.2" class="anchored" data-anchor-id="utf-8-and-other-non-ascii-characters"><span class="header-section-number">8.5.2</span> UTF-8 and Other Non-ASCII Characters</h3>
<ul>
<li><code>Encoding()</code> : returns the encoding of the strings in a vector</li>
<li><code>iconv()</code> : to convert the encodings.</li>
</ul>
</section>
</section>
</section>
<section id="factors" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Factors</h1>
<ul>
<li><code>as.factor()</code></li>
<li><code>levels()</code> : to check the levels in a factor vector and also to assign levels. This not change the underlying integer value corresponding that level. <code>factor()</code>: The levels can be reordered, this is useful for months and other levels that we want to have a custom order.</li>
</ul>
<p><strong>Do not try</strong> to change the order with <code>levels()</code> function. In this case will change the levels of the elements itself, will not change ‘only’ the order.</p>
<ul>
<li><code>addNA()</code> to add a level which is a NA value, but will be better to replace NA values</li>
</ul>
</section>
<section id="r-objects-and-commands" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> R Objects and Commands</h1>
<ul>
<li><code>get()</code> : accepts a character string and returns the object with that name.</li>
<li><code>exists()</code> : can test to see whether an object exists</li>
<li><code>get0()</code> : allow a value to be specified in place of the error.</li>
<li><code>ls()</code> : returns the names of the objects.</li>
<li><code>assing()</code> : given a name and a value creates a new R object. The argument <code>pos=1</code> at the command line has no effect, but inside a function it creates a variable in the Workspace.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span> (<span class="fu">paste0</span> (LETTERS[i], <span class="fu">c</span>(month.abb,month.abb)[i] ), i, <span class="at">pos =</span> <span class="dv">1</span> )</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>let.mon <span class="ot">&lt;-</span> <span class="fu">ls</span> (<span class="at">pattern =</span> <span class="st">"^[A-Z]{2}?[a-z]{2}?"</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>let.mon[<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CMar" "DApr" "EMay" "FJun"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span> (let.mon, <span class="cf">function</span>(i) <span class="fu">object.size</span>(<span class="fu">get</span>(i)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AJan BFeb CMar DApr EMay FJun GJul HAug ISep JOct KNov LDec MJan NFeb OMar PApr 
  56   56   56   56   56   56   56   56   56   56   56   56   56   56   56   56 
QMay RJun SJul TAug USep VOct WNov XDec 
  56   56   56   56   56   56   56   56 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span> (<span class="at">list =</span> <span class="fu">grep</span> (<span class="st">"^[A-Z]{2}?[a-z]{2}?"</span>, <span class="fu">ls</span>(), <span class="at">value =</span> T ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>parse()</code> : to create an R ‘expression’ object with <code>text</code> argument.</li>
<li><code>eval()</code> : executes the expression</li>
</ul>
<p><code>eval(parse(text = "log.11 &lt;- log(11)"))</code> : will create a variable called ‘log.11’. The combination of <code>parse()</code> and <code>eval()</code> lets us construct R commands and execute them (allowing us to execute sequences of commands once we have created them with <code>paste()</code> and other tools).</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../to_book/notebooks/03_data_handling.html" class="pagination-link" aria-label="Data Handling">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Handling</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../to_book/notebooks/11_transformations_tidyverse.html" class="pagination-link" aria-label="Transformations with Tidyverse">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Transformations with Tidyverse</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>