<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Alvaro Manzanas - 2&nbsp; R: The very basics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../_book-lib-dir/quarto-nav/quarto-nav.js"></script>
<script src="../../_book-lib-dir/clipboard/clipboard.min.js"></script>
<script src="../../_book-lib-dir/quarto-search/autocomplete.umd.js"></script>
<script src="../../_book-lib-dir/quarto-search/fuse.min.js"></script>
<script src="../../_book-lib-dir/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../to_book/notebooks/01_functions_scripts.html" rel="next">
<link href="../../index.html" rel="prev">
<script src="../../_book-lib-dir/quarto-html/quarto.js"></script>
<script src="../../_book-lib-dir/quarto-html/popper.min.js"></script>
<script src="../../_book-lib-dir/quarto-html/tippy.umd.min.js"></script>
<script src="../../_book-lib-dir/quarto-html/anchor.min.js"></script>
<link href="../../_book-lib-dir/quarto-html/tippy.css" rel="stylesheet">
<link href="../../_book-lib-dir/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../_book-lib-dir/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../_book-lib-dir/bootstrap/bootstrap.min.js"></script>
<link href="../../_book-lib-dir/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../_book-lib-dir/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../_book-lib-dir/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Alvaro Manzanas</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../portfolio.html"> 
<span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> 
<span class="menu-text">Annotations</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cv" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">CV</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-cv">    
        <li>
    <a class="dropdown-item" href="../../docs/Alvaro Manzanas-CV_es.pdf" target="_blank">
 <span class="dropdown-text">Spanish</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/Alvaro Manzanas-CV_en.pdf" target="_blank">
 <span class="dropdown-text">English</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="http://github.com/almanzanas" target="_blank"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:almanzanas@gmx.com"> <i class="bi bi-bi bi-envelope" role="img" aria-label="e-mail">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://es.linkedin.com/in/alvaromanzanas" target="_blank"> <i class="bi bi-linkedin" role="img" aria-label="Linkedin">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../to_book/notebooks/00_basics_ndata.html">Base R</a></li><li class="breadcrumb-item"><a href="../../to_book/notebooks/00_basics_ndata.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">R: The very basics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="sidebar-tools-main tools-wide">
    <a href="http://github.com/almanzanas" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="mailto:almanzanas@gmx.com" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-bi bi-envelope"></i></a>
    <a href="https://es.linkedin.com/in/alvaromanzanas" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-linkedin"></i></a>
</div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Annotations</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Base R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/00_basics_ndata.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">R: The very basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/01_functions_scripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Functions, scripts and performance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/02_data_into_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data into R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/03_data_handling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Handling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/99_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Base-R Summary</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Data Wrangling and Model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/11_transformations_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Transformations with Tidyverse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/12_ExpDatAn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/13_enchanced_visualizations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Enchanced Visualizations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../to_book/notebooks/14_modeling2deploy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Modeling to Deploy</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-very-basics" id="toc-the-very-basics" class="nav-link active" data-scroll-target="#the-very-basics"><span class="header-section-number">3</span> The very basics</a>
  <ul class="collapse">
  <li><a href="#getting-help" id="toc-getting-help" class="nav-link" data-scroll-target="#getting-help"><span class="header-section-number">3.1</span> Getting Help</a></li>
  </ul></li>
  <li><a href="#r-data-vectors" id="toc-r-data-vectors" class="nav-link" data-scroll-target="#r-data-vectors"><span class="header-section-number">4</span> R Data: Vectors</a>
  <ul class="collapse">
  <li><a href="#vector-operations" id="toc-vector-operations" class="nav-link" data-scroll-target="#vector-operations"><span class="header-section-number">4.1</span> Vector Operations</a></li>
  <li><a href="#handling-character-vectors" id="toc-handling-character-vectors" class="nav-link" data-scroll-target="#handling-character-vectors"><span class="header-section-number">4.2</span> Handling character vectors</a></li>
  <li><a href="#data-types" id="toc-data-types" class="nav-link" data-scroll-target="#data-types"><span class="header-section-number">4.3</span> Data Types</a>
  <ul class="collapse">
  <li><a href="#data-type-conversion" id="toc-data-type-conversion" class="nav-link" data-scroll-target="#data-type-conversion"><span class="header-section-number">4.3.1</span> Data Type conversion</a></li>
  </ul></li>
  <li><a href="#subsets-of-vectors" id="toc-subsets-of-vectors" class="nav-link" data-scroll-target="#subsets-of-vectors"><span class="header-section-number">4.4</span> Subsets of Vectors</a>
  <ul class="collapse">
  <li><a href="#subscript-numeric" id="toc-subscript-numeric" class="nav-link" data-scroll-target="#subscript-numeric"><span class="header-section-number">4.4.1</span> subscript: numeric</a></li>
  <li><a href="#subscript-logical" id="toc-subscript-logical" class="nav-link" data-scroll-target="#subscript-logical"><span class="header-section-number">4.4.2</span> Subscript: logical</a></li>
  <li><a href="#subscript-names" id="toc-subscript-names" class="nav-link" data-scroll-target="#subscript-names"><span class="header-section-number">4.4.3</span> subscript: names</a></li>
  <li><a href="#vector-length-0" id="toc-vector-length-0" class="nav-link" data-scroll-target="#vector-length-0"><span class="header-section-number">4.4.4</span> Vector length 0</a></li>
  <li><a href="#replacing-elements-of-a-vector" id="toc-replacing-elements-of-a-vector" class="nav-link" data-scroll-target="#replacing-elements-of-a-vector"><span class="header-section-number">4.4.5</span> Replacing elements of a vector</a></li>
  </ul></li>
  <li><a href="#missing-data-na" id="toc-missing-data-na" class="nav-link" data-scroll-target="#missing-data-na"><span class="header-section-number">4.5</span> Missing Data NA</a></li>
  <li><a href="#the-table-function" id="toc-the-table-function" class="nav-link" data-scroll-target="#the-table-function"><span class="header-section-number">4.6</span> The <code>Table( )</code> function</a>
  <ul class="collapse">
  <li><a href="#operating-on-tables" id="toc-operating-on-tables" class="nav-link" data-scroll-target="#operating-on-tables"><span class="header-section-number">4.6.1</span> Operating on tables</a></li>
  </ul></li>
  <li><a href="#other-actions-on-vectors" id="toc-other-actions-on-vectors" class="nav-link" data-scroll-target="#other-actions-on-vectors"><span class="header-section-number">4.7</span> Other Actions on Vectors</a>
  <ul class="collapse">
  <li><a href="#rounding" id="toc-rounding" class="nav-link" data-scroll-target="#rounding"><span class="header-section-number">4.7.1</span> Rounding</a></li>
  <li><a href="#sorting-and-ordering" id="toc-sorting-and-ordering" class="nav-link" data-scroll-target="#sorting-and-ordering"><span class="header-section-number">4.7.2</span> Sorting and Ordering</a></li>
  <li><a href="#vector-as-sets" id="toc-vector-as-sets" class="nav-link" data-scroll-target="#vector-as-sets"><span class="header-section-number">4.7.3</span> Vector as Sets</a></li>
  </ul></li>
  <li><a href="#duplicates" id="toc-duplicates" class="nav-link" data-scroll-target="#duplicates"><span class="header-section-number">4.8</span> Duplicates</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">4.9</span> Summary</a>
  <ul class="collapse">
  <li><a href="#conversions" id="toc-conversions" class="nav-link" data-scroll-target="#conversions"><span class="header-section-number">4.9.1</span> Conversions</a></li>
  <li><a href="#subscripts" id="toc-subscripts" class="nav-link" data-scroll-target="#subscripts"><span class="header-section-number">4.9.2</span> Subscripts</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#r-data-other-structures" id="toc-r-data-other-structures" class="nav-link" data-scroll-target="#r-data-other-structures"><span class="header-section-number">5</span> R Data: Other Structures</a>
  <ul class="collapse">
  <li><a href="#matrices" id="toc-matrices" class="nav-link" data-scroll-target="#matrices"><span class="header-section-number">5.1</span> Matrices</a>
  <ul class="collapse">
  <li><a href="#row-and-column-names" id="toc-row-and-column-names" class="nav-link" data-scroll-target="#row-and-column-names"><span class="header-section-number">5.1.1</span> Row and Column Names</a></li>
  <li><a href="#applying-functions" id="toc-applying-functions" class="nav-link" data-scroll-target="#applying-functions"><span class="header-section-number">5.1.2</span> Applying Functions</a></li>
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values"><span class="header-section-number">5.1.3</span> Missing Values</a></li>
  <li><a href="#matrix-subscripts" id="toc-matrix-subscripts" class="nav-link" data-scroll-target="#matrix-subscripts"><span class="header-section-number">5.1.4</span> Matrix Subscripts</a></li>
  <li><a href="#higher-way-arrays" id="toc-higher-way-arrays" class="nav-link" data-scroll-target="#higher-way-arrays"><span class="header-section-number">5.1.5</span> Higher-way Arrays</a></li>
  </ul></li>
  <li><a href="#lists" id="toc-lists" class="nav-link" data-scroll-target="#lists"><span class="header-section-number">5.2</span> Lists</a>
  <ul class="collapse">
  <li><a href="#excracting-from-list" id="toc-excracting-from-list" class="nav-link" data-scroll-target="#excracting-from-list"><span class="header-section-number">5.2.1</span> Excracting from list</a></li>
  </ul></li>
  <li><a href="#data-frames" id="toc-data-frames" class="nav-link" data-scroll-target="#data-frames"><span class="header-section-number">5.3</span> Data Frames</a>
  <ul class="collapse">
  <li><a href="#missing-values-1" id="toc-missing-values-1" class="nav-link" data-scroll-target="#missing-values-1"><span class="header-section-number">5.3.1</span> Missing Values</a></li>
  </ul></li>
  <li><a href="#operating-on-lists-and-data-frames" id="toc-operating-on-lists-and-data-frames" class="nav-link" data-scroll-target="#operating-on-lists-and-data-frames"><span class="header-section-number">5.4</span> Operating on Lists and Data Frames</a>
  <ul class="collapse">
  <li><a href="#spliy-apply-combine" id="toc-spliy-apply-combine" class="nav-link" data-scroll-target="#spliy-apply-combine"><span class="header-section-number">5.4.1</span> Spliy, Apply, Combine</a></li>
  <li><a href="#all-numeric-data-frames" id="toc-all-numeric-data-frames" class="nav-link" data-scroll-target="#all-numeric-data-frames"><span class="header-section-number">5.4.2</span> All-Numeric Data Frames</a></li>
  <li><a href="#convenience-functions" id="toc-convenience-functions" class="nav-link" data-scroll-target="#convenience-functions"><span class="header-section-number">5.4.3</span> Convenience Functions</a></li>
  <li><a href="#re-ordering-de-duplicating-sampling" id="toc-re-ordering-de-duplicating-sampling" class="nav-link" data-scroll-target="#re-ordering-de-duplicating-sampling"><span class="header-section-number">5.4.4</span> Re-Ordering, De-Duplicating, Sampling</a></li>
  </ul></li>
  <li><a href="#date-and-time-objects" id="toc-date-and-time-objects" class="nav-link" data-scroll-target="#date-and-time-objects"><span class="header-section-number">5.5</span> Date and Time Objects</a>
  <ul class="collapse">
  <li><a href="#formatting-dates" id="toc-formatting-dates" class="nav-link" data-scroll-target="#formatting-dates"><span class="header-section-number">5.5.1</span> Formatting Dates</a></li>
  <li><a href="#operations-on-date-objects" id="toc-operations-on-date-objects" class="nav-link" data-scroll-target="#operations-on-date-objects"><span class="header-section-number">5.5.2</span> Operations on Date Objects</a></li>
  <li><a href="#posixt-objects" id="toc-posixt-objects" class="nav-link" data-scroll-target="#posixt-objects"><span class="header-section-number">5.5.3</span> <code>POSIXt</code> Objects</a></li>
  <li><a href="#missing-values-2" id="toc-missing-values-2" class="nav-link" data-scroll-target="#missing-values-2"><span class="header-section-number">5.5.4</span> Missing Values</a></li>
  <li><a href="#apply-on-dates" id="toc-apply-on-dates" class="nav-link" data-scroll-target="#apply-on-dates"><span class="header-section-number">5.5.5</span> <code>Apply()</code> on Dates</a></li>
  </ul></li>
  <li><a href="#actions-with-data-frames" id="toc-actions-with-data-frames" class="nav-link" data-scroll-target="#actions-with-data-frames"><span class="header-section-number">5.6</span> Actions with Data Frames</a>
  <ul class="collapse">
  <li><a href="#combining-by-rows-or-columns" id="toc-combining-by-rows-or-columns" class="nav-link" data-scroll-target="#combining-by-rows-or-columns"><span class="header-section-number">5.6.1</span> Combining by Rows or Columns</a></li>
  <li><a href="#merging-data-frames" id="toc-merging-data-frames" class="nav-link" data-scroll-target="#merging-data-frames"><span class="header-section-number">5.6.2</span> Merging Data Frames</a></li>
  <li><a href="#comparing-data-frames" id="toc-comparing-data-frames" class="nav-link" data-scroll-target="#comparing-data-frames"><span class="header-section-number">5.6.3</span> Comparing Data Frames</a></li>
  <li><a href="#view-and-editing-data-frames" id="toc-view-and-editing-data-frames" class="nav-link" data-scroll-target="#view-and-editing-data-frames"><span class="header-section-number">5.6.4</span> View and Editing Data Frames</a></li>
  </ul></li>
  <li><a href="#handling-big-data" id="toc-handling-big-data" class="nav-link" data-scroll-target="#handling-big-data"><span class="header-section-number">5.7</span> Handling Big Data</a></li>
  <li><a href="#data-handling-tools" id="toc-data-handling-tools" class="nav-link" data-scroll-target="#data-handling-tools"><span class="header-section-number">5.8</span> Data Handling Tools</a></li>
  </ul></li>
  <li><a href="#r-data-text-and-factors" id="toc-r-data-text-and-factors" class="nav-link" data-scroll-target="#r-data-text-and-factors"><span class="header-section-number">6</span> R Data: Text and Factors</a>
  <ul class="collapse">
  <li><a href="#character-data" id="toc-character-data" class="nav-link" data-scroll-target="#character-data"><span class="header-section-number">6.1</span> Character Data</a>
  <ul class="collapse">
  <li><a href="#length-and-nchar" id="toc-length-and-nchar" class="nav-link" data-scroll-target="#length-and-nchar"><span class="header-section-number">6.1.1</span> <code>length()</code> and <code>nchar()</code></a></li>
  <li><a href="#escaped-characters" id="toc-escaped-characters" class="nav-link" data-scroll-target="#escaped-characters"><span class="header-section-number">6.1.2</span> Escaped characters</a></li>
  <li><a href="#substrings" id="toc-substrings" class="nav-link" data-scroll-target="#substrings"><span class="header-section-number">6.1.3</span> Substrings</a></li>
  <li><a href="#case-and-substitutions" id="toc-case-and-substitutions" class="nav-link" data-scroll-target="#case-and-substitutions"><span class="header-section-number">6.1.4</span> Case and Substitutions</a></li>
  </ul></li>
  <li><a href="#converting-numbers-into-text" id="toc-converting-numbers-into-text" class="nav-link" data-scroll-target="#converting-numbers-into-text"><span class="header-section-number">6.2</span> Converting numbers into text</a>
  <ul class="collapse">
  <li><a href="#formatting-numbers" id="toc-formatting-numbers" class="nav-link" data-scroll-target="#formatting-numbers"><span class="header-section-number">6.2.1</span> Formatting Numbers</a></li>
  <li><a href="#scientific-notation" id="toc-scientific-notation" class="nav-link" data-scroll-target="#scientific-notation"><span class="header-section-number">6.2.2</span> Scientific Notation</a></li>
  <li><a href="#discretizing-a-numeric-variable" id="toc-discretizing-a-numeric-variable" class="nav-link" data-scroll-target="#discretizing-a-numeric-variable"><span class="header-section-number">6.2.3</span> Discretizing a Numeric Variable</a></li>
  </ul></li>
  <li><a href="#character-strings" id="toc-character-strings" class="nav-link" data-scroll-target="#character-strings"><span class="header-section-number">6.3</span> Character Strings</a>
  <ul class="collapse">
  <li><a href="#column-names" id="toc-column-names" class="nav-link" data-scroll-target="#column-names"><span class="header-section-number">6.3.1</span> Column Names</a></li>
  <li><a href="#tabulating-dates" id="toc-tabulating-dates" class="nav-link" data-scroll-target="#tabulating-dates"><span class="header-section-number">6.3.2</span> Tabulating Dates</a></li>
  <li><a href="#unique-keys" id="toc-unique-keys" class="nav-link" data-scroll-target="#unique-keys"><span class="header-section-number">6.3.3</span> Unique Keys</a></li>
  <li><a href="#files-and-path-names" id="toc-files-and-path-names" class="nav-link" data-scroll-target="#files-and-path-names"><span class="header-section-number">6.3.4</span> Files and Path names</a></li>
  </ul></li>
  <li><a href="#regular-expressions" id="toc-regular-expressions" class="nav-link" data-scroll-target="#regular-expressions"><span class="header-section-number">6.4</span> Regular Expressions</a>
  <ul class="collapse">
  <li><a href="#regexpr" id="toc-regexpr" class="nav-link" data-scroll-target="#regexpr"><span class="header-section-number">6.4.1</span> <code>regexpr()</code></a></li>
  <li><a href="#replacement-with-regular-expressions" id="toc-replacement-with-regular-expressions" class="nav-link" data-scroll-target="#replacement-with-regular-expressions"><span class="header-section-number">6.4.2</span> Replacement with Regular Expressions</a></li>
  <li><a href="#splitting-with-regular-expressions" id="toc-splitting-with-regular-expressions" class="nav-link" data-scroll-target="#splitting-with-regular-expressions"><span class="header-section-number">6.4.3</span> Splitting with Regular Expressions</a></li>
  <li><a href="#common-data-cleaning-task-using-regular-expressions" id="toc-common-data-cleaning-task-using-regular-expressions" class="nav-link" data-scroll-target="#common-data-cleaning-task-using-regular-expressions"><span class="header-section-number">6.4.4</span> Common Data Cleaning Task Using Regular Expressions</a></li>
  <li><a href="#recomendations" id="toc-recomendations" class="nav-link" data-scroll-target="#recomendations"><span class="header-section-number">6.4.5</span> Recomendations</a></li>
  </ul></li>
  <li><a href="#utf-8-and-other-non-ascii-characters" id="toc-utf-8-and-other-non-ascii-characters" class="nav-link" data-scroll-target="#utf-8-and-other-non-ascii-characters"><span class="header-section-number">6.5</span> UTF-8 and Other Non-ASCII Characters</a></li>
  <li><a href="#factors" id="toc-factors" class="nav-link" data-scroll-target="#factors"><span class="header-section-number">6.6</span> Factors</a>
  <ul class="collapse">
  <li><a href="#missing-values-3" id="toc-missing-values-3" class="nav-link" data-scroll-target="#missing-values-3"><span class="header-section-number">6.6.1</span> Missing Values</a></li>
  </ul></li>
  <li><a href="#r-objects-and-commands" id="toc-r-objects-and-commands" class="nav-link" data-scroll-target="#r-objects-and-commands"><span class="header-section-number">6.7</span> R Objects and Commands</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../to_book/notebooks/00_basics_ndata.html">Base R</a></li><li class="breadcrumb-item"><a href="../../to_book/notebooks/00_basics_ndata.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">R: The very basics</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">R: The very basics</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="the-very-basics" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> The very basics</h1>
<section id="getting-help" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="getting-help"><span class="header-section-number">3.1</span> Getting Help</h2>
<p>At the command line we can look for help through the commands:</p>
<ul>
<li><p><code>help()</code>: gets information on a particular R function, e.g.&nbsp;<code>help(matrix)</code></p></li>
<li><p><code>?</code>: works the same as the previous one, e.g.&nbsp;<code>?"matrix"</code></p></li>
<li><p><code>help.search()</code>: It’s useful if we know the subject rather than the name.</p></li>
<li><p><code>apropos()</code>: returns a vector of names of objects containing that string, e.g.&nbsp;<code>apropos("matrix")</code> returns every object with ‘matrix’ in its name.</p></li>
<li><p><code>args()</code>: displays the set of arguments expected by a given function.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">args</span>(matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (data = NA, nrow = 1, ncol = 1, byrow = FALSE, dimnames = NULL) 
NULL</code></pre>
</div>
</div>
</section>
</section>
<section id="r-data-vectors" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> R Data: Vectors</h1>
<p>A vector is the basic unit of computation in R. The atomic class which we can see with <code>help(vector)</code> are:</p>
<ul>
<li>logical: TRUE or FALSE (T or F as synonyms)</li>
<li>integer</li>
<li>numeric or double</li>
<li>character: is the text</li>
<li>raw: can hold binary data</li>
<li>complex</li>
</ul>
<p>To combines items into a vector we use <code>c()</code> function. Cal also be used to combine vector, as long as all the vectors are of the same sort.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2 25</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R has formatted the numbers in a consistent way</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, pi, <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.000000  3.141593 25.000000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="fu">c</span>(pi, <span class="fl">16.7</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="sc">-</span><span class="dv">12</span>, <span class="sc">-</span><span class="dv">16</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   2.000000   3.000000   3.141593  16.700000   5.000000 -12.000000 -16.000000</code></pre>
</div>
</div>
<p>To set consecutive integers:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5 6 7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sequence in reverse</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span><span class="sc">:-</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  9  8  7  6  5  4  3  2  1  0 -1 -2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># It's 3 plus the sequence</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5 6 7 8</code></pre>
</div>
</div>
<p>Using <code>help(Syntax)</code> It can be seen a list of operators and their precedences, and precedence can always be over-ridden with parentheses.</p>
<p>Also with <code>seq()</code> we can create sequences, with better control of starting points, ending points, lengths, and step sizes. With help we can see:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(...)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Default S3 method:</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> ((to <span class="sc">-</span> from)<span class="sc">/</span>(length.out <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">length.out =</span> <span class="cn">NULL</span>, <span class="at">along.with =</span> <span class="cn">NULL</span>, ...)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examples:</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">17</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">11</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">9</span>, <span class="at">by =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Logical vectors ofen are constructed by R in response to an operation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="dv">35</span><span class="sc">:</span><span class="dv">41</span> <span class="sc">&gt;=</span> <span class="dv">37</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE</code></pre>
</div>
</div>
<p>To calculate the number or proportions of elements in a vector we use <code>sum()</code> for count and <code>mean()</code> for proportions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># like we saw, five out of seven elements in this vector are greater or equal to 37</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="dv">35</span><span class="sc">:</span><span class="dv">41</span> <span class="sc">&gt;=</span> <span class="dv">37</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 out of 7 are aprox. 71.4%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="dv">35</span><span class="sc">:</span><span class="dv">41</span> <span class="sc">&gt;=</span> <span class="dv">37</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7142857</code></pre>
</div>
</div>
<section id="vector-operations" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="vector-operations"><span class="header-section-number">4.1</span> Vector Operations</h2>
<p>Arithmetic operations on vectors produce vectors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="sc">:</span><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  5  6  7  8  9 10</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  25  36  49  64  81 100</code></pre>
</div>
</div>
<p>There are functions which returns a single number (that is also a vector), such as: <code>length(), sum(), mean(), sd(), min(), max()</code>. The function <code>range()</code> returns the smallest and largest values, and <code>summary()</code> returns a vector of summary statistics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># An assigment with parentheses case print this assigment</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>(th1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">15</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">0</span>)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 400 225 100  25   0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>th2 <span class="ot">&lt;-</span> <span class="dv">105</span><span class="sc">:</span><span class="dv">101</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>th2 <span class="sc">+</span> th1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 505 329 203 127 101</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>th2 <span class="sc">/</span> th1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2625000 0.4622222 1.0300000 4.0800000       Inf</code></pre>
</div>
</div>
<p>It’s Computed element by element, that’s why print ‘Inf’, because 101/0 refer to an infinite value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the larger value anywhere</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(th1, th2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 400</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 'Parallel maximum' print the larger of each pair</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pmax</span>(th2, th1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 400 225 103 102 101</code></pre>
</div>
</div>
<p>Loginac vectors can also be combined. The operator <code>|</code> for ‘or’ return TRUE if either element is TRUE; the <code>&amp;</code> operator for ‘and’ return TRUE only if both elements are TRUE. This single version evaluate the condition for every pair of elements from both vectors, the double version ( <code>|| , &amp;&amp;</code>) evaluate multiple TRUE/FALSE conditions from left to right, stopping as soon as possible (are useful in <code>if()</code> statements).</p>
<p>Recycling</p>
<p>When a vector does not match with other vector to be operated, the shorter one starts again, recycling it’s elements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Two vector with the same length, 6</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>, <span class="dv">10000</span>, <span class="dv">100000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]      5     16    107   1008  10009 100010</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The sum is element by element</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Two vectors, 6 and 3 elements</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   6  16 107   9  19 110</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6-vector and 5 vector. The second recycle it's first element (10 + 3)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in 5:10 + c(3, 4, 5, 6, 7): longer object length is not a multiple of
shorter object length</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  8 10 12 14 16 13</code></pre>
</div>
</div>
<p>Recycling a vector of length 1 (<code>(5:10) + 4</code>) is very common, but the other lengths ir rarer. If we see the last warning, It’s better to treat that as an error and try to resolve it.</p>
</section>
<section id="handling-character-vectors" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="handling-character-vectors"><span class="header-section-number">4.2</span> Handling character vectors</h2>
<p>We can add names to a vector to identify individual entries. R accept letters, numbers, dots, and underscores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">201</span>, <span class="dv">202</span>, <span class="dv">203</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># It is a bad practice to have a vector's name invalid:</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(vec) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"with space"</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a"          "b"          "with space"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Also, we can assign names directly</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">201</span>, <span class="at">b =</span> <span class="dv">202</span>, <span class="at">with.space =</span> <span class="dv">203</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>vec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         a          b with.space 
       201        202        203 </code></pre>
</div>
</div>
</section>
<section id="data-types" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="data-types"><span class="header-section-number">4.3</span> Data Types</h2>
<p>The most common data types are numeric, logical and character. These are some less-common data types:</p>
<ul>
<li>integers: values between -(2<sup>31</sup> -1) and 2<sup>31</sup> -1. Values outside this range may be displayed as integers but will be stored as doubles. To regard an item as an integer you can add <code>L</code> on its end ( <code>246L</code> ), this only makes sense whether really is an integer.</li>
<li>raw: refers to data kept in binary (hexadecimal) form. Is data from images, sound and video, R will stored as raw. It can be converted into character data with <code>rawToChar()</code> function. Reading raw data could be useful to handle the case of unexpected characters.</li>
<li>complex number: R can manipulate complex numbers but almost never arise in data cleaning.</li>
</ul>
<p>We can see what data type is a vector with <code>typeof()</code> which differentiates between integer and double. Other function called <code>mode()</code> calls them both numeric. The <code>str()</code> function return the data type and the first few entries. And <code>class()</code> is more general operator for complex types.</p>
<p>The functions: <code>is.logical(), is.integer(), is.numeric(), is.character()</code> returns a single logical value whether is TRUE or FALSE. A particularly useful function for more complicated or user-defined clases is <code>is()</code> which lets you specify the class as an argument: <code>is(pi, "numeric")</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mode</span>(vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
</div>
<section id="data-type-conversion" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="data-type-conversion"><span class="header-section-number">4.3.1</span> Data Type conversion</h3>
<p>R modifies the entire vector to be of the more complicated type. If you create a numeric vector but you adds a character, the entire vector will be converted to character:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="st">"7"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>vec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1" "2" "3" "4" "5" "6" "7"</code></pre>
</div>
</div>
<p>Types: logical &lt; raw &lt; numeric &lt; complex &lt; character.</p>
<p>Other group of functios are <code>as.</code> to convert vectors:</p>
<ul>
<li><p><code>as.numeric</code>: a character will be converted to a numeric if it has the syuntax of a number.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The element which no fit as numeric will be NA values by coercion</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>( <span class="fu">c</span>(<span class="st">"123.4"</span>, <span class="st">"-1234e-2"</span>, <span class="st">"4,567"</span>, <span class="st">"45. 67"</span>, <span class="st">"$12"</span>, <span class="st">"45%"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: NAs introduced by coercion</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 123.40 -12.34     NA     NA     NA     NA</code></pre>
</div>
</div></li>
<li><p><code>as.logical</code>: Numeric values that are zero become FALSE, otherwise become TRUE. Sometimes numbers that you expect to be zero aren’t because of floating-point error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The third is FALSE because it is outside the range of double precision.</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The last element 'should' be zero but aren't because floating-point error.</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.logical</span>( <span class="fu">c</span>(<span class="dv">123</span>, <span class="dv">5-5</span>, <span class="sc">-</span><span class="fl">1e-34</span>, <span class="fl">1e-500</span>, <span class="dv">1</span><span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">49</span> <span class="sc">*</span> <span class="dv">49</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE  TRUE FALSE  TRUE</code></pre>
</div>
</div></li>
</ul>
<p>Numeric, non-missing values never produce NA when converted to logical.</p>
</section>
</section>
<section id="subsets-of-vectors" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="subsets-of-vectors"><span class="header-section-number">4.4</span> Subsets of Vectors</h2>
<p><em>subsetting</em> or <em>extracting</em> is to pull out a piece of a vector.</p>
<section id="subscript-numeric" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="subscript-numeric"><span class="header-section-number">4.4.1</span> subscript: numeric</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5-vector</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>(a <span class="ot">&lt;-</span> <span class="dv">101</span><span class="sc">:</span><span class="dv">105</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101 102 103 104 105</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract element number 3</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 103</code></pre>
</div>
</div>
<p>We can use a numeric expression to compute a subscript but only if we are sure that expression is an integer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the fourth and second element</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>a[<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 104 102</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the element corresponding to 3+2 </span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">3</span><span class="sc">+</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 105</code></pre>
</div>
</div>
<p>Negative numbers omit this elements, but you cannot mix negative and positive numbers. Zeros are permited but they are ignored by R.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>a[<span class="sc">-</span><span class="dv">2</span>]</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Omit the first and second element</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>a[<span class="sc">-</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) ]</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># mix of positive and negative, result an error</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>a[<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="subscript-logical" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="subscript-logical"><span class="header-section-number">4.4.2</span> Subscript: logical</h3>
<p>A logical subscript is a logical vector of the same length as the thing being extracted from. TRUE are returned, FALSE are not.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># numeric vector with ages</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">32</span>, <span class="dv">43</span>, <span class="dv">54</span>, <span class="dv">65</span>, <span class="dv">76</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>age <span class="sc">&gt;</span> <span class="dv">60</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE FALSE FALSE  TRUE  TRUE</code></pre>
</div>
</div>
<p>We can use the last logical vector to extract elements of age, or combining it with other vectors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Which ages are greater than 60</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>age[age <span class="sc">&gt;</span> <span class="dv">60</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 65 76</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>people <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Yoshua"</span>, <span class="st">"Mery"</span>, <span class="st">"Alex"</span>, <span class="st">"John"</span>, <span class="st">"Lee"</span>, <span class="st">"Cindy"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co"># To which people corresponds their age greater than 60</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>people[age <span class="sc">&gt;</span> <span class="dv">60</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lee"   "Cindy"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a new variable with the previous subscript</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>age.gt<span class="fl">.60</span> <span class="ot">&lt;-</span> age <span class="sc">&gt;</span> <span class="dv">60</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>people[age.gt<span class="fl">.60</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lee"   "Cindy"</code></pre>
</div>
</div>
<p>Errors to avoid:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R convert the logical subscript to numeric</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the extraction produces the first element of the vector two times</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>people[<span class="dv">0</span> <span class="sc">+</span> age.gt<span class="fl">.60</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yoshua" "Yoshua"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With the negative sign, R convert again into numeric values</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The extraction drops the first value and rest are returned</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>people[<span class="sc">-</span>age.gt<span class="fl">.60</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mery"  "Alex"  "John"  "Lee"   "Cindy"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is, probably, the intended form:</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The operator ! to print which values are not greater than 60</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>people[ <span class="sc">!</span>age.gt<span class="fl">.60</span> ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yoshua" "Mery"   "Alex"   "John"  </code></pre>
</div>
</div>
<p>The <code>which()</code> function can be used to convert a logical vector into a numeric. It returns the indices of the element that are TRUE.</p>
<p>To find the location of every minimum value in the variable ‘y’ we can use <code>which(y == min(y)</code>. The alternative are <code>which.min()</code> and <code>which.max()</code> but only select the first index with the minimum or maximum value.</p>
</section>
<section id="subscript-names" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="subscript-names"><span class="header-section-number">4.4.3</span> subscript: names</h3>
<p>A name subscript will need to be a character.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>(vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">201</span>, <span class="at">b =</span> <span class="dv">202</span>, <span class="at">with.space =</span> <span class="dv">203</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         a          b with.space 
       201        202        203 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>vec[<span class="st">"b"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  b 
202 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Names of 'vec' distinct to 'a'</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>vec[<span class="fu">names</span>(vec) <span class="sc">!=</span> <span class="st">"a"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         b with.space 
       202        203 </code></pre>
</div>
</div>
</section>
<section id="vector-length-0" class="level3" data-number="4.4.4">
<h3 data-number="4.4.4" class="anchored" data-anchor-id="vector-length-0"><span class="header-section-number">4.4.4</span> Vector length 0</h3>
<p>This usually happens when all of the elements of a logical subscript are FALSE.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101 102 103 104 105</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> a[a <span class="sc">&lt;</span> <span class="dv">99</span>]</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>integer(0)</code></pre>
</div>
</div>
<p>If a zero-length vector is used as the condition in an <code>if()</code> statement, an error results:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the sum of a numeric or logical vector of length 0 is itself zero</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>( b <span class="sc">+</span> <span class="dv">12345</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (b <span class="sc">&lt;</span> <span class="dv">2</span>) <span class="fu">cat</span>(<span class="st">"yes</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="replacing-elements-of-a-vector" class="level3" data-number="4.4.5">
<h3 data-number="4.4.5" class="anchored" data-anchor-id="replacing-elements-of-a-vector"><span class="header-section-number">4.4.5</span> Replacing elements of a vector</h3>
<p>If we extract elements, we can use the extraction operation on the left side of an assigment for replacing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101 102 103 104 105</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">203</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101 102 203 104 105</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>a[a <span class="sc">&gt;</span> <span class="dv">104</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">999</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  101  102 -999  104 -999</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replacing using names</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(vec) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>vec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  a   b   c 
201 202 203 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>vec[<span class="st">"b"</span>] <span class="ot">&lt;-</span> <span class="dv">302</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>vec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  a   b   c 
201 302 203 </code></pre>
</div>
</div>
<p>It is possible too combine two vectors (if the vectors are different types, R convert them) and also assign elements of a vector out past its end.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>(a <span class="ot">&lt;-</span> <span class="dv">101</span><span class="sc">:</span><span class="dv">103</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101 102 103</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>(b <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">5</span><span class="sc">:-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -5 -4 -3 -2 -1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> b</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101 102 103  -5  -4  -3  -2  -1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># b[6] does not exists, will be filled with NA to add b[7]</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>b[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -5 -4 -3 -2 -1 NA  3</code></pre>
</div>
</div>
</section>
</section>
<section id="missing-data-na" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="missing-data-na"><span class="header-section-number">4.5</span> Missing Data NA</h2>
<p>When we try to extract an item that was never present in a vector appears missing values. NA values rule: any computation with an NA itself becomes an NA. With mathematical computations we can use <code>na.rm = TRUE</code> argument to compute the result after omitting missing values.</p>
<p>We can use <code>anyNA()</code> function to determine whether any of the values are missing (TRUE or FALSE). Also, <code>is.na()</code> fuction return TRUE or FALSE for every element in the vector. We can use <code>where(is.na(vector))</code>to find the numeric indices of the missing elements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a vector with missing values</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>nax <span class="ot">&lt;-</span> <span class="dv">101</span><span class="sc">:</span><span class="dv">106</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>nax[ <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>) ] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>nax</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101 102  NA 104  NA 106</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(nax)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE  TRUE FALSE  TRUE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">is.na</span>(nax) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Mean 'nax' vector: "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mean 'nax' vector: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(nax)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(nax, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 103.25</code></pre>
</div>
</div>
<p>We can remove missing values with <code>vec[!is.na(vec)]</code> which return non-missing entries, but <code>na.omit()</code> function deletes the missing values but also keeps track of where in the vector they used to be. This information is stored in vector’s ‘attributes’:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To return non-missing values:</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>nax[<span class="sc">!</span><span class="fu">is.na</span>(nax)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101 102 104 106</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Storing non missing values in a variable and keeping track of deleted ones</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>(nay <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(nax))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101 102 104 106
attr(,"na.action")
[1] 3 5
attr(,"class")
[1] "omit"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(nay, <span class="st">"na.action"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 5
attr(,"class")
[1] "omit"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(nay, <span class="st">"class"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<p>We can have a vector ‘b’ with data and a vector ‘a’ as index which contain NA values. If we use ‘a’ as filter, it returns every coincident value and missing value, this behaviour can be changed with <code>b[!is.na(a) &amp; a == 2]</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>(b <span class="ot">&lt;-</span> <span class="dv">101</span><span class="sc">:</span><span class="dv">104</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101 102 103 104</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>(a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  2 NA  4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>b[a <span class="sc">==</span> <span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 102  NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>b[<span class="sc">!</span><span class="fu">is.na</span>(a) <span class="sc">&amp;</span> a <span class="sc">==</span> <span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 102</code></pre>
</div>
</div>
<ul>
<li><code>NaN</code> : Special value, means “Not a Number”. It si the result of specific computations such as 0/0. NaN is considered a missing value.</li>
<li><code>Inf</code> : Appears when a positive number is accidentally divided by zero. Inf values are not missing.</li>
</ul>
<p>Inf + NA = NA<br>
NaN + NA = NaN</p>
<p>We generally wanto to identify any of these values: the function <code>is.finite()</code> produces TRUE for numbers that are neither NA nor NaN nor Inf. It serves as a check on valid values. The command <code>all(is.finite(vector) )</code> is to see a numeric vector elements which are not special values.</p>
<ul>
<li><code>NULL</code> : is an object with zero length, no contents, no class. It often arise trying to access an element which does not exist. The function <code>is.null()</code> is for testing NULL values. If you index using a NULL value the result will be a vector of length 0.</li>
</ul>
</section>
<section id="the-table-function" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="the-table-function"><span class="header-section-number">4.6</span> The <code>Table( )</code> function</h2>
<p><code>Table()</code> produce a table returning for each unique value the number of times that value appears.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">rep</span> ( <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="cn">NA</span>, <span class="st">"green"</span>), <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>) )</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>vec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "red"   "red"   "red"   "red"   "blue"  "blue"  NA      "green" "green"
[10] "green"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>vec
 blue green   red 
    2     3     4 </code></pre>
</div>
</div>
<p><code>table()</code> arguments:</p>
<ul>
<li><p><code>useNA =</code></p>
<ul>
<li><code>"no"</code> : default option. Exclude NA values.</li>
<li><code>"ifany"</code> : show an entry for NA if there are any.</li>
<li><code>"always"</code> : show an entry for NA whether there are any NA values or not.</li>
</ul></li>
<li><p><code>exclude =</code></p>
<ul>
<li><p><code>c(NA, NaN)</code> : default option.</p></li>
<li><p>We can add a value of the vector to exclude, also we can pass <code>NULL</code>.</p></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(vec, <span class="at">useNA =</span> <span class="st">"always"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>vec
 blue green   red  &lt;NA&gt; 
    2     3     4     1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(vec, <span class="at">exclude=</span><span class="st">"green"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>vec
blue  red &lt;NA&gt; 
   2    4    1 </code></pre>
</div>
</div>
<p>Also, we can pass to <code>table()</code> function two vectors to create a two-way table (cross-tabulation). in R a two-way table is treated the same as a matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>vec2 <span class="ot">&lt;-</span> <span class="fu">rep</span> ( <span class="fu">c</span>(<span class="st">"north"</span>, <span class="st">"south"</span>, <span class="st">"east"</span>, <span class="st">"west"</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>) )</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(vec,vec2, <span class="at">useNA=</span><span class="st">"ifany"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       vec2
vec     east north south west
  blue     1     0     1    0
  green    0     0     0    3
  red      0     2     2    0
  &lt;NA&gt;     1     0     0    0</code></pre>
</div>
</div>
<p>A three and higher-way tables are produced when you pass three or more equal-length vectors.</p>
<p>For very large vectors, the <code>data.table()</code> function in the <code>data.table</code> package may prove more efficient than <code>table()</code>.</p>
<p>The <code>xtabs()</code> function is useful for creating more complex tables.</p>
<section id="operating-on-tables" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="operating-on-tables"><span class="header-section-number">4.6.1</span> Operating on tables</h3>
<ul>
<li><code>prop.table()</code> : passing a variable with table assigned produces the proportions of the total counts in the table by cell (or row, or column). The second argument references 1 to rows, or 2 to columns.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">rep</span> (<span class="dv">2015</span><span class="sc">:</span><span class="dv">2017</span>, <span class="at">each=</span><span class="dv">5</span>)</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>market <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, </span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>)</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">64</span>, <span class="dv">87</span>, <span class="dv">71</span>, <span class="dv">79</span>, <span class="dv">79</span>, <span class="dv">91</span>, <span class="dv">86</span>, <span class="dv">92</span>, <span class="cn">NA</span>,</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>          <span class="dv">55</span>, <span class="dv">37</span>, <span class="dv">41</span>, <span class="dv">60</span>, <span class="dv">66</span>, <span class="dv">82</span>)</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="co"># assign a table with the vectors we want to 'tab'</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(market, year)</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      year
market 2015 2016 2017
     a    3    1    3
     b    2    4    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># proportions along rows</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      year
market       2015       2016       2017
     a 0.20000000 0.06666667 0.20000000
     b 0.13333333 0.26666667 0.13333333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># proportions throwout columns</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(tab, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      year
market 2015 2016 2017
     a  0.6  0.2  0.6
     b  0.4  0.8  0.4</code></pre>
</div>
</div>
<ul>
<li><p><code>margin.table()</code> : produce the marginals totals from a table.</p></li>
<li><p><code>addmargins()</code> : to a given table incorporates those totals producing a new row and column by default. Passing as second argument 1 or 2, you can specified if only wants rows or columns.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"margin.table function for columns:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>margin.table function for columns:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">margin.table</span>(tab, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>year
2015 2016 2017 
   5    5    5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">addmargins function in the table: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
addmargins function in the table: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      year
market 2015 2016 2017 Sum
   a      3    1    3   7
   b      2    4    2   8
   Sum    5    5    5  15</code></pre>
</div>
</div>
<ul>
<li><code>tapply()</code> : the arguments are, first the vector where perform the computation, second the vector with the index to group, and then the function to apply. To group with more than one vector (index) we can use a <code>list()</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"There are NA in cost? "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>There are NA in cost? </code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anyNA</span>(cost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span> (cost, year, min, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2015 2016 2017 
  64   55   37 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span> (cost, <span class="fu">list</span>(market, year), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      2015     2016     2017
a 76.66667 92.00000 59.66667
b 75.00000 77.33333 53.50000</code></pre>
</div>
</div>
<p>It is posible to use with tapply() custom fuctions, as an example, for (x) return the sum of the squares of each entry of x:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span> (cost, <span class="fu">list</span>(market, year),</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">function</span> (x) <span class="fu">sum</span> (x<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   2015  2016  2017
a 17906  8464 11693
b 11282 18702  6037</code></pre>
</div>
</div>
</section>
</section>
<section id="other-actions-on-vectors" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="other-actions-on-vectors"><span class="header-section-number">4.7</span> Other Actions on Vectors</h2>
<section id="rounding" class="level3" data-number="4.7.1">
<h3 data-number="4.7.1" class="anchored" data-anchor-id="rounding"><span class="header-section-number">4.7.1</span> Rounding</h3>
<ul>
<li><p><code>round()</code> : to round a number with specific amount of decimals. Passing a negative number as second argument will round the nearest power of 10.</p></li>
<li><p><code>signif()</code> : retain a specific number of digits.</p></li>
<li><p><code>trunc()</code> : discards the decimal part returning an integer.</p></li>
<li><p><code>floor()</code> ; <code>ceiling()</code> : round to the next lower or higher integer respectively.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>(dec <span class="ot">&lt;-</span> <span class="fl">123.4567</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 123.4567</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Round function to 3 decimals: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Round function to 3 decimals: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(dec, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 123.457</code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Round function (-1) to nearest power of 10: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Round function (-1) to nearest power of 10: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(dec, <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 120</code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Signif function to 4 numbers: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Signif function to 4 numbers: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">signif</span>(dec, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 123.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Trunc function: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Trunc function: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trunc</span>(dec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 123</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Floor function to round to the lower integer: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Floor function to round to the lower integer: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">floor</span>(dec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 123</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Round function to round to the higher integer: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Round function to round to the higher integer: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(dec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 124</code></pre>
</div>
</div>
</section>
<section id="sorting-and-ordering" class="level3" data-number="4.7.2">
<h3 data-number="4.7.2" class="anchored" data-anchor-id="sorting-and-ordering"><span class="header-section-number">4.7.2</span> Sorting and Ordering</h3>
<ul>
<li><p><code>sort()</code> : sorting from smallest to largest. It will drop NA and NaN values by default.</p>
<ul>
<li><code>decreasing=TRUE</code> will reverse the order.</li>
<li><code>na.last</code> will add NA values, TRUE at the end and FALSE at the beginning.</li>
</ul></li>
<li><p><code>order()</code> : returns the indices which can be used to sort a vector.</p>
<ul>
<li><code>na.last</code> as TRUE by default. TRUE at the end and FALSE at the beginning.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yoshua" "Mery"   "Alex"   "John"   "Lee"    "Cindy" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>(scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">123</span>, <span class="dv">456</span>, <span class="dv">789</span>, <span class="dv">456</span>, <span class="dv">654</span>, <span class="dv">987</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 123 456 789 456 654 987</code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sorting 'people' by their scores (descending): </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sorting 'people' by their scores (descending): </code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>people[<span class="fu">order</span>(scores, <span class="at">decreasing=</span><span class="cn">TRUE</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Cindy"  "Alex"   "Lee"    "Mery"   "John"   "Yoshua"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Ordering people by their scores, and in case </span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="st">    of a tie using their names alphabetically.: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Ordering people by their scores, and in case 
    of a tie using their names alphabetically.: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>people[<span class="fu">order</span>(scores, people[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yoshua" "John"   "Mery"   "Lee"    "Alex"   "Cindy" </code></pre>
</div>
</div>
</section>
<section id="vector-as-sets" class="level3" data-number="4.7.3">
<h3 data-number="4.7.3" class="anchored" data-anchor-id="vector-as-sets"><span class="header-section-number">4.7.3</span> Vector as Sets</h3>
<p>To find values that overlap between two vectors we can use <code>%in%</code> function. For example, we can use a command <code>a %in% b</code> which will return a vector the same length as ‘a’ with a logical indicator whether each element is found in ‘b’. Witch <code>table(a %in% b)</code> we get the number of element in ‘a’ that were not found in ‘b’.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Looking for which letter is in 'letters':</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"g"</span>, <span class="st">"5"</span>, <span class="st">"b"</span>, <span class="st">"J"</span>, <span class="st">"!"</span>) <span class="sc">%in%</span> letters</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE  TRUE FALSE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span> (<span class="fu">c</span>(<span class="st">"g"</span>, <span class="st">"5"</span>, <span class="st">"b"</span>, <span class="st">"J"</span>, <span class="st">"!"</span>) <span class="sc">%in%</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
    3     2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">c</span>(<span class="st">"g"</span>, <span class="st">"5"</span>, <span class="st">"b"</span>, <span class="st">"J"</span>, <span class="st">"!"</span>) <span class="sc">%in%</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 3</code></pre>
</div>
</div>
<ul>
<li><code>union()</code> : returns the elements in either passed vectors</li>
<li><code>intersect()</code> : returns the elements which are in both passed vectors</li>
<li><code>setdiff()</code> : returns the elements of ‘a’ not present in ‘b’</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Union 'a' and 'b':</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Union 'a' and 'b':</code></pre>
</div>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">union</span> (<span class="fu">c</span>(<span class="st">"g"</span>, <span class="st">"5"</span>, <span class="st">"b"</span>, <span class="st">"J"</span>, <span class="st">"!"</span>), letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "g" "5" "b" "J" "!" "a" "c" "d" "e" "f" "h" "i" "j" "k" "l" "m" "n" "o" "p"
[20] "q" "r" "s" "t" "u" "v" "w" "x" "y" "z"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Intersect 'a' with 'b':</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Intersect 'a' with 'b':</code></pre>
</div>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intersect</span> (<span class="fu">c</span>(<span class="st">"g"</span>, <span class="st">"5"</span>, <span class="st">"b"</span>, <span class="st">"J"</span>, <span class="st">"!"</span>), letters) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "g" "b"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Defferent elemenets of 'a' in 'b':</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Defferent elemenets of 'a' in 'b':</code></pre>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span> (<span class="fu">c</span>(<span class="st">"g"</span>, <span class="st">"5"</span>, <span class="st">"b"</span>, <span class="st">"J"</span>, <span class="st">"!"</span>), letters) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "5" "J" "!"</code></pre>
</div>
</div>
</section>
</section>
<section id="duplicates" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="duplicates"><span class="header-section-number">4.8</span> Duplicates</h2>
<ul>
<li><p><code>anyDuplicated()</code> : returns the duplicated values in a vector</p></li>
<li><p><code>unique()</code> : returns the distinct values, including NA and NaN.</p></li>
<li><p><code>duplicated(</code>) : returns a logical vector with TRUE per duplicated value (not the first value).</p>
<ul>
<li><code>fromLast=TRUE</code> reads from the end to the beginning. Using union() you can combine <code>fromLast=TRUE</code> and <code>fromLast=FALSE</code> to identify all duplicates.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>let <span class="ot">&lt;-</span> <span class="fu">c</span>(letters, <span class="fu">c</span>(<span class="st">"j"</span>, <span class="st">"j"</span>, <span class="st">"x"</span>))</span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Duplicates?</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Duplicates?</code></pre>
</div>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>let[<span class="fu">duplicated</span>(let)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "j" "j" "x"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>(tab <span class="ot">&lt;-</span> <span class="fu">table</span> (let))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>let
a b c d e f g h i j k l m n o p q r s t u v w x y z 
1 1 1 1 1 1 1 1 1 3 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>tab[<span class="fu">which</span> (tab <span class="sc">!=</span> <span class="dv">1</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>let
j x 
3 2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span> (tab)[tab <span class="sc">!=</span> <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "j" "x"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span> (<span class="fu">table</span> (let))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2  3 
24  1  1 </code></pre>
</div>
</div>
<p>Matching is identify where in a vector we can find the values in another vector. The function <code>match()</code> is a more powerful version of <code>%in%</code>.</p>
<ul>
<li><code>match()</code> : given two vectors returns where the element from ‘a’ is in ‘b’. By default returns NA for no matches, we can change this with <code>nomatch=0</code> argument.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>names1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jensen"</span>, <span class="st">"Chang"</span>, <span class="st">"Johnson"</span>, <span class="st">"Lopez"</span>, <span class="st">"McNamara"</span>, <span class="st">"Reese"</span>)</span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>names2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Lopez"</span>, <span class="st">"Ruth"</span>, <span class="st">"Nakagawa"</span>, <span class="st">"Jensen"</span>, <span class="st">"Mays"</span>)</span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="fu">match</span>(names1, names2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  4 NA NA  1 NA NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>names2[<span class="fu">match</span>(names1, names2, <span class="at">nomatch=</span><span class="dv">0</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Jensen" "Lopez" </code></pre>
</div>
</div>
<p>The ‘Run length enconding’ function is rle() which returns the number of repetitions and length.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rle</span>( <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Run Length Encoding
  lengths: int [1:5] 1 2 1 3 2
  values : chr [1:5] "a" "b" "a" "c" "a"</code></pre>
</div>
</div>
<p>The previous output show, with length 1 value ‘a’ followerd by ‘b’ with length 2, again ‘a’ length 1 and then ‘c’ with length 3, to finish with ‘a’ twice.</p>
</section>
<section id="summary" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="summary"><span class="header-section-number">4.9</span> Summary</h2>
<section id="conversions" class="level3" data-number="4.9.1">
<h3 data-number="4.9.1" class="anchored" data-anchor-id="conversions"><span class="header-section-number">4.9.1</span> Conversions</h3>
<ul>
<li>Converting character to numeric produces NA for things that aren’t numbers, like the character strings “TRUE” or “$199.99”.</li>
<li>Converting character to logical produces NA for any string that isn’t “TRUE”, “True”, “true”, “T”, “FALSE”, “False”, “false” or “F”.</li>
<li>Converting numeric to logical produces FALSE for a zero and TRUE for any non-zero entry (and watch out for floating-point error here).</li>
</ul>
</section>
<section id="subscripts" class="level3" data-number="4.9.2">
<h3 data-number="4.9.2" class="anchored" data-anchor-id="subscripts"><span class="header-section-number">4.9.2</span> Subscripts</h3>
<ul>
<li>A logical subscript returns the values that match up with its TRUE entries.</li>
<li>A numeric subscript returns the values specified in the subscript.</li>
<li>character subscript will extract, from a named vector, elements whose names are present in the subscript.</li>
</ul>
</section>
</section>
</section>
<section id="r-data-other-structures" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> R Data: Other Structures</h1>
<section id="matrices" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="matrices"><span class="header-section-number">5.1</span> Matrices</h2>
<p>Essentially is a vector two-dimensional like a rectangle. Every element of a matrix needs to be of the same type (numeric, logical or character).</p>
<p>A matrix is filled column by column.</p>
<p>Using <code>length()</code> we get the total number of elements in the matrix, and using <code>dim()</code> we get the dimension as number of rows and columns.</p>
<ul>
<li><p><code>cbind()</code> : combines a set of vectors into a matrix column by column.</p></li>
<li><p><code>rbind()</code> : combines a set of vectors into a matrix row by row.</p></li>
</ul>
<p>If the vectors to combine have unequal length, R will recycle.</p>
<p>With matrix in the same way as vectors we can do arithmetic operations, that will be element by element. Also, <code>t(A)</code> transposes a matrix, and <code>solve()</code> inverts a matrix.</p>
<p>To extract and assign new values to elements the process is similar to a vector but now we have to pass two coordinates:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">101</span><span class="sc">:</span><span class="dv">115</span>, <span class="at">nrow=</span><span class="dv">5</span>, <span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]  101  106  111
[2,]  102  107  112
[3,]  103  108  113
[4,]  104  109  114
[5,]  105  110  115</code></pre>
</div>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">1</span>,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 106</code></pre>
</div>
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>a[<span class="sc">-</span><span class="dv">2</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]  101  106  111
[2,]  103  108  113
[3,]  104  109  114
[4,]  105  110  115</code></pre>
</div>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Obtaining row 4 and 2, and cols 3 and 1, in that order: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Obtaining row 4 and 2, and cols 3 and 1, in that order: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>a[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]  114  104
[2,]  112  102</code></pre>
</div>
</div>
<p>To create a vector from a matrix we can use <code>c()</code>, it will use the first column, then the second and so on. To extract data row by row, we can use <code>t()</code> to transpose the matrix first like <code>c(t(a))</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115</code></pre>
</div>
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]  101  102  103  104  105
[2,]  106  107  108  109  110
[3,]  111  112  113  114  115</code></pre>
</div>
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">t</span>(a))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 101 106 111 102 107 112 103 108 113 104 109 114 105 110 115</code></pre>
</div>
</div>
<p>If we ask to a matrix for one column we’ll get a vector, because dimensions of length 1 are usually dropped by default. We can use drop=FALSE argument to prevent that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>a[,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 106 107 108 109 110</code></pre>
</div>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>a[,<span class="dv">2</span>, drop<span class="ot">=</span><span class="cn">FALSE</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]  106
[2,]  107
[3,]  108
[4,]  109
[5,]  110</code></pre>
</div>
</div>
<section id="row-and-column-names" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="row-and-column-names"><span class="header-section-number">5.1.1</span> Row and Column Names</h3>
<p>With <code>dimnames()</code> we get rows and columns names. <code>rownames()</code> and <code>colnames()</code> to get rows and columns names respectively. As well as with <code>names()</code> and vectors, we can asign names to columns and rows with these functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">rep</span> (<span class="dv">2015</span><span class="sc">:</span><span class="dv">2017</span>, <span class="at">each =</span> <span class="dv">5</span>)</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>market <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>(tbl <span class="ot">&lt;-</span> <span class="fu">table</span> (market, year))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      year
market 2015 2016 2017
     2    3    1    3
     3    2    4    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Collaing to colnames(): </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Collaing to colnames(): </code></pre>
</div>
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2015" "2016" "2017"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Assigning new names to columns: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Assigning new names to columns: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tbl) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Y15"</span>, <span class="st">"Y16"</span>, <span class="st">"Y17"</span>)</span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>tbl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      year
market Y15 Y16 Y17
     2   3   1   3
     3   2   4   2</code></pre>
</div>
</div>
<p>Just like before, we can call for the column name or row identifier to get them:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>tbl[,<span class="st">"Y15"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2 3 
3 2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a>tbl[<span class="st">"3"</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Y15 Y16 Y17 
  2   4   2 </code></pre>
</div>
</div>
</section>
<section id="applying-functions" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="applying-functions"><span class="header-section-number">5.1.2</span> Applying Functions</h3>
<p>Built in functions which works across columns or rows: <code>colSums(), rowSums(), colMeans(), rowMeans()</code>.</p>
<ul>
<li><p><code>apply()</code> : Useful to apply a custom function.</p>
<ul>
<li><p>first argument, the matrix to which apply the function.</p></li>
<li><p>The direction, 1 for across rows, 2 for down columns.</p></li>
<li><p>The function to be applied.</p></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]  101  106  111
[2,]  102  107  112
[3,]  103  108  113
[4,]  104  109  114
[5,]  105  110  115</code></pre>
</div>
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 318 321 324 327 330</code></pre>
</div>
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(a, <span class="dv">1</span>, sum, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 318 321 324 327 330</code></pre>
</div>
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(a, <span class="dv">1</span>, <span class="cf">function</span> (x) <span class="fu">sum</span> (x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 318 321 324 327 330</code></pre>
</div>
</div>
<p>We can guet a matrix result for the <code>apply()</code> function. If we compute across rows, sometimes will change the shape, we can use <code>t()</code> to prevent that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(a, <span class="dv">2</span>, range)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]  101  106  111
[2,]  105  110  115</code></pre>
</div>
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>( <span class="fu">apply</span>(a, <span class="dv">1</span>, range) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]  101  111
[2,]  102  112
[3,]  103  113
[4,]  104  114
[5,]  105  115</code></pre>
</div>
</div>
<p>When we are looking for specific values we can get vectors with different lengths, in that case R returns a list.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Getting elements location where the value is greater than 109:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Getting elements location where the value is greater than 109:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(a, <span class="dv">2</span>, <span class="cf">function</span> (x) <span class="fu">which</span> (x <span class="sc">&gt;</span> <span class="dv">109</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
integer(0)

[[2]]
[1] 5

[[3]]
[1] 1 2 3 4 5</code></pre>
</div>
</div>
</section>
<section id="missing-values" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="missing-values"><span class="header-section-number">5.1.3</span> Missing Values</h3>
<p>The function apply() is very useful to count the number of missing values. Next, let’s create a matrix using a semicolon to pass multiple commands in one line, also the multiple assigment operation to assign several things at once:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">101</span><span class="sc">:</span><span class="dv">115</span>, <span class="dv">5</span>, <span class="dv">3</span>); a[<span class="dv">5</span>, <span class="dv">3</span>] <span class="ot">&lt;-</span> a[<span class="dv">3</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]  101  106  111
[2,]  102  107  112
[3,]   NA  108  113
[4,]  104  109  114
[5,]  105  110   NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sum of NA in each column: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sum of NA in each column: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(a, <span class="dv">2</span>, <span class="cf">function</span> (x) <span class="fu">sum</span> (<span class="fu">is.na</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 0 1</code></pre>
</div>
</div>
<p>Tracking NA values with <code>which()</code> to identify the position on the vector will return a number of the position for each NA. However, using <code>arr.ind=TRUE</code> argument we’ll obtain the coordinates:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">is.na</span>(a))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">is.na</span>(a), <span class="at">arr.ind=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     row col
[1,]   3   1
[2,]   5   3</code></pre>
</div>
</div>
</section>
<section id="matrix-subscripts" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="matrix-subscripts"><span class="header-section-number">5.1.4</span> Matrix Subscripts</h3>
<p>With <code>which()</code> as a subscript we have the possibility to extract specific elements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">matrix</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">byrow=</span>T)</span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">cbind</span>(b, <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">5</span>))</span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(b) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"P1"</span>, <span class="st">"P2"</span>, <span class="st">"P3"</span>, <span class="st">"P4"</span>, <span class="st">"P5"</span>, <span class="st">"Use"</span>)</span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(b) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Spring"</span>, <span class="st">"Summer"</span>, <span class="st">"Fall"</span>, <span class="st">"Winter"</span>)</span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       P1 P2 P3 P4 P5 Use
Spring  1  2  3  4  5   3
Summer  6  7  8  9 10   2
Fall   11 12 13 14 15   0
Winter 16 17 18 19 20   5</code></pre>
</div>
</div>
<p>Given the previous matrix, the Use column specify which element of the row we want get. To generate this coordinates, we are going to generate a matrix, the first column will be the number of rows and the second column ‘Use’. Then we can pass that matrix as a subscript to ‘b’ and extract the elements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a>(filt <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(b), b[, <span class="st">"Use"</span>]) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1] [,2]
Spring    1    3
Summer    2    2
Fall      3    0
Winter    4    5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>b[filt]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3  7 20</code></pre>
</div>
</div>
</section>
<section id="higher-way-arrays" class="level3" data-number="5.1.5">
<h3 data-number="5.1.5" class="anchored" data-anchor-id="higher-way-arrays"><span class="header-section-number">5.1.5</span> Higher-way Arrays</h3>
<p>A matrix with three or more ways is called Array in R. We can encounter this while constructing a higher way <code>table()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>who <span class="ot">&lt;-</span> <span class="fu">rep</span>( <span class="fu">c</span>(<span class="st">"Mery"</span>, <span class="st">"Kelly"</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>))</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>when <span class="ot">&lt;-</span> <span class="fu">rep</span>( <span class="fu">c</span>(<span class="st">"AM"</span>, <span class="st">"PM"</span>), <span class="dv">4</span>)</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>worked <span class="ot">&lt;-</span> <span class="fu">c</span>(T, T, F, T, F, T, F, T)</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>sch <span class="ot">&lt;-</span> <span class="fu">table</span>(who, when, worked)</span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>sch</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , worked = FALSE

       when
who     AM PM
  Kelly  3  0
  Mery   0  0

, , worked = TRUE

       when
who     AM PM
  Kelly  0  3
  Mery   1  1</code></pre>
</div>
</div>
<p>The function <code>aperm()</code> is like <code>t()</code> but for higher-way arrays. Also we can use <code>c()</code> to produce a vector, and <code>apply()</code> or <code>prop.table()</code> works too.</p>
</section>
</section>
<section id="lists" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="lists"><span class="header-section-number">5.2</span> Lists</h2>
<p>A list can have vector or diferent types and sizes, also might include matrices, lists or other R objects. Usually a list is returned by a modeling function in R but we can create a list with <code>list()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a>ali <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">beta =</span> <span class="st">"yes"</span>, <span class="at">delta =</span> log, <span class="dv">69</span>)</span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>ali</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$alpha
[1] 1 2 3 4

$beta
[1] "yes"

$delta
function (x, base = exp(1))  .Primitive("log")

[[4]]
[1] 69</code></pre>
</div>
</div>
<ul>
<li><code>split()</code> : divides a vector into pieces according to the value of another vector. Returns a list. Missing values in the second vector passed will be dropped.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">33</span>, <span class="dv">42</span>, <span class="dv">54</span>, <span class="dv">65</span>, <span class="dv">74</span>, <span class="dv">24</span>)</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>)</span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Split age by gender:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Split age by gender:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">split</span>(age, gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$F
[1] 31 42 74 24

$M
[1] 33 54 65</code></pre>
</div>
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Split ages when age is greater than 60</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Split ages when age is greater than 60</code></pre>
</div>
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="fu">split</span>(age, age <span class="sc">&gt;</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`FALSE`
[1] 31 33 42 54 24

$`TRUE`
[1] 65 74</code></pre>
</div>
</div>
<p>We can see with <code>length()</code> function the number of elements inside a list, and with <code>lengths()</code> function the length of each element.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>( <span class="fu">split</span>(age, gender) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Lengths: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Lengths: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lengths</span>( <span class="fu">split</span>(age, gender) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>F M 
4 3 </code></pre>
</div>
</div>
<p>The <code>str()</code> command gives a description of every element on the list:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ali)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 4
 $ alpha: int [1:4] 1 2 3 4
 $ beta : chr "yes"
 $ delta:function (x, base = exp(1))  
 $      : num 69</code></pre>
</div>
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ali)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
</div>
<section id="excracting-from-list" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="excracting-from-list"><span class="header-section-number">5.2.1</span> Excracting from list</h3>
<p>Working with a list, the rule says <em>single backets produce a list, while double backets and dollar signs extract contents.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Extracting the content of element 4 as a vector: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Extracting the content of element 4 as a vector: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>ali[[<span class="dv">4</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 69</code></pre>
</div>
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Extracting the element 1 as a list: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Extracting the element 1 as a list: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a>ali[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$alpha
[1] 1 2 3 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Extracting inside alpha the elements 2 and 4: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Extracting inside alpha the elements 2 and 4: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>ali<span class="sc">$</span>alpha[<span class="fu">c</span>(F, T, F, T)] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 4</code></pre>
</div>
</div>
<p>The function <code>names()</code> also works with lists returning the names of each element and “” if the element no have name. We can assign names with it too.</p>
<p>When we extract an element from a list with dollar sign, we do not need to know the complete name, it is enough if it’s unambiguous:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>ali<span class="sc">$</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a>ali<span class="sc">$</span>de</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (x, base = exp(1))  .Primitive("log")</code></pre>
</div>
</div>
<p>To assign new values to an element we need the full name, otherwise will be creating a new ítem.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb390"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a>ali<span class="sc">$</span>delta <span class="ot">&lt;-</span> <span class="fu">c</span>(T, F, F, T)</span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ali)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 4
 $ alpha: int [1:4] 1 2 3 4
 $ beta : chr "yes"
 $ delta: logi [1:4] TRUE FALSE FALSE TRUE
 $      : num 69</code></pre>
</div>
</div>
<p>To remove an element from a list we can assign a NULL value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb392"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a>ali<span class="sc">$</span>beta <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ali)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 3
 $ alpha: int [1:4] 1 2 3 4
 $ delta: logi [1:4] TRUE FALSE FALSE TRUE
 $      : num 69</code></pre>
</div>
</div>
<ul>
<li><code>unlist()</code> : try to turn the list into a vector:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(ali)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>alpha1 alpha2 alpha3 alpha4 delta1 delta2 delta3 delta4        
     1      2      3      4      1      0      0      1     69 </code></pre>
</div>
</div>
<p>Using dimnames() function we can see the names from a matrix as list format and also we can asign names:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       P1 P2 P3 P4 P5 Use
Spring  1  2  3  4  5   3
Summer  6  7  8  9 10   2
Fall   11 12 13 14 15   0
Winter 16 17 18 19 20   5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "Spring" "Summer" "Fall"   "Winter"

[[2]]
[1] "P1"  "P2"  "P3"  "P4"  "P5"  "Use"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(b)[[<span class="dv">1</span>]][<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"Autumn"</span></span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       P1 P2 P3 P4 P5 Use
Spring  1  2  3  4  5   3
Summer  6  7  8  9 10   2
Autumn 11 12 13 14 15   0
Winter 16 17 18 19 20   5</code></pre>
</div>
</div>
<p>An important list returned from a function is the list from <code>options()</code> which contain elements describing things like number of digits to be displayed, scientific notation, the editor… With <code>names(options())</code> we can see the names of the current options.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">options</span>())[<span class="dv">3</span><span class="sc">:</span><span class="dv">15</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "callr.condition_handler_cli_message" "catch.script.errors"                
 [3] "CBoundsCheck"                        "check.bounds"                       
 [5] "citation.bibtex.max"                 "continue"                           
 [7] "contrasts"                           "defaultPackages"                    
 [9] "demo.ask"                            "deparse.cutoff"                     
[11] "device"                              "device.ask.default"                 
[13] "digits"                             </code></pre>
</div>
</div>
</section>
</section>
<section id="data-frames" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="data-frames"><span class="header-section-number">5.3</span> Data Frames</h2>
<p>A data.frame is a list of vector with the same length which can be arrayed in a matrix-like rectangle. Each vector in the list will be the columns. To construct a data frame we use <code>data.frame()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span> (</span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">Who =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cost =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">11</span>, <span class="dv">4</span>, <span class="dv">0</span>),</span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Paid =</span> <span class="fu">c</span>(F, T, F, T, T),</span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors=</span><span class="cn">FALSE</span></span>
<span id="cb406-6"><a href="#cb406-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb406-7"><a href="#cb406-7" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(df) <span class="ot">&lt;-</span> <span class="fu">as.character</span> (<span class="fu">row.names</span>(df))</span>
<span id="cb406-8"><a href="#cb406-8" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Who Cost  Paid
1   a    3 FALSE
2   b    2  TRUE
3   c   11 FALSE
4   d    4  TRUE
5   e    0  TRUE</code></pre>
</div>
</div>
<p>A data frame must have a column and row names, if they are not assigned R will create them. Also R ensure that column names are valid and not duplicated. For columns we can use <code>colnames()</code> or <code>dimnames()</code> to assign it, or <code>names()</code> with a list. For row names we have <code>row.names()</code> or <code>rownames()</code> functions.</p>
<p>By default the <code>data.frame()</code> function turns character vectors into factors but rarely we want it in data cleaning. We can chage this with <code>stringAsFactors=FALSE</code> argument.</p>
<ul>
<li><p><code>head()</code> : return the first six rows of a given dataframe. Second argument is n=6 to specify a number of rows. A negative number returns the last n rows.</p></li>
<li><p><code>tail()</code> : return the last six rows of a given dataframe. Second argument is n=6 to specify a number of rows.</p></li>
<li><p><code>str()</code> : compact representation of the data frame with data type per column.</p></li>
<li><p><code>dim()</code> : returns the dimension, number of rows and columns.</p></li>
<li><p><code>summary()</code> : returns a brief description of each column.</p></li>
</ul>
<section id="missing-values-1" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="missing-values-1"><span class="header-section-number">5.3.1</span> Missing Values</h3>
<p>Because a data frame can have differnt classes (data types) in its colums, the missing values can be of different classes too. A numeric vector will have numeric NA which is different to logical NA from a logical vector.</p>
<ul>
<li><p><code>is.na()</code> : returns a logical matrix showing which elements are missing.</p></li>
<li><p><code>anyNA()</code> : returns TRUE or FALSE to the question There are missing values?</p></li>
<li><p><code>na.omit()</code> : omit the observations (rows) of the data frame in which one or more elements is missing. Also keeps a track, we can see the deleted observations with <code>attr(df, "na.action") ; attr(df, "class")</code>.</p></li>
</ul>
<p>Extract and Assignment</p>
<p>With data frames we can use both matrix and list styles of subsetting operations. In data frames when we select a row returns a data frame because can store different types of data. Selecting a column will produce a vector.</p>
<p>Using a doble bracket or a dollar sign will produce a vector. Using the name produce a data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">4</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Who Cost Paid
4   d    4 TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> df<span class="sc">$</span>Paid</span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a>df[f,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Who Cost Paid
2   b    2 TRUE
4   d    4 TRUE
5   e    0 TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a>df[(df[<span class="st">"Paid"</span>] <span class="sc">==</span> F),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Who Cost  Paid
1   a    3 FALSE
3   c   11 FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"Cost"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Cost
1    3
2    2
3   11
4    4
5    0</code></pre>
</div>
</div>
<p>To extract a vector from a dataframe’s column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb416"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a>df[[<span class="dv">2</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3  2 11  4  0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb418"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">"Cost"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3  2 11  4  0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb421"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb422"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">"Co"</span>, exact<span class="ot">=</span><span class="cn">FALSE</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3  2 11  4  0</code></pre>
</div>
</div>
<p>Passing <code>drop=FALSE</code> argument we avoid to extract a vector:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb424"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a>df[, <span class="fu">c</span>(<span class="st">"Who"</span>, <span class="st">"Paid"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Who  Paid
1   a FALSE
2   b  TRUE
3   c FALSE
4   d  TRUE
5   e  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb426"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a>df[, <span class="st">"Who"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a" "b" "c" "d" "e"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb428"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a>df[, <span class="st">"Who"</span>, drop<span class="ot">=</span><span class="cn">FALSE</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Who
1   a
2   b
3   c
4   d
5   e</code></pre>
</div>
</div>
<p>To delete a column we can asign NULL to that column: <code>df$Paid &lt;- NULL</code></p>
<p>In a data frame or list if we pass a subscript for unexistance row wil produce one row with NA values. Sometimes happens when we delete a row and a program or ourselfs try to access to that row by name.</p>
</section>
</section>
<section id="operating-on-lists-and-data-frames" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="operating-on-lists-and-data-frames"><span class="header-section-number">5.4</span> Operating on Lists and Data Frames</h2>
<p>If we try to use <code>apply()</code> in a data frame, the function will convert it to a matrix, and the whole matrix is of the same data type. Also, we cannot use <code>apply()</code> to a list because does not have dimensions.</p>
<ul>
<li><code>lapply()</code> : returns a list</li>
<li><code>sapply()</code> : runs <code>lapply()</code> and tries to make the output into a vector or a matrix. But if the return have different lengths, it will need to return a list. If it try to return items with diferent types, will convert these to a common type, then its better in these case use <code>lapply()</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span> (df, class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Who        Cost        Paid 
"character"   "numeric"   "logical" </code></pre>
</div>
</div>
<section id="spliy-apply-combine" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="spliy-apply-combine"><span class="header-section-number">5.4.1</span> Spliy, Apply, Combine</h3>
<p>First the data is split, then a function is applied to each piece, and the results recombined. The function <code>tapply()</code> do exactly that, but also we can use <code>split()</code> and <code>sapply()</code> or <code>lapply()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb432"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span> (</span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age =</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">24</span>, <span class="dv">42</span>, <span class="dv">63</span>, <span class="dv">56</span>, <span class="dv">66</span>),</span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Spouse =</span> <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">36</span>, <span class="dv">40</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">60</span>),</span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gender =</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>)</span>
<span id="cb432-5"><a href="#cb432-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb432-6"><a href="#cb432-6" aria-hidden="true" tabindex="-1"></a><span class="fu">split</span> (df2<span class="sc">$</span>Age, df2<span class="sc">$</span>Gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$F
[1] 35 24 63

$M
[1] 42 56 66</code></pre>
</div>
<div class="sourceCode cell-code" id="cb434"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Using sapply() to obtain the mean by gender :</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Using sapply() to obtain the mean by gender :</code></pre>
</div>
<div class="sourceCode cell-code" id="cb436"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span> (<span class="fu">split</span> (df2<span class="sc">$</span>Age, df2<span class="sc">$</span>Gender), mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       F        M 
40.66667 54.66667 </code></pre>
</div>
</div>
<p>Above, <code>split()</code> divides Gender with Age values, then <code>sapply()</code> use <code>mean()</code> function to each part and returns a vector with the results (is the recombine). Let’s see <code>tapply()</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb438"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>( <span class="fu">tapply</span>(df2<span class="sc">$</span>Age, df2<span class="sc">$</span>Gender, mean), <span class="dv">3</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     F      M 
40.667 54.667 </code></pre>
</div>
</div>
<p>We can use <code>split()</code> on a data frame unlike <code>tapply()</code>, doing that the data frame will be divided and then we can use <code>sapply()</code> or <code>lapply()</code> to each part.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb440"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="fu">split</span> (df2, df2<span class="sc">$</span>Gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$F
  Age Spouse Gender
1  35     31      F
2  24     36      F
4  63     59      F

$M
  Age Spouse Gender
3  42     40      M
5  56     60      M
6  66     60      M</code></pre>
</div>
<div class="sourceCode cell-code" id="cb442"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Summary differencing Gender: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Summary differencing Gender: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb444"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span> ( <span class="fu">split</span> (df2, df2<span class="sc">$</span>Gender), summary )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$F
      Age            Spouse        Gender         
 Min.   :24.00   Min.   :31.0   Length:3          
 1st Qu.:29.50   1st Qu.:33.5   Class :character  
 Median :35.00   Median :36.0   Mode  :character  
 Mean   :40.67   Mean   :42.0                     
 3rd Qu.:49.00   3rd Qu.:47.5                     
 Max.   :63.00   Max.   :59.0                     

$M
      Age            Spouse         Gender         
 Min.   :42.00   Min.   :40.00   Length:3          
 1st Qu.:49.00   1st Qu.:50.00   Class :character  
 Median :56.00   Median :60.00   Mode  :character  
 Mean   :54.67   Mean   :53.33                     
 3rd Qu.:61.00   3rd Qu.:60.00                     
 Max.   :66.00   Max.   :60.00                     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb446"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Let's see what happens with sapply: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Let's see what happens with sapply: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb448"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span> ( <span class="fu">split</span> (df2, df2<span class="sc">$</span>Gender), summary )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      F                    M                   
 [1,] "Min.   :24.00  "    "Min.   :42.00  "   
 [2,] "1st Qu.:29.50  "    "1st Qu.:49.00  "   
 [3,] "Median :35.00  "    "Median :56.00  "   
 [4,] "Mean   :40.67  "    "Mean   :54.67  "   
 [5,] "3rd Qu.:49.00  "    "3rd Qu.:61.00  "   
 [6,] "Max.   :63.00  "    "Max.   :66.00  "   
 [7,] "Min.   :31.0  "     "Min.   :40.00  "   
 [8,] "1st Qu.:33.5  "     "1st Qu.:50.00  "   
 [9,] "Median :36.0  "     "Median :60.00  "   
[10,] "Mean   :42.0  "     "Mean   :53.33  "   
[11,] "3rd Qu.:47.5  "     "3rd Qu.:60.00  "   
[12,] "Max.   :59.0  "     "Max.   :60.00  "   
[13,] "Length:3          " "Length:3          "
[14,] "Class :character  " "Class :character  "
[15,] "Mode  :character  " "Mode  :character  "
[16,] NA                   NA                  
[17,] NA                   NA                  
[18,] NA                   NA                  </code></pre>
</div>
</div>
<p>The previous <code>sapply()</code> will try to construct a vector or matrix converting everything to a common type.</p>
<p>A function to produce the same result is <code>by()</code> but without letting you save the list. It will performs the <code>summary()</code> operation on each column, broken down by gender:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb450"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span> ( df2, df2<span class="sc">$</span>Gender, summary )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>df2$Gender: F
      Age            Spouse        Gender         
 Min.   :24.00   Min.   :31.0   Length:3          
 1st Qu.:29.50   1st Qu.:33.5   Class :character  
 Median :35.00   Median :36.0   Mode  :character  
 Mean   :40.67   Mean   :42.0                     
 3rd Qu.:49.00   3rd Qu.:47.5                     
 Max.   :63.00   Max.   :59.0                     
------------------------------------------------------------ 
df2$Gender: M
      Age            Spouse         Gender         
 Min.   :42.00   Min.   :40.00   Length:3          
 1st Qu.:49.00   1st Qu.:50.00   Class :character  
 Median :56.00   Median :60.00   Mode  :character  
 Mean   :54.67   Mean   :53.33                     
 3rd Qu.:61.00   3rd Qu.:60.00                     
 Max.   :66.00   Max.   :60.00                     </code></pre>
</div>
</div>
<p>Sometimes the task split, apply and combine can be performed altogether, but but other times might require separate functions. Packages like <code>dplyr</code> for data frames or <code>plyr</code> for lists and arrays. Both are intended to be fast and efficient and to permit parallel computation.</p>
</section>
<section id="all-numeric-data-frames" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="all-numeric-data-frames"><span class="header-section-number">5.4.2</span> All-Numeric Data Frames</h3>
<p>A data frame with all of its values are logical or numeric when is converted to a matrix the numeric type is preserved.</p>
<p>To convert vectors to another class exists as.numeric() and the other as. functions, also there are as.matrix() and as.data.frame() to convert data frames to matrices and vice versa. It is useful for all-numeric data frames and older functions that require numeric matrices.</p>
</section>
<section id="convenience-functions" class="level3" data-number="5.4.3">
<h3 data-number="5.4.3" class="anchored" data-anchor-id="convenience-functions"><span class="header-section-number">5.4.3</span> Convenience Functions</h3>
<p>It is recommended to users to use long names for data objects and columns for increases readability. But sometimes leads to use long line expression like:</p>
<p><code>CustPayment2016$JanDebt + CustPayment2016$FebPurch - CustPayment2016$FebPmt</code></p>
<p>These can be handled with the functions:</p>
<ul>
<li><p><code>with()</code> : to perform operations on a data frame. First argument is the data frame, then the expression to be performed. Cannot be assigned to.<br>
<code>with ( CustPayment2016, JanDebt `FebPurch - FebPmt )</code></p></li>
<li><p><code>within()</code> : works in the same wey but unlike <code>with()</code>, this function can be assigned.<br>
<code>CustPayment2016 &lt;- within ( CustPayment2016, FebDebt &lt;- JanDebt + FebPurch - FebPmt )</code></p></li>
</ul>
<p>For beginners and to use then interactively and not for programming there are functions to make the subsetting and transformation process easier ( but generally its avoided):</p>
<ul>
<li><p><code>subset()</code> : To extract rows given a condition:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb452"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span> ( df, Paid <span class="sc">==</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Who Cost Paid
2   b    2 TRUE
4   d    4 TRUE
5   e    0 TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Is the alternative to:</span></span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a>df[ df<span class="sc">$</span>Paid <span class="sc">==</span> <span class="cn">TRUE</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Who Cost Paid
2   b    2 TRUE
4   d    4 TRUE
5   e    0 TRUE</code></pre>
</div>
</div></li>
<li><p><code>transform()</code> : To specify transformations to existing columns and returns the updated version.</p></li>
</ul>
<p>To change the way we write functions we can use a ‘pipe’ as <code>%&gt;%</code> provided by <code>magrittr</code> package. The pipe allows a function’s output to serve as input to another function. Not every function is suitable for piping, the pipes are particularly useful for nested functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Nested: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Nested: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cos</span> (<span class="fu">log</span> (<span class="fu">sqrt</span> (<span class="dv">8</span> <span class="sc">-</span> <span class="dv">3</span>) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6933138</code></pre>
</div>
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"magrittr"</span>)</span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Using pipes: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Using pipes: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb462"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">8</span> <span class="sc">-</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> sqrt <span class="sc">%&gt;%</span> log <span class="sc">%&gt;%</span> cos </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6933138</code></pre>
</div>
</div>
</section>
<section id="re-ordering-de-duplicating-sampling" class="level3" data-number="5.4.4">
<h3 data-number="5.4.4" class="anchored" data-anchor-id="re-ordering-de-duplicating-sampling"><span class="header-section-number">5.4.4</span> Re-Ordering, De-Duplicating, Sampling</h3>
<p>We can create a vector with <code>order()</code> which contain indices sorted by the variables inside.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb464-2"><a href="#cb464-2" aria-hidden="true" tabindex="-1"></a>new.order <span class="ot">&lt;-</span> <span class="fu">order</span>( df<span class="sc">$</span>ID, df<span class="sc">$</span>Date )</span>
<span id="cb464-3"><a href="#cb464-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convenient alternative:</span></span>
<span id="cb464-4"><a href="#cb464-4" aria-hidden="true" tabindex="-1"></a>new.order <span class="ot">&lt;-</span> <span class="fu">with</span> ( df, <span class="fu">order</span> (ID, Date) )</span>
<span id="cb464-5"><a href="#cb464-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-6"><a href="#cb464-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 'new.order' have a vector with the rows sort by increasing ID</span></span>
<span id="cb464-7"><a href="#cb464-7" aria-hidden="true" tabindex="-1"></a><span class="co"># To have the data frame with the new order:</span></span>
<span id="cb464-8"><a href="#cb464-8" aria-hidden="true" tabindex="-1"></a>df[new.order, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For duplicated values, we can use unique() passing the data frame to get every non-duplicated row. Just the floating-point error might be a problem detecting identical rows.</p>
<ul>
<li><p>sample() : first argument is the number of total rows, the second argument is the size of the sample we want. By default the result is a random set of integers without replacement. The row number of sampled data frame will be the same that originals.</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample of 200 rows:</span></span>
<span id="cb465-2"><a href="#cb465-2" aria-hidden="true" tabindex="-1"></a><span class="co"># First, create a vector selecting the rows</span></span>
<span id="cb465-3"><a href="#cb465-3" aria-hidden="true" tabindex="-1"></a>s200 <span class="ot">&lt;-</span> <span class="fu">sample</span> ( <span class="fu">nrow</span>(df), <span class="dv">200</span> ) </span>
<span id="cb465-4"><a href="#cb465-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-5"><a href="#cb465-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the sample vector to do the sampling:</span></span>
<span id="cb465-6"><a href="#cb465-6" aria-hidden="true" tabindex="-1"></a>df[s200, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
</section>
<section id="date-and-time-objects" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="date-and-time-objects"><span class="header-section-number">5.5</span> Date and Time Objects</h2>
<section id="formatting-dates" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="formatting-dates"><span class="header-section-number">5.5.1</span> Formatting Dates</h3>
<p>The class Date internally store an integer representing the number of days since a particular origin date.</p>
<p>Dates can be represented in many shapes, american’s form, rest-of-the-world form, etc. the <code>as.Date()</code> function converts text into Date class.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb466"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First '0' will be converted into origin date.</span></span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">as.Date</span> ( <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">18252</span><span class="sc">:</span><span class="dv">18255</span>), <span class="at">origin =</span> <span class="st">"1970-01-01"</span> )</span>
<span id="cb466-3"><a href="#cb466-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb466-4"><a href="#cb466-4" aria-hidden="true" tabindex="-1"></a>dd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1970-01-01" "2019-12-22" "2019-12-23" "2019-12-24" "2019-12-25"</code></pre>
</div>
</div>
<p>Also can convert text based representations in Date class such as “7/4/2019”. In this case we have to pass <code>format=</code> argument, and the format string had to contain the same pattern that the input text:</p>
<ul>
<li><code>%b ; %B</code> : name of the month</li>
<li><code>%a ; %A</code> : name of the day of the week</li>
<li><code>%d</code> : day of the month</li>
<li><code>%m</code> : month in number</li>
<li><code>%y ; %Y</code> : for the yy or YYYY year.</li>
<li><code>%F</code> : Equivalent to %Y-%m-%d.</li>
<li><code>%x</code> : Date. Locale-specific on output,&nbsp;<code>"%y/%m/%d"</code>&nbsp;on input.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb468"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span> ( <span class="fu">c</span>(<span class="st">"Feb 29, 2016"</span>, <span class="st">"Feb 29, 2017"</span>, <span class="st">"September 30, 2017"</span>), </span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">format =</span> <span class="st">"%b %d, %Y"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2016-02-29" NA           "2017-09-30"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb470"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The second date will result NA because is not valid</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The names of the days of the week and the months of the year are in computer’s locale, to read other languages we can change locales R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb471"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a>sp.dt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"3 octubre 2016"</span>, <span class="st">"26 Marzo 2017"</span>)</span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb471-3"><a href="#cb471-3" aria-hidden="true" tabindex="-1"></a>( dts <span class="ot">&lt;-</span> <span class="fu">as.Date</span> (sp.dt, <span class="at">format =</span> <span class="st">"%d %B %Y"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb473"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing locales to spanish:</span></span>
<span id="cb473-2"><a href="#cb473-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setlocale</span> (<span class="st">"LC_TIME"</span>, <span class="st">"Spanish"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Spanish_Spain.1252"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb475"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a>( dts <span class="ot">&lt;-</span> <span class="fu">as.Date</span> (sp.dt, <span class="at">format =</span> <span class="st">"%d %B %Y"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2016-10-03" "2017-03-26"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb477"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing back:</span></span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setlocale</span> (<span class="st">"LC_TIME"</span>, <span class="st">"UK"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "English_United Kingdom.1252"</code></pre>
</div>
</div>
</section>
<section id="operations-on-date-objects" class="level3" data-number="5.5.2">
<h3 data-number="5.5.2" class="anchored" data-anchor-id="operations-on-date-objects"><span class="header-section-number">5.5.2</span> Operations on Date Objects</h3>
<p>The functions <code>months()</code> and <code>weekdays()</code> returns the month name and weekday from passing Date object. It can be added the <code>abbreviate=TRUE</code> argument to abbreviate the output.</p>
<p>To extract the numeric month, day or year it can be used the <code>format()</code> function and then using <code>as.numeric()</code> to convert the character output to numeric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb479"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a>dt1 <span class="ot">&lt;-</span> <span class="fu">as.Date</span> (<span class="st">"2024/05/17"</span>)</span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true" tabindex="-1"></a>dt2 <span class="ot">&lt;-</span> <span class="fu">as.Date</span> (<span class="st">"2024-07-03"</span>)</span>
<span id="cb479-3"><a href="#cb479-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-4"><a href="#cb479-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting weekdays:</span></span>
<span id="cb479-5"><a href="#cb479-5" aria-hidden="true" tabindex="-1"></a><span class="fu">weekdays</span>( <span class="fu">c</span>(dt1, dt2) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Friday"    "Wednesday"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb481"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb482"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting month name:</span></span>
<span id="cb482-2"><a href="#cb482-2" aria-hidden="true" tabindex="-1"></a><span class="fu">months</span>( <span class="fu">c</span>(dt1, dt2), <span class="at">abbreviate =</span> T )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "May" "Jul"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb484"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb485"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifying Quarters:</span></span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quarters</span>( <span class="fu">c</span>(dt1, dt2) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Q2" "Q3"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb487"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb488"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span> ( <span class="fu">c</span>(dt1, dt2), <span class="st">"%y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "24" "24"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb490"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span> ( <span class="fu">c</span>(dt1, dt2), <span class="st">"%d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "17" "03"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb492"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span> ( <span class="fu">c</span>(dt1, dt2), <span class="st">"%A, %B %d, %Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Friday, May 17, 2024"     "Wednesday, July 03, 2024"</code></pre>
</div>
</div>
<p>The difference between dates is a period of time stored as <code>difftime</code> object. Functions such as <code>mean()</code> and <code>range()</code> works well but <code>hist()</code> or <code>summary()</code> fails producing the expected results.</p>
<p>Usually we will convert <code>difftime</code> objects to numeric with <code>as.numeric()</code> function, for that will be a good habit to specify <code>units = "days"</code> argument (with the unit we want.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb494"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Date1 adding 30 days: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Date1 adding 30 days: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb496"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true" tabindex="-1"></a>dt1 <span class="sc">+</span> <span class="dv">30</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2024-06-16"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb498"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Difference between date1 and date2: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Difference between date1 and date2: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb500"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a>(dd <span class="ot">&lt;-</span> dt2 <span class="sc">-</span> dt1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 47 days</code></pre>
</div>
<div class="sourceCode cell-code" id="cb502"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb502-1"><a href="#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Difference to numeric: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Difference to numeric: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb504"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span> (dd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 47</code></pre>
</div>
<div class="sourceCode cell-code" id="cb506"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="fu">units</span>(dd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "days"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb508"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">To numeric but in weeks: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
To numeric but in weeks: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb510"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span> (dd, <span class="at">units=</span><span class="st">"weeks"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.714286</code></pre>
</div>
</div>
</section>
<section id="posixt-objects" class="level3" data-number="5.5.3">
<h3 data-number="5.5.3" class="anchored" data-anchor-id="posixt-objects"><span class="header-section-number">5.5.3</span> <code>POSIXt</code> Objects</h3>
<p><code>POSIXlt</code> object is implemented as a list, meanwhile <code>POSIXct</code> object is like a number useful is will be stored in a column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb512"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a>(ready <span class="ot">&lt;-</span> <span class="fu">as.POSIXlt</span>(<span class="st">"2017-01-17 14:51:23"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-01-17 14:51:23 CET"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb514"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb515"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span> (ready)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   sec    min   hour   mday    mon   year   wday   yday  isdst   zone gmtoff 
  "23"   "51"   "14"   "17"    "0"  "117"    "2"   "16"    "0"  "CET"     NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb517"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb518"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true" tabindex="-1"></a>( mdayn <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span> (ready)[<span class="st">"mday"</span>]) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17</code></pre>
</div>
</div>
<p>In this last example we can see January is month 0 then December is month 11. Weekday is 0 to 6 starting on Sunday.</p>
<p>Here it can be used too the <code>weekdays()</code>, <code>months()</code> and <code>quarters()</code> functions, as well as <code>format()</code> function. This will be less efficient than the list-type extraction, and it is recommended use <code>POSIXct</code> objects where possible because changing time zones with <code>POSIXlt</code> can encounter unexpected behavior.</p>
<p>When we convert a <code>Date</code> object to <code>POSIXt</code> the time will be 00:00 (midnight), and when it converted from <code>POSIXt</code> to Date, the time will be truncated.</p>
<p>as.POSIXct() and as.POSIXlt() works like as.Date() but the date can be followed by 24-hour clock time (or 12h with AM/PM).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb520"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a>( ct1 <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span> (<span class="st">"Mar 30, 2017 12:26:08 am"</span>, </span>
<span id="cb520-2"><a href="#cb520-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">format =</span> <span class="st">"%b %d, %Y %I:%M:%S %p"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-03-30 00:26:08 CEST"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb522"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb523"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a>(ct2 <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span> (<span class="st">"2017-03-29 22:26:08"</span>, <span class="at">tz =</span> <span class="st">"UTC"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-03-29 22:26:08 UTC"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb525"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb525-1"><a href="#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Looking for diferences: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Looking for diferences: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb527"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb527-1"><a href="#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span> (ct1 <span class="sc">-</span> ct2, <span class="at">units =</span> <span class="st">"secs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>All the objects in a vector of length &gt;1 including <code>weekdays()</code> and <code>months()</code> will be displayed with the local time zone. For a single object these functions refer to the time zone of the object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb529"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb529-1"><a href="#cb529-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(ct1, ct2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-03-30 00:26:08 CEST" "2017-03-30 00:26:08 CEST"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb531"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb531-1"><a href="#cb531-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb532"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="fu">weekdays</span>(<span class="fu">c</span>(ct1, ct2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Thursday" "Thursday"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb534"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb535"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb535-1"><a href="#cb535-1" aria-hidden="true" tabindex="-1"></a><span class="fu">weekdays</span>(ct2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Wednesday"</code></pre>
</div>
</div>
<p>The time zone can be converted changing <code>tzone</code> attribute:<br>
<code>attr ( ct1, tzone = "UTC" )</code></p>
<p>The help of <code>Sys.timezone()</code> containing the names of the time zones. When a POSIXct object is converted to Date object is rendered in UTC time zone by default:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb537"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb537-1"><a href="#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(ct2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-03-29"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb539"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(ct1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-03-29"</code></pre>
</div>
</div>
<p>Example of <code>POSIXct</code> formatting flexibility:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb541"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb541-1"><a href="#cb541-1" aria-hidden="true" tabindex="-1"></a>(crdt <span class="ot">&lt;-</span> <span class="fu">date</span>() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mon Sep 23 12:10:00 2024"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb543"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb543-1"><a href="#cb543-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb544"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a>(now <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span> (crdt, <span class="at">format =</span> <span class="st">"%A %B %d %H:%M:%S %Y"</span> ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2024-09-23 12:10:00 CEST"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb546"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb547"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb547-1"><a href="#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span> (now)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2024-09-23"</code></pre>
</div>
</div>
<p>Math Functions</p>
<p>Date and <code>POSIXt</code> objects are numeric, then we can use some functions such as <code>range(), max(), min(), mean(), median()</code>, which will produce vectors of date objects.</p>
<p><code>diff()</code> : computes differences between adjacent elements in a vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb549"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb549-1"><a href="#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span> ( <span class="fu">range</span>( <span class="fu">c</span>(ct1, ct2) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 0 secs</code></pre>
</div>
</div>
<p>The function <code>table()</code> works too but does not work on <code>POSIXlt</code> (list) objects.</p>
<p>We can also create sequences with <code>seq()</code> function, it can be specified <code>by="day"</code> argument:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb551"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb551-1"><a href="#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span> ( <span class="fu">as.Date</span>(<span class="st">"2020-03-11"</span>), <span class="at">by =</span> <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">5</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020-03-11" "2020-03-14" "2020-03-17" "2020-03-20" "2020-03-23"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb553"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb553-1"><a href="#cb553-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb554"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb554-1"><a href="#cb554-1" aria-hidden="true" tabindex="-1"></a>pdt <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>( (<span class="st">"2020-03-11 13:05:00"</span>) )</span>
<span id="cb554-2"><a href="#cb554-2" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span> ( pdt, <span class="at">by =</span> <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020-03-11 13:05:00 CET" "2020-03-11 13:05:02 CET"
[3] "2020-03-11 13:05:04 CET"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb556"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb556-1"><a href="#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sequence by days:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sequence by days:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb558"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb558-1"><a href="#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span> (pdt, <span class="at">by =</span> <span class="st">"day"</span>, <span class="at">length =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020-03-11 13:05:00 CET" "2020-03-12 13:05:00 CET"
[3] "2020-03-13 13:05:00 CET"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb560"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb560-1"><a href="#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">By day without altering the hour: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
By day without altering the hour: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb562"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb562-1"><a href="#cb562-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span> (pdt, <span class="at">by =</span> <span class="st">"DSTday"</span>, <span class="at">length =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020-03-11 13:05:00 CET" "2020-03-12 13:05:00 CET"
[3] "2020-03-13 13:05:00 CET"</code></pre>
</div>
</div>
<p>With <code>POSIXt</code> object using <code>by="day"</code> the clock moves 24 hours, but <code>by="DSTday"</code> moves 1 day preserving the clock.</p>
<p>We have to be more careful with <code>POSIXt</code> and <code>difftime</code> objects:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb564"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span> (<span class="st">"2017-05-01 12:00:00"</span>)</span>
<span id="cb564-2"><a href="#cb564-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span> (<span class="st">"2017-05-01 12:00:06"</span>)</span>
<span id="cb564-3"><a href="#cb564-3" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span> (<span class="st">"2017-05-07 12:00:00"</span>)</span>
<span id="cb564-4"><a href="#cb564-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Are equal (d2 - d1) and (d3 - d1) ? :</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Are equal (d2 - d1) and (d3 - d1) ? :</code></pre>
</div>
<div class="sourceCode cell-code" id="cb566"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb566-1"><a href="#cb566-1" aria-hidden="true" tabindex="-1"></a>(d2 <span class="sc">-</span> d1) <span class="sc">==</span> (d3 <span class="sc">-</span> d1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb568"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb568-1"><a href="#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Same operation but using as.numeric() : </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Same operation but using as.numeric() : </code></pre>
</div>
<div class="sourceCode cell-code" id="cb570"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb570-1"><a href="#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(d2 <span class="sc">-</span> d1) <span class="sc">==</span> <span class="fu">as.numeric</span>(d3 <span class="sc">-</span> d1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb572"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb572-1"><a href="#cb572-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Same as.numeric but with units=days:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Same as.numeric but with units=days:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb574"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb574-1"><a href="#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(d2 <span class="sc">-</span> d1, <span class="at">units=</span><span class="st">"days"</span>) <span class="sc">==</span> <span class="fu">as.numeric</span>(d3 <span class="sc">-</span> d1, <span class="at">units=</span><span class="st">"days"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</section>
<section id="missing-values-2" class="level3" data-number="5.5.4">
<h3 data-number="5.5.4" class="anchored" data-anchor-id="missing-values-2"><span class="header-section-number">5.5.4</span> Missing Values</h3>
<p>In a vector dates of different classes should not be combined, a good practice is to use a function to force all the elements to have the same class.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb576"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb576-1"><a href="#cb576-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(d1, <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-05-01 12:00:00 CEST" NA                        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb578"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb578-1"><a href="#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb579"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb579-1"><a href="#cb579-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="cn">NA</span>, d1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]         NA 1493632800</code></pre>
</div>
<div class="sourceCode cell-code" id="cb581"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb581-1"><a href="#cb581-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb582"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb582-1"><a href="#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>( <span class="fu">as.Date</span>(<span class="cn">NA</span>), d1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA           "2017-05-01"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb584"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb584-1"><a href="#cb584-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb585"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb585-1"><a href="#cb585-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>( <span class="fu">as.POSIXct</span>(<span class="cn">NA</span>), d1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA                         "2017-05-01 12:00:00 CEST"</code></pre>
</div>
</div>
<p>The first <code>c(d1, NA)</code> knows what to do with the <code>NA</code> value because <code>d1</code> is first, but the second one do not, then convert the vector into numeric. That not happens in the third and fourth command when we specify which class is the <code>NA</code> value.</p>
</section>
<section id="apply-on-dates" class="level3" data-number="5.5.5">
<h3 data-number="5.5.5" class="anchored" data-anchor-id="apply-on-dates"><span class="header-section-number">5.5.5</span> <code>Apply()</code> on Dates</h3>
<p>Often a data set will have a series of dates in each row, like with a data frame is better to use <code>lapply()</code> and <code>sapply()</code> functions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb587"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb587-1"><a href="#cb587-1" aria-hidden="true" tabindex="-1"></a>dt.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb587-2"><a href="#cb587-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">Start =</span> <span class="fu">c</span>( <span class="fu">seq</span> (<span class="fu">as.Date</span>(<span class="st">"2020-05-03"</span>), <span class="at">by=</span><span class="st">"months"</span>, <span class="at">length =</span> <span class="dv">6</span>) )</span>
<span id="cb587-3"><a href="#cb587-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb587-4"><a href="#cb587-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb587-5"><a href="#cb587-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a new column</span></span>
<span id="cb587-6"><a href="#cb587-6" aria-hidden="true" tabindex="-1"></a>dt.df<span class="sc">$</span>End <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fu">seq</span> (<span class="fu">as.Date</span>(<span class="st">"2021-06-02"</span>), <span class="at">by=</span><span class="st">"months"</span>, <span class="at">length =</span> <span class="dv">6</span>) )</span>
<span id="cb587-7"><a href="#cb587-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb587-8"><a href="#cb587-8" aria-hidden="true" tabindex="-1"></a>dt.df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Start        End
1 2020-05-03 2021-06-02
2 2020-06-03 2021-07-02
3 2020-07-03 2021-08-02
4 2020-08-03 2021-09-02
5 2020-09-03 2021-10-02
6 2020-10-03 2021-11-02</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb589"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb589-1"><a href="#cb589-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span> ( <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dt.df), </span>
<span id="cb589-2"><a href="#cb589-2" aria-hidden="true" tabindex="-1"></a>         <span class="cf">function</span> (i) <span class="fu">as.numeric</span> (dt.df[i,<span class="dv">2</span>] <span class="sc">-</span> dt.df[i,<span class="dv">1</span>], </span>
<span id="cb589-3"><a href="#cb589-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">units =</span> <span class="st">"days"</span>) ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 395 394 395 395 394 395</code></pre>
</div>
</div>
</section>
</section>
<section id="actions-with-data-frames" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="actions-with-data-frames"><span class="header-section-number">5.6</span> Actions with Data Frames</h2>
<section id="combining-by-rows-or-columns" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="combining-by-rows-or-columns"><span class="header-section-number">5.6.1</span> Combining by Rows or Columns</h3>
<p>The function <code>data.frame()</code> can be used with two data frames inside and will be joined. Also <code>cbind()</code> function is useful. Both can incorporate vectors and matrices as well. Remember that characters will be converted into Factors unless <code>stringAsFactors=FALSE</code>.</p>
<p>It is a good idea to check duplicated column names before combining, with <code>intersection()</code> function for example. If there are duplicated names R will use <code>make.names()</code> to generate unique alternatives (adding .1 .2 .3 …).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb591"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb591-1"><a href="#cb591-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Who"  "Cost" "Paid"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb593"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb593-1"><a href="#cb593-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Age"    "Spouse" "Gender"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb595"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb595-1"><a href="#cb595-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forcing 'intersect' to get a column names coincidence</span></span>
<span id="cb595-2"><a href="#cb595-2" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>Paid <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>)</span>
<span id="cb595-3"><a href="#cb595-3" aria-hidden="true" tabindex="-1"></a><span class="fu">intersect</span>( <span class="fu">names</span>(df), <span class="fu">names</span>(df2) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Paid"</code></pre>
</div>
</div>
<p>With <code>rbind()</code> we can combine data frames vertically (by rows). The columns in both data frames have to be the same, number and name, but not the order. Also the columns it’s recommended to have the same class or R will convert to the common class. Pass <code>stringAsFactor=FALSE</code> with <code>rbind()</code> to ensure the character columns.</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb597-1"><a href="#cb597-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking column names on two data frames:</span></span>
<span id="cb597-2"><a href="#cb597-2" aria-hidden="true" tabindex="-1"></a>nam1 <span class="ot">&lt;-</span> <span class="fu">names</span> (df1)</span>
<span id="cb597-3"><a href="#cb597-3" aria-hidden="true" tabindex="-1"></a>nam2 <span class="ot">&lt;-</span> <span class="fu">names</span> (df2)</span>
<span id="cb597-4"><a href="#cb597-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb597-5"><a href="#cb597-5" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span> (<span class="fu">sort</span> (nam1) <span class="sc">==</span> <span class="fu">sort</span> (nam2) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Above we sort the names of each data frame with a comparation expecting TRUE as result.</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb598-1"><a href="#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking column classes</span></span>
<span id="cb598-2"><a href="#cb598-2" aria-hidden="true" tabindex="-1"></a>cs1 <span class="ot">&lt;-</span> <span class="fu">sapply</span> (df1, class)</span>
<span id="cb598-3"><a href="#cb598-3" aria-hidden="true" tabindex="-1"></a>cs2 <span class="ot">&lt;-</span> <span class="fu">sapply</span> (df2, class)</span>
<span id="cb598-4"><a href="#cb598-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb598-5"><a href="#cb598-5" aria-hidden="true" tabindex="-1"></a><span class="fu">isTRUE</span> (<span class="fu">all.equal</span> (cs1, cs2[<span class="fu">names</span> (cs1) ] ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>And now we compare both classes.</p>
<ul>
<li><code>all.equal()</code> : compares two objects and returns TRUE if the match. Also returns a report if there are differences.</li>
<li><code>isTRUE()</code> : returns TRUE if its argument is a single TRUE (expected for <code>all.equal()</code> ) or FALSE if there are something else.</li>
</ul>
<p>When the rows have basic numeric names R will adjust the resulting rows. But with modified row names R will try to keep them and taking care of the matches.</p>
<p>If we have a large number of data frames, for example in a list as the result of <code>lapply()</code> function, we can use <code>do.call()</code> to combine them. The function takes the name of a function to be run and a list of arguments and run the function with those arguments:</p>
<div class="sourceCode" id="cb599"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb599-1"><a href="#cb599-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Result of lapply() function:</span></span>
<span id="cb599-2"><a href="#cb599-2" aria-hidden="true" tabindex="-1"></a>list.of.df</span>
<span id="cb599-3"><a href="#cb599-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb599-4"><a href="#cb599-4" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span> ( <span class="st">"rbind"</span>, list.of.df )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In the command above we are assuming that data frames meet the <code>rbind()</code> criteria. Other basic example can be: <code>do.call("log", list(x = 32, base = 2)</code> where the list are the argument of <code>log().</code></p>
</section>
<section id="merging-data-frames" class="level3" data-number="5.6.2">
<h3 data-number="5.6.2" class="anchored" data-anchor-id="merging-data-frames"><span class="header-section-number">5.6.2</span> Merging Data Frames</h3>
<p>To <code>merge()</code> usually the data frames to merge have a “key” field. Then <code>merge()</code> matches up the key and produces a data frame with one row per key with the columns of both data frames.</p>
<ul>
<li><p><code>merge()</code> arguments:</p>
<ul>
<li><code>(all.x=FALSE, all.y=FALSE)</code> : default options. One row for each key that appears in bot x and y data frames (except when there are duplicated keys). Is an <code>'inner join'</code>.</li>
<li><code>(all.x=TRUE, all.y=FALSE)</code> : One row for each key in x and columns of the corresponding keys that do not appear in y are filled with NA values. Is an <code>'left join'</code>.</li>
<li><code>(all.x=FALSE, all.y=TRUE)</code> : Is the complementary one, an ‘<code>right join</code>’.</li>
<li><code>(all.x=TRUE, all.y=TRUE)</code> : This id the ‘<code>outer join</code>’, when the result has one row for every key in either x or y.</li>
</ul></li>
</ul>
<p>When the keys are duplicated the function <code>merge()</code> does not care, it will do it. It is best to remove rows with duplicated keys or to create a new column with a unique key, before merging.</p>
<p>If the key match approximately (people names) the functions <code>adist()</code> and <code>agrep()</code> help find keys that match approximately.</p>
</section>
<section id="comparing-data-frames" class="level3" data-number="5.6.3">
<h3 data-number="5.6.3" class="anchored" data-anchor-id="comparing-data-frames"><span class="header-section-number">5.6.3</span> Comparing Data Frames</h3>
<ul>
<li><p><code>identical()</code> : test for every strict equivalence. Returns <code>TRUE</code> when the two items are equal. Should not be applied to <code>POSIXlt</code> or data frames with this object.</p></li>
<li><p><code>all.equal()</code> : compares two objects but with more room for difference. Returns <code>TRUE</code> when two items are equal. By default is a match between names and attributes of two data frames. Correct way to compare: <code>isTRUE(all.equal(df1, df2))</code></p>
<ul>
<li><code>tolerance=</code> how different two numbers need to be to be declarated different.</li>
</ul></li>
</ul>
</section>
<section id="view-and-editing-data-frames" class="level3" data-number="5.6.4">
<h3 data-number="5.6.4" class="anchored" data-anchor-id="view-and-editing-data-frames"><span class="header-section-number">5.6.4</span> View and Editing Data Frames</h3>
<ul>
<li><code>View()</code> : shows a dear-only representation of a data frame.</li>
<li><code>edit()</code> : allows change to be made. Can be saved to reflect the changes</li>
<li><code>data.entry()</code> : the changes are saved automatically.</li>
</ul>
<p>Is strongly recommended to use commented scripts and functions because in that way all the steps in the process will be reproducible.</p>
</section>
</section>
<section id="handling-big-data" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="handling-big-data"><span class="header-section-number">5.7</span> Handling Big Data</h2>
<p>R store the data in main memory on the machine being used.</p>
<p>Bash include tools to provide the ability to break the data into manageable pieces:</p>
<ul>
<li><code>split</code> : breaks up a data set by rows.</li>
<li><code>cut</code> : extracts specific columns.</li>
<li><code>shuf</code> : which permits the lines in a file, which helps when taking random samples.</li>
</ul>
<p>The <code>data.table</code> package advertises very fast subsetting and tabulation.</p>
<p>There are add-in packages to maintain “pointers” to data on disk, it is slower than memory but the storage can be expected to be huge:</p>
<ul>
<li><code>bigmemory</code></li>
<li><code>ff</code></li>
<li><code>tm</code></li>
</ul>
</section>
<section id="data-handling-tools" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="data-handling-tools"><span class="header-section-number">5.8</span> Data Handling Tools</h2>
<p>To account for columns with a vector of two or more classes we can extract the classes into a variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb600"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb600-1"><a href="#cb600-1" aria-hidden="true" tabindex="-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Age Spouse Gender Paid
1  35     31      F   NA
2  24     36      F   NA
3  42     40      M   NA
4  63     59      F   NA
5  56     60      M   NA
6  66     60      M   NA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb602"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb602-1"><a href="#cb602-1" aria-hidden="true" tabindex="-1"></a>( col.cls <span class="ot">&lt;-</span> <span class="fu">sapply</span>(df2, <span class="cf">function</span> (x) <span class="fu">class</span> (x)[<span class="dv">1</span>] ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Age      Spouse      Gender        Paid 
  "numeric"   "numeric" "character"   "logical" </code></pre>
</div>
</div>
<ul>
<li><p>table() to tabulate the columns classes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb604"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb604-1"><a href="#cb604-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(col.cls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>col.cls
character   logical   numeric 
        1         1         2 </code></pre>
</div>
</div></li>
<li><p>To count missing values by column, or count negative or a number equal to 99 like other ‘missing’ values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb606"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb606-1"><a href="#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>( df2, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Age Spouse Gender   Paid 
     0      0      0      6 </code></pre>
</div>
</div>
<ul>
<li>If there are a large number of columns we can pass <code>sapply()</code> results to <code>table(</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb608"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb608-1"><a href="#cb608-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>( df2, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x) ) ) <span class="sc">|&gt;</span> <span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
0 6 
3 1 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb610"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb610-1"><a href="#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>( df2, <span class="cf">function</span>(x) <span class="fu">sum</span> (x <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Age Spouse Gender   Paid 
     0      0      0      0 </code></pre>
</div>
</div></li>
<li><p>To compute the ranges of numeric columns in a search of outliers or anomalies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb612"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb612-1"><a href="#cb612-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span> (df2[, col.cls <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"numeric"</span>, <span class="st">"integer"</span>) ], range, <span class="at">na.rm=</span><span class="cn">TRUE</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Age Spouse
[1,]  24     31
[2,]  66     60</code></pre>
</div>
</div></li>
<li><p>To count unique values by column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb614"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb614-1"><a href="#cb614-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(df2, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">na.omit</span>(x) ) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Age Spouse Gender   Paid 
     6      5      2      0 </code></pre>
</div>
</div></li>
</ul>
<p>The <code>apply()</code> function converts the data frame to a matrix first, should be used if all the columns of a data frame are of the same type. The <code>sapply()</code> function tries to return a vector or a matrix if it can, so if the return elements are of different classes they will often be converted. It is better to use <code>lapply()</code> unless we know that one of the other functions will succeed.</p>
</section>
</section>
<section id="r-data-text-and-factors" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> R Data: Text and Factors</h1>
<p>Two ways to store test data, the vector of character strings and as a factor which is text entries as integers with character labels that match those integers.</p>
<section id="character-data" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="character-data"><span class="header-section-number">6.1</span> Character Data</h2>
<section id="length-and-nchar" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="length-and-nchar"><span class="header-section-number">6.1.1</span> <code>length()</code> and <code>nchar()</code></h3>
<p>On a vector using <code>length()</code> we extract how many elements are in it, and using <code>nchar()</code> we extract how many letters there are in each element. The argument <code>keepNA=FALSE</code> allow <code>nchar()</code> to count <code>NA</code> values returning 2 of length.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb616"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb616-1"><a href="#cb616-1" aria-hidden="true" tabindex="-1"></a>writers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"asimov"</span>, <span class="st">"tolstoi"</span>, <span class="st">"wolf"</span>, <span class="st">"sanderson"</span>, <span class="st">"joyce"</span>)</span>
<span id="cb616-2"><a href="#cb616-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(writers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb618"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb618-1"><a href="#cb618-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nchar</span>(writers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6 7 4 9 5</code></pre>
</div>
</div>
</section>
<section id="escaped-characters" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="escaped-characters"><span class="header-section-number">6.1.2</span> Escaped characters</h3>
<p>In character strings some characters are protected, we have to use backslash <code>( \ )</code> to use them.</p>
<p>We have to escape the double quotation marks and the backslash:</p>
<p><em>She wrote, “To enter a ‘new-line,’ type”\n” .”</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb620"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb620-1"><a href="#cb620-1" aria-hidden="true" tabindex="-1"></a>( quo <span class="ot">&lt;-</span> <span class="st">"She wrote, </span><span class="sc">\"</span><span class="st">To enter a 'new-line,' type </span><span class="sc">\"\\</span><span class="st">n</span><span class="sc">\"</span><span class="st"> .</span><span class="sc">\"</span><span class="st">"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "She wrote, \"To enter a 'new-line,' type \"\\n\" .\""</code></pre>
</div>
<div class="sourceCode cell-code" id="cb622"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb622-1"><a href="#cb622-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nchar</span> (quo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 47</code></pre>
</div>
<div class="sourceCode cell-code" id="cb624"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb624-1"><a href="#cb624-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(quo, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>She wrote, "To enter a 'new-line,' type "\n" ." </code></pre>
</div>
</div>
<p>Empty String</p>
<p>A vector length 0 corresponds to <code>character(0)</code>. An empty string is a vector in which an element have spaces or not, indicated by <code>""</code>. It will be length 1 and nchar 0. Spreadsheets will sometimes produce this empty strings or strings of spaces:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb626"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb626-1"><a href="#cb626-1" aria-hidden="true" tabindex="-1"></a>blanks <span class="ot">&lt;-</span> <span class="fu">c</span> (<span class="st">" "</span>, <span class="st">" "</span>, <span class="st">""</span>, <span class="st">"   "</span>, <span class="st">""</span>, <span class="st">"2016"</span>, <span class="st">""</span>, <span class="st">" 2016"</span>, <span class="st">"2016"</span>, <span class="st">"   "</span>)</span>
<span id="cb626-2"><a href="#cb626-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(blanks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb628"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb628-1"><a href="#cb628-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(blanks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>blanks
                   2016  2016 
    3     2     2     1     2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb630"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb630-1"><a href="#cb630-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">table</span>(blanks))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] ""      " "     "   "   " 2016" "2016" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb632"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb632-1"><a href="#cb632-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nzchar</span>(blanks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  TRUE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb634"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb634-1"><a href="#cb634-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing white spaces located in the start or end of a element:</span></span>
<span id="cb634-2"><a href="#cb634-2" aria-hidden="true" tabindex="-1"></a>noblanks <span class="ot">&lt;-</span> <span class="fu">trimws</span>(blanks)</span>
<span id="cb634-3"><a href="#cb634-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(noblanks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>noblanks
     2016 
   7    3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb636"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb636-1"><a href="#cb636-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">table</span>(noblanks))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] ""     "2016"</code></pre>
</div>
</div>
<p>The function <code>nzchar()</code> returns TRUE for strings that have non-zero length and FALSE for empty strings. And with <code>trimws()</code> we can remove blanks at the beginning and end of each element.</p>
</section>
<section id="substrings" class="level3" data-number="6.1.3">
<h3 data-number="6.1.3" class="anchored" data-anchor-id="substrings"><span class="header-section-number">6.1.3</span> Substrings</h3>
<p>Frequently in data cleaning we have to extract a piece of string, like a year or Zip code. For this task the <code>substring()</code> function takes a piece of text:</p>
<ul>
<li><p><code>substring()</code> : given a vector extract the selected text.</p>
<ul>
<li><p><code>first=</code> position of the first character to extract</p></li>
<li><p><code>last=</code> position of the last character up to 1 Million. Can be omitted to get the end of the string.</p></li>
</ul></li>
</ul>
<p>Also, <code>substring()</code> can be on the left side of an assignment, then we can add some text to each element of a vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb638"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb638-1"><a href="#cb638-1" aria-hidden="true" tabindex="-1"></a>dt1 <span class="ot">&lt;-</span> <span class="st">"2017-02-03"</span></span>
<span id="cb638-2"><a href="#cb638-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting the year</span></span>
<span id="cb638-3"><a href="#cb638-3" aria-hidden="true" tabindex="-1"></a><span class="fu">substring</span>(dt1, <span class="dv">1</span>, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb640"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb640-1"><a href="#cb640-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting day and month (last five characters)</span></span>
<span id="cb640-2"><a href="#cb640-2" aria-hidden="true" tabindex="-1"></a><span class="fu">substring</span> (dt1, <span class="fu">nchar</span>(dt1) <span class="sc">-</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "02-03"</code></pre>
</div>
</div>
<p>To break a string into its individual characters we can do it with <code>strsplit()</code> and also with <code>substring()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb642"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb642-1"><a href="#cb642-1" aria-hidden="true" tabindex="-1"></a><span class="fu">substring</span>(dt1, <span class="dv">1</span><span class="sc">:</span><span class="fu">nchar</span>(dt1), <span class="dv">1</span><span class="sc">:</span><span class="fu">nchar</span>(dt1) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "2" "0" "1" "7" "-" "0" "2" "-" "0" "3"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb644"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb644-1"><a href="#cb644-1" aria-hidden="true" tabindex="-1"></a><span class="fu">strsplit</span>(dt1, <span class="at">split =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
 [1] "2" "0" "1" "7" "-" "0" "2" "-" "0" "3"</code></pre>
</div>
</div>
<p>To change the last letters of a character element with <code>substring()</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb646"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb646-1"><a href="#cb646-1" aria-hidden="true" tabindex="-1"></a>holid <span class="ot">&lt;-</span> month.name</span>
<span id="cb646-2"><a href="#cb646-2" aria-hidden="true" tabindex="-1"></a><span class="fu">substring</span> (holid[<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>], <span class="fu">nchar</span>(holid[<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>]) <span class="sc">-</span> <span class="dv">0</span> ) <span class="ot">&lt;-</span> <span class="st">"9"</span></span>
<span id="cb646-3"><a href="#cb646-3" aria-hidden="true" tabindex="-1"></a>holid[<span class="dv">5</span><span class="sc">:</span><span class="dv">9</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "May"       "Jun9"      "Jul9"      "Augus9"    "September"</code></pre>
</div>
</div>
</section>
<section id="case-and-substitutions" class="level3" data-number="6.1.4">
<h3 data-number="6.1.4" class="anchored" data-anchor-id="case-and-substitutions"><span class="header-section-number">6.1.4</span> Case and Substitutions</h3>
<p>We will need sometimes to manipulate the case of characters because R is case-sensitive.</p>
<p><code>tolower(), toupper(), casefold()</code> functions perfrom these convertions. Using <code>casefold()</code> have to be passed the argument <code>upper=</code> being <code>TRUE</code> or <code>FALSE</code> which change to upper or lower case respectively.</p>
<p>The function <code>chartr()</code> is a general solution for substitutions. It takes two arguments that are vectors of characters and changes each character in the first argument into the corresponding character in the second argument.</p>
<p>To capitalize the every first letter of a character string, from <code>help("casefold")</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb648"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb648-1"><a href="#cb648-1" aria-hidden="true" tabindex="-1"></a>.simpleCap <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb648-2"><a href="#cb648-2" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(x, <span class="st">" "</span>)[[<span class="dv">1</span>]]</span>
<span id="cb648-3"><a href="#cb648-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">toupper</span>(<span class="fu">substring</span>(s, <span class="dv">1</span>, <span class="dv">1</span>)), <span class="fu">substring</span>(s, <span class="dv">2</span>),</span>
<span id="cb648-4"><a href="#cb648-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">sep =</span> <span class="st">""</span>, <span class="at">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb648-5"><a href="#cb648-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb648-6"><a href="#cb648-6" aria-hidden="true" tabindex="-1"></a><span class="fu">.simpleCap</span>(<span class="st">"the quick red fox jumps over the lazy brown dog"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The Quick Red Fox Jumps Over The Lazy Brown Dog"</code></pre>
</div>
</div>
</section>
</section>
<section id="converting-numbers-into-text" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="converting-numbers-into-text"><span class="header-section-number">6.2</span> Converting numbers into text</h2>
<section id="formatting-numbers" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="formatting-numbers"><span class="header-section-number">6.2.1</span> Formatting Numbers</h3>
<ul>
<li><p><code>format()</code> : is a way to format a set of numbers in a common way. E.g. lining up decimal points and commas.</p>
<ul>
<li><p><code>digits=</code> number of digits</p></li>
<li><p><code>nsmall=</code> number of digits (minimum) in the ‘small’ part (the right of the decimal point).</p></li>
<li><p><code>big.mark=</code> determine the comma in the ‘big’ part (the thousand mark).</p></li>
<li><p><code>drop0trailing</code> , removes trailing zeros in the small part.</p></li>
<li><p><code>zero.print=</code> , if TRUE, causes zeros to be printed with spaces.</p></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb650"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb650-1"><a href="#cb650-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span> ( <span class="fu">c</span>(<span class="fl">12.23</span>, <span class="fl">1234.45678</span>, <span class="dv">0</span>, <span class="fl">10.000</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "  12.230" "1234.457" "   0.000" "  10.000"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb652"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb652-1"><a href="#cb652-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span> ( <span class="fu">c</span>(<span class="fl">12.23</span>, <span class="fl">1234.45678</span>, <span class="dv">0</span>, <span class="fl">10.000</span>), <span class="at">big.mark=</span><span class="st">","</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "   12.230" "1,234.457" "    0.000" "   10.000"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb654"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb654-1"><a href="#cb654-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span> ( <span class="fu">c</span>(<span class="fl">12.23</span>, <span class="fl">1234.45678</span>, <span class="dv">0</span>, <span class="fl">10.000</span>),</span>
<span id="cb654-2"><a href="#cb654-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">digits =</span> <span class="dv">6</span>, <span class="at">nsmall =</span> <span class="dv">2</span>, <span class="at">zero.print =</span> <span class="cn">FALSE</span>, <span class="at">width =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "  12.23" "1234.46" "       " "  10.00"</code></pre>
</div>
</div>
<p>Decimal part by default will be aligned. The last example shows a currency type format, which the <code>digits</code> and <code>nsmall</code> arguments have to be chosen carefully to produce two decimals.</p>
<p>With <code>sprintf()</code> we can include text and add leading zeros. The function have a format string containing text and conversion strings, which describe how numbers and other variables should appear in that output. A conversion strings start with a percent sign and contain modifiers and then a conversion character.</p>
<p>The conversion character <code>%i</code> or <code>%d</code> are for integer values, <code>%f</code> is for double-precision numerics, and <code>%s</code> is for character strings. This field can be formatted with two numbers separated by a period, the first one give the minimum width (total number of characters) and the second one is the number of digits to the right of the decimal points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb656"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb656-1"><a href="#cb656-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8 characters, 2 decimals.</span></span>
<span id="cb656-2"><a href="#cb656-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> ( <span class="st">"%9.2f"</span>, <span class="fl">1230.456789</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "  1230.46"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb658"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb658-1"><a href="#cb658-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 leading the character to fill with 0 until 8 characters.</span></span>
<span id="cb658-2"><a href="#cb658-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> ( <span class="st">"%09.2f"</span>, <span class="fl">1230.456789</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "001230.46"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb660"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb660-1"><a href="#cb660-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Like the previous one but with spaces</span></span>
<span id="cb660-2"><a href="#cb660-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> ( <span class="st">"% 9.2f"</span>, <span class="fl">1230.456789</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "  1230.46"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb662"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb662-1"><a href="#cb662-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Always a simbol leading the number</span></span>
<span id="cb662-2"><a href="#cb662-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> ( <span class="st">"%+9.2f"</span>, <span class="fl">1230.456789</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] " +1230.46"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb664"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb664-1"><a href="#cb664-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Left Justified</span></span>
<span id="cb664-2"><a href="#cb664-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> ( <span class="st">"%-9.2f"</span>, <span class="fl">1230.456789</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1230.46  "</code></pre>
</div>
<div class="sourceCode cell-code" id="cb666"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb666-1"><a href="#cb666-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exponential</span></span>
<span id="cb666-2"><a href="#cb666-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> ( <span class="st">"%9.3g"</span>, <span class="fl">1230.456789</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] " 1.23e+03"</code></pre>
</div>
</div>
<p>Also we can use <code>sprintf()</code> with more than one vectors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb668"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb668-1"><a href="#cb668-1" aria-hidden="true" tabindex="-1"></a>costs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">22</span>, <span class="fl">456.32</span>, <span class="fl">89340.4235</span>, <span class="fl">1230045605.959</span>)</span>
<span id="cb668-2"><a href="#cb668-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> ( <span class="st">"I spent $%.0f in %s"</span>, costs, month.name[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "I spent $3 in February"      "I spent $22 in March"       
[3] "I spent $456 in April"       "I spent $89340 in May"      
[5] "I spent $1230045606 in June"</code></pre>
</div>
</div>
<p>In the conversion, the field width or precision can be passed as an argument if we specify an asterisk in the format:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb670"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb670-1"><a href="#cb670-1" aria-hidden="true" tabindex="-1"></a>bigs <span class="ot">&lt;-</span> <span class="fu">max</span> (<span class="fu">nchar</span> (<span class="fu">sprintf</span> (<span class="st">"%.2f"</span>, costs) ) )</span>
<span id="cb670-2"><a href="#cb670-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb670-3"><a href="#cb670-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> (<span class="st">"spent $%*.2f in %s"</span>,</span>
<span id="cb670-4"><a href="#cb670-4" aria-hidden="true" tabindex="-1"></a>         bigs, costs, month.name[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "spent $         3.00 in February" "spent $        22.00 in March"   
[3] "spent $       456.32 in April"    "spent $     89340.42 in May"     
[5] "spent $1230045605.96 in June"    </code></pre>
</div>
</div>
<p>The function <code>sprintf()</code> can be very useful to generate labels:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb672"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb672-1"><a href="#cb672-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span> (<span class="st">"%03d"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "001" "002" "003" "004" "005" "006" "007" "008" "009" "010" "011" "012"
[13] "013" "014" "015"</code></pre>
</div>
</div>
</section>
<section id="scientific-notation" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="scientific-notation"><span class="header-section-number">6.2.2</span> Scientific Notation</h3>
<p>When you represent a number by an optional sign, a number between 1 and 10 and a multiplier of a power of 10.</p>
<p>In R we can use <code>options()</code> to change scipen option. If <code>scipen=999</code> the scientific notion will be disabled, and <code>scipen=-999</code> will force scientific notion. When you close and open R <code>scipen</code> is re-set to default values. It is a better option to use <code>format(x, scientific=FALSE)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb674"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb674-1"><a href="#cb674-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1e+05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb676"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb676-1"><a href="#cb676-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">100000</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1e+00 1e+05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb678"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb678-1"><a href="#cb678-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">100000</span>, <span class="dv">123456</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]      1 100000 123456</code></pre>
</div>
<div class="sourceCode cell-code" id="cb680"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb680-1"><a href="#cb680-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.integer</span> (<span class="dv">1000000</span> <span class="sc">+</span> <span class="dv">1</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1000001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb682"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb682-1"><a href="#cb682-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span> ( <span class="dv">1000000</span>, <span class="at">scientific=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1000000"</code></pre>
</div>
</div>
</section>
<section id="discretizing-a-numeric-variable" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="discretizing-a-numeric-variable"><span class="header-section-number">6.2.3</span> Discretizing a Numeric Variable</h3>
<p>Discretizing is to construct a categorical version of a numeric vector with a few levels for exploration or modeling purposes, it is also called ‘binning’.</p>
<ul>
<li><p><code>cut()</code> : the arguments are the vector to be discretized and the breakpoints; optionally we can pass labels to be applied to the new levels. The result is a factor vector.</p>
<ul>
<li><p><code>include.lowest=</code> if <code>TRUE</code> will include the left endpoint to the binning. By default will not be included.</p></li>
<li><p><code>right=</code> if <code>FALSE</code> makes intervals include their left end and exclude the right.</p></li>
<li><p><code>breaks=</code> passing an <code>integer</code> will produce that number of bins with equal width.</p></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb684"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb684-1"><a href="#cb684-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">10</span>)</span>
<span id="cb684-2"><a href="#cb684-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span> (<span class="fu">cut</span> (vec, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>), <span class="at">include.lowest=</span><span class="cn">TRUE</span>, <span class="at">right=</span><span class="cn">FALSE</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "[1,4)"  "[4,7)"  "[7,10]" "[1,4)"  "[7,10]" "[7,10]" "[1,4)"  "[4,7)" 
[9] "[7,10]"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb686"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb686-1"><a href="#cb686-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating random numbers</span></span>
<span id="cb686-2"><a href="#cb686-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">168</span>)</span>
<span id="cb686-3"><a href="#cb686-3" aria-hidden="true" tabindex="-1"></a>rand.vec <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb686-4"><a href="#cb686-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb686-5"><a href="#cb686-5" aria-hidden="true" tabindex="-1"></a><span class="co"># cut() with breaks=5 of equal width</span></span>
<span id="cb686-6"><a href="#cb686-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span> (<span class="fu">cut</span> (rand.vec, <span class="at">breaks=</span><span class="dv">5</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 (-3.43,-2.15] (-2.15,-0.867] (-0.867,0.411]   (0.411,1.69]    (1.69,2.97] 
            14            184            454            301             47 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb688"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb688-1"><a href="#cb688-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using quantile() to create bins with equal number of observations</span></span>
<span id="cb688-2"><a href="#cb688-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span> (<span class="fu">cut</span> (rand.vec, <span class="fu">quantile</span>(rand.vec) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
(-3.42,-0.682] (-0.682,-0.01]  (-0.01,0.679]   (0.679,2.97] 
           249            250            250            250 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb690"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb690-1"><a href="#cb690-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quantile() with probs argument to create 5 bins instead of 2</span></span>
<span id="cb690-2"><a href="#cb690-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span> (<span class="fu">cut</span> (rand.vec, </span>
<span id="cb690-3"><a href="#cb690-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">quantile</span>(rand.vec, <span class="at">probs=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>) ), </span>
<span id="cb690-4"><a href="#cb690-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">include.lowest =</span> <span class="cn">TRUE</span> ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 [-3.42,-0.862] (-0.862,-0.257]  (-0.257,0.284]   (0.284,0.843]    (0.843,2.97] 
            200             200             200             200             200 </code></pre>
</div>
</div>
</section>
</section>
<section id="character-strings" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="character-strings"><span class="header-section-number">6.3</span> Character Strings</h2>
<ul>
<li><p><code>paste()</code> , <code>paste0()</code> : sticks together two character vectors, and if its necessary convert them into a <code>character</code> vector first. By default it will insert a space between them.</p>
<ul>
<li><p><code>sep=</code> to choose the separation, e.g.&nbsp;<code>sep="."</code> or <code>sep=""</code> .</p></li>
<li><p><code>collapse=</code> combines all the strings of the vector into one long string. It will use the separator specified by the value of this argument. e.g.&nbsp;<code>collapse=""</code> or <code>="\t"</code> .</p></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb692"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb692-1"><a href="#cb692-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a b c"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb694"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb694-1"><a href="#cb694-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>( <span class="dv">1</span> <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FALSE3"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb696"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb696-1"><a href="#cb696-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Arg"</span>, <span class="at">sep=</span><span class="st">"."</span>, LETTERS[<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Arg.C" "Arg.D" "Arg.E" "Arg.F" "Arg.G"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb698"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb698-1"><a href="#cb698-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], LETTERS[<span class="dv">5</span><span class="sc">:</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">", "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a E, b D, c C, d B, e A"</code></pre>
</div>
</div>
<section id="column-names" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="column-names"><span class="header-section-number">6.3.1</span> Column Names</h3>
<p>When a data frame is constructed from data without header names, R construct names such as V1 and V2. Usually we will want to replace these names to others more meaningful.</p>
<p>For example, we want column names for 36 months of balance data from 2021 to 2023, also 36 months of payment data for the same years.</p>
<ul>
<li><p><code>outer()</code> : given two vectors, performs another function on each pair of elements producing a matrix.</p></li>
<li><p><code>expand.grid()</code> : given vectors of values produces a data frame containing all combinations of all the values.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb700"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb700-1"><a href="#cb700-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (</span>
<span id="cb700-2"><a href="#cb700-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">outer</span> (month.abb, <span class="dv">2021</span><span class="sc">:</span><span class="dv">2023</span>, paste, <span class="at">sep =</span> <span class="st">"."</span> ), <span class="dv">5</span></span>
<span id="cb700-3"><a href="#cb700-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]       [,2]       [,3]      
[1,] "Jan.2021" "Jan.2022" "Jan.2023"
[2,] "Feb.2021" "Feb.2022" "Feb.2023"
[3,] "Mar.2021" "Mar.2022" "Mar.2023"
[4,] "Apr.2021" "Apr.2022" "Apr.2023"
[5,] "May.2021" "May.2022" "May.2023"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb702"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb702-1"><a href="#cb702-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the month sequence for each year</span></span>
<span id="cb702-2"><a href="#cb702-2" aria-hidden="true" tabindex="-1"></a>monseq <span class="ot">&lt;-</span> <span class="fu">outer</span> (month.abb, <span class="dv">2021</span><span class="sc">:</span><span class="dv">2023</span>, paste, <span class="at">sep =</span> <span class="st">"."</span> )</span>
<span id="cb702-3"><a href="#cb702-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the column names</span></span>
<span id="cb702-4"><a href="#cb702-4" aria-hidden="true" tabindex="-1"></a>newnam <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ID"</span>, </span>
<span id="cb702-5"><a href="#cb702-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">paste0</span> (<span class="st">"Bal."</span>, monseq), </span>
<span id="cb702-6"><a href="#cb702-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">paste0</span> (<span class="st">"Pay."</span>, monseq) )</span>
<span id="cb702-7"><a href="#cb702-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-8"><a href="#cb702-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(newnam, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Pay.Aug.2021" "Bal.Feb.2023" "Pay.Jun.2021" "Bal.Apr.2021" "Bal.Jun.2023"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb704"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb704-1"><a href="#cb704-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative maybe more eficient but more tedious</span></span>
<span id="cb704-2"><a href="#cb704-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">rep</span> (<span class="fu">c</span>(<span class="st">"Bal"</span>, <span class="st">"Pay"</span>), <span class="dv">12</span> <span class="sc">*</span> <span class="dv">3</span>)</span>
<span id="cb704-3"><a href="#cb704-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Each month 2 times for Bal and Pay, and then 3 times for the years</span></span>
<span id="cb704-4"><a href="#cb704-4" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">rep</span> ( <span class="fu">rep</span>(month.abb, <span class="at">each =</span> <span class="dv">2</span>), <span class="dv">3</span> )</span>
<span id="cb704-5"><a href="#cb704-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Each year two times, for Bal and Pay</span></span>
<span id="cb704-6"><a href="#cb704-6" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">rep</span> (<span class="dv">2021</span><span class="sc">:</span><span class="dv">2023</span>, <span class="at">each =</span> <span class="dv">24</span>)</span>
<span id="cb704-7"><a href="#cb704-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb704-8"><a href="#cb704-8" aria-hidden="true" tabindex="-1"></a>newnam <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ID"</span>, <span class="fu">paste</span>(p1, p2, p3, <span class="at">sep=</span><span class="st">"."</span>) )</span>
<span id="cb704-9"><a href="#cb704-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(newnam, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Pay.Jun.2022" "Bal.Mar.2023" "Bal.Jun.2022" "Bal.Sep.2021" "Bal.Aug.2023"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb706"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb706-1"><a href="#cb706-1" aria-hidden="true" tabindex="-1"></a>names.df <span class="ot">&lt;-</span> <span class="fu">expand.grid</span> (<span class="fu">c</span>(<span class="st">"Bal"</span>, <span class="st">"Pay"</span>), </span>
<span id="cb706-2"><a href="#cb706-2" aria-hidden="true" tabindex="-1"></a>                         month.abb, </span>
<span id="cb706-3"><a href="#cb706-3" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="dv">2021</span><span class="sc">:</span><span class="dv">2023</span>) )</span>
<span id="cb706-4"><a href="#cb706-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-5"><a href="#cb706-5" aria-hidden="true" tabindex="-1"></a>newnam <span class="ot">&lt;-</span> <span class="fu">paste</span> ( names.df[[<span class="st">"Var1"</span>]], </span>
<span id="cb706-6"><a href="#cb706-6" aria-hidden="true" tabindex="-1"></a>                  names.df[[<span class="st">"Var2"</span>]], </span>
<span id="cb706-7"><a href="#cb706-7" aria-hidden="true" tabindex="-1"></a>                  names.df[[<span class="st">"Var3"</span>]],</span>
<span id="cb706-8"><a href="#cb706-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sep =</span> <span class="st">"."</span> )</span>
<span id="cb706-9"><a href="#cb706-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-10"><a href="#cb706-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(newnam, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Bal.Feb.2023" "Bal.Jun.2023" "Bal.Nov.2023" "Pay.Oct.2023" "Bal.Aug.2021"</code></pre>
</div>
</div>
</section>
<section id="tabulating-dates" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="tabulating-dates"><span class="header-section-number">6.3.2</span> Tabulating Dates</h3>
<p>To summarize vectors of dates:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb708"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb708-1"><a href="#cb708-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">168</span>)</span>
<span id="cb708-2"><a href="#cb708-2" aria-hidden="true" tabindex="-1"></a>rnd.dts <span class="ot">&lt;-</span> <span class="fu">as.Date</span> (<span class="fu">sample</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">730</span>, <span class="at">size =</span> <span class="dv">600</span>), <span class="at">origin =</span> <span class="st">"2021-01-01"</span>)</span>
<span id="cb708-3"><a href="#cb708-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb708-4"><a href="#cb708-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span> (<span class="fu">quarters</span> (rnd.dts) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Q1  Q2  Q3  Q4 
153 139 154 154 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb710"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb710-1"><a href="#cb710-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To combine year.month is also possible with substring() instead of format</span></span>
<span id="cb710-2"><a href="#cb710-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span> ( <span class="fu">paste0</span> (<span class="fu">format</span> (rnd.dts, <span class="st">"%Y"</span>), <span class="st">"."</span>, <span class="fu">quarters</span>(rnd.dts) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
2021.Q1 2021.Q2 2021.Q3 2021.Q4 2022.Q1 2022.Q2 2022.Q3 2022.Q4 2023.Q1 
     79      68      75      78      73      71      79      76       1 </code></pre>
</div>
</div>
<p>If we want to use the month instead of the quarter, we can extract the moth name with <code>month()</code> function and use paste, or it is possible to use <code>format()</code> directly with the year and the month name.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb712"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb712-1"><a href="#cb712-1" aria-hidden="true" tabindex="-1"></a>ym.order <span class="ot">&lt;-</span> <span class="fu">paste0</span> (<span class="dv">2021</span><span class="sc">:</span><span class="dv">2023</span>, <span class="st">"."</span>, month.name )</span>
<span id="cb712-2"><a href="#cb712-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-3"><a href="#cb712-3" aria-hidden="true" tabindex="-1"></a>ym.tbl <span class="ot">&lt;-</span> <span class="fu">table</span> (<span class="fu">format</span>(rnd.dts, <span class="st">"%Y.%B"</span>) )</span>
<span id="cb712-4"><a href="#cb712-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-5"><a href="#cb712-5" aria-hidden="true" tabindex="-1"></a>ym.tbl[ym.order][<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 2021.January 2022.February          &lt;NA&gt;    2021.April      2022.May 
           26            20                          20            24 </code></pre>
</div>
</div>
</section>
<section id="unique-keys" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3" class="anchored" data-anchor-id="unique-keys"><span class="header-section-number">6.3.3</span> Unique Keys</h3>
<p>Often we need to construct a column with an unique identifier for each row. These previous methods are useful for that task. Maybe the year and month are not enough and we have to add a customer ID or something else to achieve this column with unique keys.</p>
</section>
<section id="files-and-path-names" class="level3" data-number="6.3.4">
<h3 data-number="6.3.4" class="anchored" data-anchor-id="files-and-path-names"><span class="header-section-number">6.3.4</span> Files and Path names</h3>
<p>To create a vector with every file in the working directory and each one with it absolute path we can use <code>paste(getwd(), list.files(), sep="/")</code> . If we use <code>list.files(full.names=TRUE)</code> will return only the relative path.</p>
</section>
</section>
<section id="regular-expressions" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="regular-expressions"><span class="header-section-number">6.4</span> Regular Expressions</h2>
<p>We use regular expressions to find strings that match a pattern. This patterns are case-sensitive but can be ignored. R can use POSIX regular expression and Perl-style re.</p>
<p>For regular expresson in R there are three primary tools which are <code>grep()</code>, <code>regexpr()</code> and <code>sub()</code>, all tree with its variants.</p>
<ul>
<li><p><code>grep()</code> : given a pattern and a vector of strings, returns a numeric vector with the indices of the string that match the pattern.</p>
<ul>
<li><p><code>value=</code> if <code>TRUE</code> returns the matching string themselves.</p></li>
<li><p><code>ignore.case=</code> if <code>TRUE</code> will ignore whether letters are in upper or lower-case.</p></li>
<li><p><code>invert=</code> if <code>TRUE</code> reverses the search, returning the elements that not match. It’s not available with <code>grepl()</code></p></li>
<li><p><code>fixed=</code> if <code>TRUE</code> suspends the rules about patterns and simply searches for an exact text string.</p></li>
<li><p><code>perl=</code> if <code>TRUE</code> indicate to grep() to use Perl-type regular expressions.</p></li>
<li><p><code>useBytes=</code> if <code>TRUE</code> the matching should be done byte by byte.</p></li>
</ul></li>
<li><p><code>grepl()</code> : returns a logical vector indicating the elements that match.</p></li>
</ul>
<p>Special Characters in POSIX regular expressions:</p>
<p><img src="images/clipboard-3145267093.png" class="img-fluid"></p>
<p>It is common to see <code>.+</code> in regular expressions, that means <em>a sequence of one or more characters</em>. Also we can see <code>.*</code> for <em>zero or more characters</em>.</p>
<p>Is is a mistake to add spaces to your pattern thinking ‘it will be more readable’, because the regular expression will then take the spaces literally and require that they appear.</p>
<p>Looking in a character vector with dates:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb714"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb714-1"><a href="#cb714-1" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb714-2"><a href="#cb714-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Balance due 16 Jun or earlier in 2017"</span>,</span>
<span id="cb714-3"><a href="#cb714-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"26 Aug or any day in 3021"</span>,</span>
<span id="cb714-4"><a href="#cb714-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"'76 Trombones' marched in a 1962 film"</span>,</span>
<span id="cb714-5"><a href="#cb714-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4 Apr 2018"</span>, <span class="st">"9Aug2006"</span>,</span>
<span id="cb714-6"><a href="#cb714-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"99 Voters May Register in 20188"</span></span>
<span id="cb714-7"><a href="#cb714-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p><code>.*</code> if we have leading text</p></li>
<li><p><code>[0-3]?[0-9]</code> matches a one digit number, the first digit is optional indicated by ‘?’</p></li>
<li><p><code>.*</code> again for additional text</p></li>
<li><p><code>(", or.mon, ")</code> will be the variable with the month names separated by pipes <code>"|"</code>. The parenthesis make this a single pattern. The abbreviations will match a full name.</p></li>
<li><p><code>.*</code> more additional text</p></li>
<li><p><code>[1-2][0-9[{3}</code> four digits that have to start with 1 or 2</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb715"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb715-1"><a href="#cb715-1" aria-hidden="true" tabindex="-1"></a>or.mon <span class="ot">&lt;-</span> <span class="fu">paste</span> (month.abb, <span class="at">collapse =</span> <span class="st">"|"</span>)</span>
<span id="cb715-2"><a href="#cb715-2" aria-hidden="true" tabindex="-1"></a>or.mon</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb717"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb717-1"><a href="#cb717-1" aria-hidden="true" tabindex="-1"></a>re <span class="ot">&lt;-</span> <span class="fu">paste0</span> ( <span class="st">".*[0-3]?[0-9].*("</span>, or.mon, <span class="st">").*[1-2][0-9]{3}"</span>)</span>
<span id="cb717-2"><a href="#cb717-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> (re, dt, <span class="at">value =</span> <span class="cn">TRUE</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Balance due 16 Jun or earlier in 2017"
[2] "4 Apr 2018"                           
[3] "9Aug2006"                             
[4] "99 Voters May Register in 20188"      </code></pre>
</div>
</div>
<p>The line with ‘20188’ match because the four digits with <code>[1-2][0-9]{3}</code> match. Also the ‘99’ matches because <code>[0-3]</code> is optional and the first 9 matches in the <code>[0-9]</code> pattern and the second match with <code>.*</code> .</p>
<section id="escape-sequences" class="level4" data-number="6.4.0.1">
<h4 data-number="6.4.0.1" class="anchored" data-anchor-id="escape-sequences"><span class="header-section-number">6.4.0.1</span> Escape Sequences</h4>
<p>To write some special characters like the dollar sign $, we have to pass a backslash to escape $ from the engine which read regular expressions. To escape a character usually we should use <code>\$</code> but in R we need to escape also the backslash because R have special characters like <code>\n</code> to create a new-line. Then we will write double backslash and the simbol <code>\\$</code>. In some case, to look for the backslash itself we have to write four backslashes, two for the escape and other two for the search: <code>\\\\</code>. Using the argument fixed=TRUE can simplify the search of this patterns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb719"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb719-1"><a href="#cb719-1" aria-hidden="true" tabindex="-1"></a>pain <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c:</span><span class="sc">\\</span><span class="st">temp"</span>, <span class="st">"/bin/u"</span>, <span class="st">"$5"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"2 backs: </span><span class="sc">\\\\</span><span class="st">"</span>)</span>
<span id="cb719-2"><a href="#cb719-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> (<span class="st">"$"</span>, pain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb721"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb721-1"><a href="#cb721-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> (<span class="st">"</span><span class="sc">\\</span><span class="st">$"</span>, pain, <span class="at">value=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "$5"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb723"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb723-1"><a href="#cb723-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> (<span class="st">"</span><span class="sc">\\\\</span><span class="st">"</span>, pain, <span class="at">value=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "c:\\temp"      "2 backs: \\\\"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb725"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb725-1"><a href="#cb725-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> (<span class="st">"</span><span class="sc">\\</span><span class="st">"</span>, pain, <span class="at">value=</span><span class="cn">TRUE</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "c:\\temp"      "2 backs: \\\\"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb727"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb727-1"><a href="#cb727-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Looking for any slashes:</span></span>
<span id="cb727-2"><a href="#cb727-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> (<span class="st">"</span><span class="sc">\\</span><span class="st">|/"</span>, pain, <span class="at">value=</span><span class="cn">TRUE</span>, <span class="at">fixed=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>character(0)</code></pre>
</div>
</div>
</section>
<section id="ranges" class="level4" data-number="6.4.0.2">
<h4 data-number="6.4.0.2" class="anchored" data-anchor-id="ranges"><span class="header-section-number">6.4.0.2</span> Ranges</h4>
<p>Working with ranges like <code>[0-9]</code> meaning any number between 0 and 9 we also can negate a character, for example <code>[^0123]</code> means any character other than 0, 1, 2, 3, 4.</p>
<p>The predefined character classes set include <code>[:lower:], [:upper:]</code> for lower- and upper-case; <code>[:alpha:]</code> for any letters; <code>[:alnum:]</code> for alphanumeric; <code>[:digit:]</code> for digits; <code>[:punct:]</code> for punctuation. There are more in <code>help("regex")</code> pages. Then, <code>[[:digit:]]</code> match one digit and <code>[^[:digit:]]</code> match any character that is not a digit.</p>
<p>To finish, a word boundary is to search a word or string with a specific composition and can be identified by <code>\b</code> or <code>\&lt; ... \&gt;</code>. For example using <code>"\\&lt;\\d{4}\\&gt;"</code> we are specifying a word that must include exactly four digits.</p>
</section>
<section id="regexpr" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="regexpr"><span class="header-section-number">6.4.1</span> <code>regexpr()</code></h3>
<p>The function <code>regexpr()</code> is more precise than <code>grep()</code>, it will return the location of the first match within the string (number of the first character of the match). This information can be useful to extract the number itself and not only identify the string.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb729-1"><a href="#cb729-1" aria-hidden="true" tabindex="-1"></a>dt</span>
<span id="cb729-2"><a href="#cb729-2" aria-hidden="true" tabindex="-1"></a><span class="co"># looking for a word with an integer:</span></span>
<span id="cb729-3"><a href="#cb729-3" aria-hidden="true" tabindex="-1"></a>(regout <span class="ot">&lt;-</span> <span class="fu">regexpr</span>( <span class="st">"</span><span class="sc">\\</span><span class="st">&lt;</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">&gt;"</span>, dt ) )</span>
<span id="cb729-4"><a href="#cb729-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(,<span class="st">"match.legth"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The first ‘13’ returned by <code>regexpr()</code> vector indicate that the 13th character is a number referencing the 16. The number -1 indicate that string no contains an integer as a word.</p>
<p>The attributes returned also give us information. <code>"match.length"</code> is the length of the match. Then, we could extract the <code>"match.length"</code> vector and use it with <code>substring()</code> to extract the number in the strings. Other method is with <code>regmatches()</code> given the character vector and the output of <code>regexpr()</code>:</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb730-1"><a href="#cb730-1" aria-hidden="true" tabindex="-1"></a><span class="fu">regmatches</span> (dt, regout)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To extract all integers in the character vector we will use <code>gregexpr()</code> but the return is a list because some strings can contain more than one integer word. With <code>regmatches()</code> we can extract the numbers anyway.</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb731-1"><a href="#cb731-1" aria-hidden="true" tabindex="-1"></a>gout <span class="ot">&lt;-</span> <span class="fu">gregexpr</span> (<span class="st">"</span><span class="sc">\\</span><span class="st">&lt;</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">&gt;"</span>, dt)</span>
<span id="cb731-2"><a href="#cb731-2" aria-hidden="true" tabindex="-1"></a><span class="fu">regmatches</span> (dt, gout)</span>
<span id="cb731-3"><a href="#cb731-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-4"><a href="#cb731-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a matrix with the return of regmatches</span></span>
<span id="cb731-5"><a href="#cb731-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span> (<span class="fu">as.numeric</span> (<span class="fu">unlist</span> (<span class="fu">regmatches</span> (dt, gout) ) ), <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span>T )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Bu default the matching look for the match that are as long as possible. If in the pattern we add a ‘?’ it will stop that. for example with <code>\\d.*?\\d</code> will produce “4 Apr 3” although there are more numbers (“4 Apr 3021”).</p>
</section>
<section id="replacement-with-regular-expressions" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="replacement-with-regular-expressions"><span class="header-section-number">6.4.2</span> Replacement with Regular Expressions</h3>
<ul>
<li><p><code>sub()</code> : replaces the first matching pattern.</p></li>
<li><p><code>gsub()</code> : replaces all the matching patterns.</p></li>
</ul>
<p>The first argument for both a the pattern to search, the second is the characters to replace for, and the third argument is the character vector where to look for. Other option is to use backreferences, if the patters is composed by two patterns between parentheses we can use \1 \2 in the second argument to refer the matches:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb732"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb732-1"><a href="#cb732-1" aria-hidden="true" tabindex="-1"></a>bros <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Isaac Asimov"</span>, <span class="st">"Leon Tolstoi"</span>, <span class="st">"Virginia Wolf"</span>, <span class="st">"Brandon Sanderson"</span>)</span>
<span id="cb732-2"><a href="#cb732-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb732-3"><a href="#cb732-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing the name order with backreferences:</span></span>
<span id="cb732-4"><a href="#cb732-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sub</span> (<span class="st">"([[:alpha:]]+) ([[:alpha:]]+)"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">2, </span><span class="sc">\\</span><span class="st">1"</span>, bros)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Asimov, Isaac"      "Tolstoi, Leon"      "Wolf, Virginia"    
[4] "Sanderson, Brandon"</code></pre>
</div>
</div>
</section>
<section id="splitting-with-regular-expressions" class="level3" data-number="6.4.3">
<h3 data-number="6.4.3" class="anchored" data-anchor-id="splitting-with-regular-expressions"><span class="header-section-number">6.4.3</span> Splitting with Regular Expressions</h3>
<ul>
<li><code>strsplit()</code> : given a vector and a pattern splits the text producing a list with one entry for each string. Also has the fixed=TRUE argument to not use regular expressions.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb734"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb734-1"><a href="#cb734-1" aria-hidden="true" tabindex="-1"></a>keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CA-2017-04-02-66J-44"</span>, </span>
<span id="cb734-2"><a href="#cb734-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">"MI-2017-07-17-41H-72"</span>, </span>
<span id="cb734-3"><a href="#cb734-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">"CA-2017-08-24-Missing-378"</span>)</span>
<span id="cb734-4"><a href="#cb734-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb734-5"><a href="#cb734-5" aria-hidden="true" tabindex="-1"></a>(key.list <span class="ot">&lt;-</span> <span class="fu">strsplit</span> (keys, <span class="st">"-"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "CA"   "2017" "04"   "02"   "66J"  "44"  

[[2]]
[1] "MI"   "2017" "07"   "17"   "41H"  "72"  

[[3]]
[1] "CA"      "2017"    "08"      "24"      "Missing" "378"    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb736"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb736-1"><a href="#cb736-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span> ( <span class="fu">unlist</span> (key.list), <span class="at">ncol =</span> <span class="dv">6</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]   [,3] [,4] [,5]      [,6] 
[1,] "CA" "2017" "04" "02" "66J"     "44" 
[2,] "MI" "2017" "07" "17" "41H"     "72" 
[3,] "CA" "2017" "08" "24" "Missing" "378"</code></pre>
</div>
</div>
</section>
<section id="common-data-cleaning-task-using-regular-expressions" class="level3" data-number="6.4.4">
<h3 data-number="6.4.4" class="anchored" data-anchor-id="common-data-cleaning-task-using-regular-expressions"><span class="header-section-number">6.4.4</span> Common Data Cleaning Task Using Regular Expressions</h3>
<section id="removing-leading-and-trailing-spaces" class="level4" data-number="6.4.4.1">
<h4 data-number="6.4.4.1" class="anchored" data-anchor-id="removing-leading-and-trailing-spaces"><span class="header-section-number">6.4.4.1</span> Removing Leading and Trailing Spaces</h4>
<ul>
<li><code>"^ *"</code> : any string with leading spaces</li>
<li><code>" *$"</code> : any string with trailing spaces</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb738"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb738-1"><a href="#cb738-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span> ( <span class="st">"^ *| *$"</span>, <span class="st">""</span>, <span class="fu">c</span>(<span class="st">"  Text Spaces "</span>, <span class="st">"Trailing    "</span>, </span>
<span id="cb738-2"><a href="#cb738-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"None"</span>, <span class="st">"     Leading"</span> ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Text Spaces" "Trailing"    "None"        "Leading"    </code></pre>
</div>
</div>
</section>
<section id="format-currency-to-numeric" class="level4" data-number="6.4.4.2">
<h4 data-number="6.4.4.2" class="anchored" data-anchor-id="format-currency-to-numeric"><span class="header-section-number">6.4.4.2</span> Format Currency to Numeric</h4>
<p>Taking into account $12,345.67 or 12,345.67€ we have to remove the symbol and the comma before converting into numeric.</p>
<ul>
<li><code>"\\$"</code> : dollar symbol</li>
<li><code>"\\€"</code> : euro symbol</li>
<li><code>"^[^0-9.]"</code> : non-numeric leading character</li>
<li><code>"[^[:digit:].]$"</code> : non-numeric trailing character</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb740"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb740-1"><a href="#cb740-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span> ( <span class="fu">gsub</span> (<span class="st">"(^[^0-9.]|,)|(,|[^[:digit:].]$)"</span>,</span>
<span id="cb740-2"><a href="#cb740-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">""</span>, <span class="fu">c</span>(<span class="st">"$12,345.67"</span>, <span class="st">"98,765.43€"</span>) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12345.67 98765.43</code></pre>
</div>
</div>
</section>
<section id="removing-html-tags" class="level4" data-number="6.4.4.3">
<h4 data-number="6.4.4.3" class="anchored" data-anchor-id="removing-html-tags"><span class="header-section-number">6.4.4.3</span> Removing HTML Tags</h4>
<p>We are looking for <b>Bold</b> and other tags like that.</p>
<ul>
<li><code>"&lt;.*?&gt;"</code> : Everything between &lt; &gt;</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb742"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb742-1"><a href="#cb742-1" aria-hidden="true" tabindex="-1"></a>html <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'</span></span>
<span id="cb742-2"><a href="#cb742-2" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;!DOCTYPE html&gt;</span></span>
<span id="cb742-3"><a href="#cb742-3" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;html lang="es"&gt;</span></span>
<span id="cb742-4"><a href="#cb742-4" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;head&gt;</span></span>
<span id="cb742-5"><a href="#cb742-5" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;meta charset="UTF-8"&gt;</span></span>
<span id="cb742-6"><a href="#cb742-6" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></span>
<span id="cb742-7"><a href="#cb742-7" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;title&gt;Ejemplo de HTML&lt;/title&gt;</span></span>
<span id="cb742-8"><a href="#cb742-8" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/head&gt;</span></span>
<span id="cb742-9"><a href="#cb742-9" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;body&gt;</span></span>
<span id="cb742-10"><a href="#cb742-10" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;h1&gt;Bienvenido a mi página web&lt;/h1&gt;</span></span>
<span id="cb742-11"><a href="#cb742-11" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;p&gt;Este es un &lt;strong&gt;ejemplo&lt;/strong&gt; de un párrafo con &lt;em&gt;texto en cursiva&lt;/em&gt; y &lt;strong&gt;texto en negrita&lt;/strong&gt;.&lt;/p&gt;</span></span>
<span id="cb742-12"><a href="#cb742-12" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;ul&gt;</span></span>
<span id="cb742-13"><a href="#cb742-13" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;li&gt;Elemento de lista 1&lt;/li&gt;</span></span>
<span id="cb742-14"><a href="#cb742-14" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;li&gt;Elemento de lista 2&lt;/li&gt;</span></span>
<span id="cb742-15"><a href="#cb742-15" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;li&gt;Elemento de lista 3&lt;/li&gt;</span></span>
<span id="cb742-16"><a href="#cb742-16" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/ul&gt;</span></span>
<span id="cb742-17"><a href="#cb742-17" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;a href="https://www.ejemplo.com"&gt;Visita nuestro sitio web&lt;/a&gt;</span></span>
<span id="cb742-18"><a href="#cb742-18" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/body&gt;</span></span>
<span id="cb742-19"><a href="#cb742-19" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/html&gt;</span></span>
<span id="cb742-20"><a href="#cb742-20" aria-hidden="true" tabindex="-1"></a><span class="st">'</span>)</span>
<span id="cb742-21"><a href="#cb742-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb742-22"><a href="#cb742-22" aria-hidden="true" tabindex="-1"></a>no.html <span class="ot">&lt;-</span> <span class="fu">gsub</span> ( <span class="st">"&lt;.*?&gt;"</span>, <span class="st">""</span>, html)</span>
<span id="cb742-23"><a href="#cb742-23" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span> (<span class="st">"</span><span class="sc">\\</span><span class="st">n"</span>, <span class="st">""</span>, no.html)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "                Ejemplo de HTML    Bienvenido a mi página web    Este es un ejemplo de un párrafo con texto en cursiva y texto en negrita.            Elemento de lista 1        Elemento de lista 2        Elemento de lista 3        Visita nuestro sitio web"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb744"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb744-1"><a href="#cb744-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(no.html)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    

    
    
    Ejemplo de HTML

    Bienvenido a mi página web
    Este es un ejemplo de un párrafo con texto en cursiva y texto en negrita.
    
        Elemento de lista 1
        Elemento de lista 2
        Elemento de lista 3
    
    Visita nuestro sitio web</code></pre>
</div>
</div>
</section>
<section id="linux-paths-to-windows-or-r-paths" class="level4" data-number="6.4.4.4">
<h4 data-number="6.4.4.4" class="anchored" data-anchor-id="linux-paths-to-windows-or-r-paths"><span class="header-section-number">6.4.4.4</span> Linux Paths to Windows or R Paths</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb746"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb746-1"><a href="#cb746-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linux to Windows</span></span>
<span id="cb746-2"><a href="#cb746-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span> (<span class="st">"/"</span>, <span class="st">"</span><span class="sc">\\\\</span><span class="st">"</span>, <span class="st">"/usr/local/bin"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\\usr\\local\\bin"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb748"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb748-1"><a href="#cb748-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Windows to Linux</span></span>
<span id="cb748-2"><a href="#cb748-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\\\</span><span class="st">"</span>, <span class="st">"/"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">usr</span><span class="sc">\\</span><span class="st">local</span><span class="sc">\\</span><span class="st">bin"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/usr/local/bin"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb750"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb750-1"><a href="#cb750-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"/"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">usr</span><span class="sc">\\</span><span class="st">local</span><span class="sc">\\</span><span class="st">bin"</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/usr/local/bin"</code></pre>
</div>
</div>
</section>
</section>
<section id="recomendations" class="level3" data-number="6.4.5">
<h3 data-number="6.4.5" class="anchored" data-anchor-id="recomendations"><span class="header-section-number">6.4.5</span> Recomendations</h3>
<p>Because Regular Expressions are complicated be sure to document them well. For debugging there are online aids to diagnosing problems, be sure to specify regular expression type POSIX with GNI extensions or PCRE.</p>
</section>
</section>
<section id="utf-8-and-other-non-ascii-characters" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="utf-8-and-other-non-ascii-characters"><span class="header-section-number">6.5</span> UTF-8 and Other Non-ASCII Characters</h2>
<p>Leading with symbols or letters with accent in Latin alphabet, each have their ASCII hexadecimal value, then we can use that after <code>"\x"</code> to use it as a pattern in <code>grep()</code>, <code>gsub()</code> or other similar function. For example, to look for <code>Ê</code> we can introduce <code>\xca</code> as <code>ca</code> represent the hexadecimal value for <code>Ê</code>. Also, Windows and Mac use different ASCII table with different some different values.</p>
<p>Unicode symbols are intend to describe all the symbols in in all the world, and are shown in R by preceding them with <code>\U</code> . The word China in simplified Chinese are represented <code>"\U4E2D"</code> and <code>"\U56FD"</code> . The most popular is UTF-8 encoding which a character in Unicode is represented by one or more bytes. The display of UTF-8 characters can be inconsistent between machines.</p>
<p>R assigns an encoding to every element in a character vector and different elements in a vector may have different encodings.</p>
<ul>
<li><code>Encoding()</code> : returns the encoding of the strings in a vector</li>
<li><code>iconv()</code> : to convert the encodings.</li>
</ul>
<p>In R ASCII strings are unencoded; latin1 characters are encoded as latin1; non-latin unicode are encoded as UTF-8.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb752"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb752-1"><a href="#cb752-1" aria-hidden="true" tabindex="-1"></a>yogi.utf <span class="ot">&lt;-</span> <span class="st">"It's d\Ue9j\Ue0 vu all over again."</span></span>
<span id="cb752-2"><a href="#cb752-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Encoding</span> (yogi.utf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "UTF-8"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb754"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb754-1"><a href="#cb754-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>( <span class="fu">regexpr</span> (<span class="st">"</span><span class="sc">\\</span><span class="st">xe0"</span>, yogi.utf), <span class="fu">regexpr</span> (<span class="st">"\ue0"</span>, yogi.utf), <span class="fu">regexpr</span> (<span class="st">"à"</span>, yogi.utf) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9 9 9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb756"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb756-1"><a href="#cb756-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span> (<span class="at">a =</span> <span class="st">"\U4e2d\U56fd"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     a
1 中国</code></pre>
</div>
</div>
</section>
<section id="factors" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="factors"><span class="header-section-number">6.6</span> Factors</h2>
<p>A Factor vector looks like text but behaves like an integer. It can be created with <code>as.factor()</code> function which often is a final step; also are created when you add character vector into a data frame with <code>data.frame()</code> or <code>cbind()</code> functions.</p>
<p>It is recommended to turn the character vectors into factor only when all the data cleaning is finished, before modeling.</p>
<p>A Factor vector the <code>class()</code> is <code>factor</code>, the <code>mode()</code> is <code>numeric</code> and the <code>typeof()</code> is <code>integer</code>. R will set the levels alphabetically.</p>
<ul>
<li>When you change a value of a factor vector, if that new value not corresponds to a level, will be NA.</li>
<li>When you remove the elements with a specific value from the factor vector, that value is still one of the levels.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb758"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb758-1"><a href="#cb758-1" aria-hidden="true" tabindex="-1"></a>cols.fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>( <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"red"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>) )</span>
<span id="cb758-2"><a href="#cb758-2" aria-hidden="true" tabindex="-1"></a>cols.fac</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] red   green blue  red   red   red   blue 
Levels: blue green red</code></pre>
</div>
<div class="sourceCode cell-code" id="cb760"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb760-1"><a href="#cb760-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cols.fac[cols.fac <span class="sc">!=</span> <span class="st">"red"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 blue green   red 
    2     1     0 </code></pre>
</div>
</div>
<ul>
<li><code>levels()</code> : to check the levels in a factor vector and also to assign levels. This not change the underlying integer value corresponding that level.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb762"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb762-1"><a href="#cb762-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(cols.fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "blue"  "green" "red"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb764"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb764-1"><a href="#cb764-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(cols.fac)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"yellow"</span></span>
<span id="cb764-2"><a href="#cb764-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(cols.fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "blue"   "yellow" "red"   </code></pre>
</div>
</div>
<p>The levels can be reordered calling <code>factor()</code> function, this is useful for months and other levels that we want to have a custom order.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb766"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb766-1"><a href="#cb766-1" aria-hidden="true" tabindex="-1"></a><span class="fu">factor</span> (cols.fac, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"yellow"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] red    yellow blue   red    red    red    blue  
Levels: red blue yellow</code></pre>
</div>
</div>
<p><strong>Do not try</strong> to change the order with <code>levels()</code> function. In this case will change the levels of the elements itself, will not change ‘only’ the order.</p>
<p>To convert a factor vector into character, can be used <code>as.character()</code> function, but a more efficient way is to use <code>levels(fac)[fac]</code>. Also, to convert the factor vector with levels which look like integers into number, <strong>do not</strong> use <code>as.numeric()</code>, first has to be converted into character. Now, if we have a gender column with F and M as levels of the factor vector, we want to convert this vector into numeric, 0 for F and 1 for M. The function <code>as.numeric()</code> will convert F to 1 and M to 2, to solve this we can use: <code>as.numeric(factor(gender))-1</code> .</p>
<p>Finally, to combine two factor vectors, it is recommended to convert them first into characters, and then combine it. Later, if it’s necessary, convert them again into factors. A exception can arise combining with <code>rbind()</code>, but other than this case, combining factor vector will usually end badly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb768"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb768-1"><a href="#cb768-1" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">factor</span> ( <span class="fu">c</span>(<span class="dv">33</span>, <span class="dv">4</span>, <span class="dv">66</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">77</span>) )</span>
<span id="cb768-2"><a href="#cb768-2" aria-hidden="true" tabindex="-1"></a>src <span class="ot">&lt;-</span> <span class="dv">101</span><span class="sc">:</span><span class="dv">199</span></span>
<span id="cb768-3"><a href="#cb768-3" aria-hidden="true" tabindex="-1"></a><span class="co"># as.numeric will convert the vector elements into its assigned integers, not the levels.</span></span>
<span id="cb768-4"><a href="#cb768-4" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(ind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 2 5 1 3 6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb770"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb770-1"><a href="#cb770-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct way, looking for that indices into 'src' vector:</span></span>
<span id="cb770-2"><a href="#cb770-2" aria-hidden="true" tabindex="-1"></a>src[<span class="fu">as.numeric</span> (<span class="fu">as.character</span> (ind) )]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 133 104 166 103 106 177</code></pre>
</div>
<div class="sourceCode cell-code" id="cb772"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb772-1"><a href="#cb772-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This will extract correctly the numbers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb773"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb773-1"><a href="#cb773-1" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>) )</span>
<span id="cb773-2"><a href="#cb773-2" aria-hidden="true" tabindex="-1"></a>gender</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] F F M F M F M
Levels: F M</code></pre>
</div>
<div class="sourceCode cell-code" id="cb775"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb775-1"><a href="#cb775-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(gender) <span class="sc">-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 0 1 0 1 0 1</code></pre>
</div>
</div>
<section id="missing-values-3" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="missing-values-3"><span class="header-section-number">6.6.1</span> Missing Values</h3>
<p>Missing values in factors are represented by <code>&lt;NA&gt;</code>. Actually, it is possible to have a level <na> with NA values, but it is better no avoid that, as well is clever to avoid “NA” string value. The <code>levels()</code> function does not mention to <code>NA</code> values because they do not have level.</na></p>
<p>We can use the function <code>addNA()</code> to add a level which is a NA value, but will be better to replace NA values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb777"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb777-1"><a href="#cb777-1" aria-hidden="true" tabindex="-1"></a>mis.fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">"F"</span>, <span class="cn">NA</span>, <span class="st">"M"</span>, <span class="st">"F"</span>, <span class="cn">NA</span>, <span class="st">"F"</span>, <span class="st">"M"</span>) )</span>
<span id="cb777-2"><a href="#cb777-2" aria-hidden="true" tabindex="-1"></a>mis.fac</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] F    &lt;NA&gt; M    F    &lt;NA&gt; F    M   
Levels: F M</code></pre>
</div>
<div class="sourceCode cell-code" id="cb779"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb779-1"><a href="#cb779-1" aria-hidden="true" tabindex="-1"></a>mis.fac <span class="ot">&lt;-</span> <span class="fu">as.character</span>(mis.fac)</span>
<span id="cb779-2"><a href="#cb779-2" aria-hidden="true" tabindex="-1"></a>mis.fac[<span class="fu">is.na</span> (mis.fac)] <span class="ot">&lt;-</span> <span class="st">"missing"</span></span>
<span id="cb779-3"><a href="#cb779-3" aria-hidden="true" tabindex="-1"></a>( mis.fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mis.fac) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] F       missing M       F       missing F       M      
Levels: F M missing</code></pre>
</div>
</div>
</section>
</section>
<section id="r-objects-and-commands" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="r-objects-and-commands"><span class="header-section-number">6.7</span> R Objects and Commands</h2>
<ul>
<li><code>get()</code> : accepts a character string and returns the object with that name.</li>
<li><code>exists()</code> : can test to see whether an object exists</li>
<li><code>get0()</code> : allow a value to be specified in place of the error.</li>
<li><code>ls()</code> : returns the names of the objects.</li>
<li><code>assing()</code> : given a name and a value creates a new R object. The argument <code>pos=1</code> at the command line has no effect, but inside a function it creates a variable in the Workspace.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb781"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb781-1"><a href="#cb781-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>)</span>
<span id="cb781-2"><a href="#cb781-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span> (<span class="fu">paste0</span> (LETTERS[i], <span class="fu">c</span>(month.abb,month.abb)[i] ), i, <span class="at">pos =</span> <span class="dv">1</span> )</span>
<span id="cb781-3"><a href="#cb781-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb781-4"><a href="#cb781-4" aria-hidden="true" tabindex="-1"></a>let.mon <span class="ot">&lt;-</span> <span class="fu">ls</span> (<span class="at">pattern =</span> <span class="st">"^[A-Z]{2}?[a-z]{2}?"</span>)</span>
<span id="cb781-5"><a href="#cb781-5" aria-hidden="true" tabindex="-1"></a>let.mon[<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CMar" "DApr" "EMay" "FJun"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb783"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb783-1"><a href="#cb783-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span> (let.mon, <span class="cf">function</span>(i) <span class="fu">object.size</span>(<span class="fu">get</span>(i)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AJan BFeb CMar DApr EMay FJun GJul HAug ISep JOct KNov LDec MJan NFeb OMar PApr 
  56   56   56   56   56   56   56   56   56   56   56   56   56   56   56   56 
QMay RJun SJul TAug USep VOct WNov XDec 
  56   56   56   56   56   56   56   56 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb785"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb785-1"><a href="#cb785-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span> (<span class="at">list =</span> <span class="fu">grep</span> (<span class="st">"^[A-Z]{2}?[a-z]{2}?"</span>, <span class="fu">ls</span>(), <span class="at">value =</span> T ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>parse()</code> : to create an R ‘expression’ object with <code>text</code> argument.</li>
<li><code>eval()</code> : executes the expression</li>
</ul>
<p><code>eval(parse(text = "log.11 &lt;- log(11)"))</code> : will create a variable called ‘log.11’. The combination of <code>parse()</code> and <code>eval()</code> lets us construct R commands and execute them (allowing us to execute sequences of commands once we have created them with <code>paste()</code> and other tools).</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../index.html" class="pagination-link" aria-label="Annotations">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Annotations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../to_book/notebooks/01_functions_scripts.html" class="pagination-link" aria-label="Functions, scripts and performance">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Functions, scripts and performance</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>